Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
23/02/28 07:32:32 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
23/02/28 07:32:33 WARN Utils: Service 'SparkUI' could not bind on port 4040. Attempting port 4041.
#################################################################################################################################
#################################################################################################################################
############################################# STARTING BATCH NUMBER: ILGSA24-17873 ##############################################
#################################################################################################################################
#################################################################################################################################

#######################################
#######################################
Unzipping data: 
#######################################
#######################################
CAGRF20093767_FinalReport1.txt
CAGRF20093767_FinalReport10.txt
SNP_Map.txt
Sample_Map.txt

#######################################
#######################################
the number of files extracted is correct?: 
#######################################
#######################################
False

#######################################
#######################################
the number of listed files is correct?: 
#######################################
#######################################
False

#####################
#####################
read illumina reports and maps with spark
#####################
#####################

#####################
#####################
all the columns in each report are the same than in the first report?
#####################
#####################
True

#####################
#####################
check the column names of the reports DF is correct
#####################
#####################
True
root
 |-- Sample Index: integer (nullable = true)
 |-- Sample ID: string (nullable = true)
 |-- Sample Name: string (nullable = true)
 |-- SNP Index: integer (nullable = true)
 |-- SNP Name: string (nullable = true)
 |-- Chr: string (nullable = true)
 |-- Position: integer (nullable = true)
 |-- GT Score: double (nullable = true)
 |-- GC Score: double (nullable = true)
 |-- Allele1 - AB: string (nullable = true)
 |-- Allele2 - AB: string (nullable = true)
 |-- Allele1 - Top: string (nullable = true)
 |-- Allele2 - Top: string (nullable = true)
 |-- Allele1 - Forward: string (nullable = true)
 |-- Allele2 - Forward: string (nullable = true)
 |-- Allele1 - Design: string (nullable = true)
 |-- Allele2 - Design: string (nullable = true)
 |-- Theta: double (nullable = true)
 |-- R: double (nullable = true)
 |-- X Raw: integer (nullable = true)
 |-- Y Raw: integer (nullable = true)
 |-- X: double (nullable = true)
 |-- Y: double (nullable = true)
 |-- B Allele Freq: double (nullable = true)
 |-- Log R Ratio: double (nullable = true)
 |-- SNP Aux: double (nullable = true)
 |-- SNP: string (nullable = true)
 |-- ILMN Strand: string (nullable = true)
 |-- Top Genomic Sequence: string (nullable = true)
 |-- Customer Strand: string (nullable = true)

None
['Sample Index', 'Sample ID', 'Sample Name', 'SNP Index', 'SNP Name', 'Chr', 'Position', 'GT Score', 'GC Score', 'Allele1 - AB', 'Allele2 - AB', 'Allele1 - Top', 'Allele2 - Top', 'Allele1 - Forward', 'Allele2 - Forward', 'Allele1 - Design', 'Allele2 - Design', 'Theta', 'R', 'X Raw', 'Y Raw', 'X', 'Y', 'B Allele Freq', 'Log R Ratio', 'SNP Aux', 'SNP', 'ILMN Strand', 'Top Genomic Sequence', 'Customer Strand']
+--------------+
|(Position + 1)|
+--------------+
|     102914838|
|     108897059|
|     109656167|
|     109658491|
|     109659046|
|     109660283|
|     109660619|
|     109661290|
|     109664054|
|     109685815|
|     109685884|
|     109685994|
|     109686074|
|     109686694|
|     109686815|
|     109687195|
|     109687484|
|     109687585|
|     109687585|
|     109687714|
+--------------+
only showing top 20 rows

+------------+---------+---------+--------------------+---+---------+-----------------+-----------------+
|Sample Index|Sample ID|SNP Index|            SNP Name|Chr| Position|Allele1 - Forward|Allele2 - Forward|
+------------+---------+---------+--------------------+---+---------+-----------------+-----------------+
|           1| 7497JWMO|        1|         1:103380393|  1|102914837|                G|                G|
|           1| 7497JWMO|        2|         1:109439680|  1|108897058|                A|                A|
|           1| 7497JWMO|        3|         1:110198788|  1|109656166|                T|                T|
|           1| 7497JWMO|        4|         1:110201112|  1|109658490|                C|                C|
|           1| 7497JWMO|        5|         1:110201667|  1|109659045|                C|                C|
|           1| 7497JWMO|        6|         1:110202904|  1|109660282|                T|                T|
|           1| 7497JWMO|        7|         1:110203240|  1|109660618|                G|                G|
|           1| 7497JWMO|        8|         1:110203911|  1|109661289|                C|                C|
|           1| 7497JWMO|        9|         1:110206675|  1|109664053|                A|                A|
|           1| 7497JWMO|       10|1:110228436_CNV_G...|  1|109685814|                -|                -|
|           1| 7497JWMO|       11|1:110228505_CNV_G...|  1|109685883|                -|                -|
|           1| 7497JWMO|       12|1:110228615_CNV_G...|  1|109685993|                -|                -|
|           1| 7497JWMO|       13|1:110228695_CNV_G...|  1|109686073|                -|                -|
|           1| 7497JWMO|       14|1:110229315_CNV_G...|  1|109686693|                -|                -|
|           1| 7497JWMO|       15|1:110229436_CNV_G...|  1|109686814|                -|                -|
|           1| 7497JWMO|       16|1:110229816_CNV_G...|  1|109687194|                -|                -|
|           1| 7497JWMO|       17|1:110230105_CNV_G...|  1|109687483|                -|                -|
|           1| 7497JWMO|       18|1:110230206_CNV_G...|  1|109687584|                -|                -|
|           1| 7497JWMO|       19|1:110230206_CNV_G...|  1|109687584|                -|                -|
|           1| 7497JWMO|       20|1:110230335_CNV_G...|  1|109687713|                -|                -|
+------------+---------+---------+--------------------+---+---------+-----------------+-----------------+
only showing top 20 rows

23/02/28 07:32:40 WARN package: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
[Stage 4:>                                                          (0 + 5) / 5][Stage 4:===========>                                               (1 + 4) / 5]                                                                                +------------+---------+---------+--------------------+---+---------+-----------------+-----------------+--------------------+
|Sample Index|Sample ID|SNP Index|            SNP Name|Chr| Position|Allele1 - Forward|Allele2 - Forward|          input_file|
+------------+---------+---------+--------------------+---+---------+-----------------+-----------------+--------------------+
|           1| 7497JWMO|        1|         1:103380393|  1|102914837|                G|                G|file:///tmp/tmp7b...|
|           1| 7497JWMO|        2|         1:109439680|  1|108897058|                A|                A|file:///tmp/tmp7b...|
|           1| 7497JWMO|        3|         1:110198788|  1|109656166|                T|                T|file:///tmp/tmp7b...|
|           1| 7497JWMO|        4|         1:110201112|  1|109658490|                C|                C|file:///tmp/tmp7b...|
|           1| 7497JWMO|        5|         1:110201667|  1|109659045|                C|                C|file:///tmp/tmp7b...|
|           1| 7497JWMO|        6|         1:110202904|  1|109660282|                T|                T|file:///tmp/tmp7b...|
|           1| 7497JWMO|        7|         1:110203240|  1|109660618|                G|                G|file:///tmp/tmp7b...|
|           1| 7497JWMO|        8|         1:110203911|  1|109661289|                C|                C|file:///tmp/tmp7b...|
|           1| 7497JWMO|        9|         1:110206675|  1|109664053|                A|                A|file:///tmp/tmp7b...|
|           1| 7497JWMO|       10|1:110228436_CNV_G...|  1|109685814|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       11|1:110228505_CNV_G...|  1|109685883|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       12|1:110228615_CNV_G...|  1|109685993|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       13|1:110228695_CNV_G...|  1|109686073|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       14|1:110229315_CNV_G...|  1|109686693|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       15|1:110229436_CNV_G...|  1|109686814|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       16|1:110229816_CNV_G...|  1|109687194|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       17|1:110230105_CNV_G...|  1|109687483|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       18|1:110230206_CNV_G...|  1|109687584|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       19|1:110230206_CNV_G...|  1|109687584|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       20|1:110230335_CNV_G...|  1|109687713|                -|                -|file:///tmp/tmp7b...|
+------------+---------+---------+--------------------+---+---------+-----------------+-----------------+--------------------+
only showing top 20 rows

+------------+---------+---------+--------------------+---+---------+-----------------+-----------------+--------------------+
|Sample Index|Sample ID|SNP Index|            SNP Name|Chr| Position|Allele1 - Forward|Allele2 - Forward|          input_file|
+------------+---------+---------+--------------------+---+---------+-----------------+-----------------+--------------------+
|           1| 7497JWMO|        1|         1:103380393|  1|102914837|                G|                G|file:///tmp/tmp7b...|
|           1| 7497JWMO|        2|         1:109439680|  1|108897058|                A|                A|file:///tmp/tmp7b...|
|           1| 7497JWMO|        3|         1:110198788|  1|109656166|                T|                T|file:///tmp/tmp7b...|
|           1| 7497JWMO|        4|         1:110201112|  1|109658490|                C|                C|file:///tmp/tmp7b...|
|           1| 7497JWMO|        5|         1:110201667|  1|109659045|                C|                C|file:///tmp/tmp7b...|
|           1| 7497JWMO|        6|         1:110202904|  1|109660282|                T|                T|file:///tmp/tmp7b...|
|           1| 7497JWMO|        7|         1:110203240|  1|109660618|                G|                G|file:///tmp/tmp7b...|
|           1| 7497JWMO|        8|         1:110203911|  1|109661289|                C|                C|file:///tmp/tmp7b...|
|           1| 7497JWMO|        9|         1:110206675|  1|109664053|                A|                A|file:///tmp/tmp7b...|
|           1| 7497JWMO|       10|1:110228436_CNV_G...|  1|109685814|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       11|1:110228505_CNV_G...|  1|109685883|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       12|1:110228615_CNV_G...|  1|109685993|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       13|1:110228695_CNV_G...|  1|109686073|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       14|1:110229315_CNV_G...|  1|109686693|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       15|1:110229436_CNV_G...|  1|109686814|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       16|1:110229816_CNV_G...|  1|109687194|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       17|1:110230105_CNV_G...|  1|109687483|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       18|1:110230206_CNV_G...|  1|109687584|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       19|1:110230206_CNV_G...|  1|109687584|                -|                -|file:///tmp/tmp7b...|
|           1| 7497JWMO|       20|1:110230335_CNV_G...|  1|109687713|                -|                -|file:///tmp/tmp7b...|
+------------+---------+---------+--------------------+---+---------+-----------------+-----------------+--------------------+
only showing top 20 rows

[Stage 5:>                                                          (0 + 5) / 5][Stage 5:=======================>                                   (2 + 3) / 5]                                                                                [Stage 14:>                                                         (0 + 5) / 5][Stage 14:===========>                                              (1 + 4) / 5][Stage 14:=======================>                                  (2 + 3) / 5][Stage 14:==================================>                       (3 + 2) / 5]                                                                                [Stage 17:>                                                         (0 + 5) / 5][Stage 17:=======================>                                  (2 + 3) / 5]                                                                                [Stage 23:>                                                         (0 + 5) / 5][Stage 23:===========>                                              (1 + 4) / 5]                                                                                [Stage 29:>                                                         (0 + 5) / 5][Stage 29:=======================>                                  (2 + 3) / 5]                                                                                [Stage 35:>                                                         (0 + 5) / 5][Stage 35:===========>                                              (1 + 4) / 5]                                                                                [Stage 41:>                                                         (0 + 5) / 5][Stage 41:===========>                                              (1 + 4) / 5][Stage 43:>                                                         (0 + 2) / 2]                                                                                [Stage 47:>                                                         (0 + 5) / 5][Stage 47:===========>                                              (1 + 4) / 5][Stage 47:==============================================>           (4 + 1) / 5]                                                                                [Stage 50:>                                                         (0 + 5) / 5][Stage 50:=======================>                                  (2 + 3) / 5]                                                                                [Stage 53:===========>                                              (1 + 4) / 5]                                                                                [Stage 58:>                                                         (0 + 5) / 5][Stage 58:=======================>                                  (2 + 3) / 5]                                                                                [Stage 61:>                                                         (0 + 5) / 5][Stage 61:=======================>                                  (2 + 3) / 5]                                                                                +------------+---------+---------+----------+---+--------+-----------------+-----------------+--------------------+
|Sample Index|Sample ID|SNP Index|  SNP Name|Chr|Position|Allele1 - Forward|Allele2 - Forward|          input_file|
+------------+---------+---------+----------+---+--------+-----------------+-----------------+--------------------+
|          10| 7499NSMO|   553703|rs66534353|  Y|11355471|                C|                C|file:///tmp/tmp7b...|
|          10| 7499NSMO|   565930| rs7067354|  Y|17204108|                A|                A|file:///tmp/tmp7b...|
|          10| 7499NSMO|   553789| rs6655892|  Y|12952825|                C|                C|file:///tmp/tmp7b...|
|          10| 7499NSMO|   550098| rs6530626|  Y|22301842|                C|                C|file:///tmp/tmp7b...|
|          10| 7499NSMO|   555771|rs67144031|  Y| 9261313|                C|                C|file:///tmp/tmp7b...|
|          10| 7499NSMO|   565920| rs7067297|  Y|19828371|                C|                C|file:///tmp/tmp7b...|
|          10| 7499NSMO|   565929| rs7067348|  Y|19790502|                C|                C|file:///tmp/tmp7b...|
|          10| 7499NSMO|   565921| rs7067303|  Y|19299316|                G|                G|file:///tmp/tmp7b...|
|          10| 7499NSMO|   556960|rs67462087|  Y|22248465|                G|                G|file:///tmp/tmp7b...|
|          10| 7499NSMO|   565922| rs7067305|  Y|12110586|                G|                G|file:///tmp/tmp7b...|
|          10| 7499NSMO|   558838|rs67960559|  Y| 2818686|                G|                G|file:///tmp/tmp7b...|
|          10| 7499NSMO|   565923| rs7067311|  Y|15068409|                C|                C|file:///tmp/tmp7b...|
|          10| 7499NSMO|   565916| rs7067231|  Y|14237030|                A|                A|file:///tmp/tmp7b...|
|          10| 7499NSMO|   565924| rs7067315|  Y|20831894|                G|                G|file:///tmp/tmp7b...|
|          10| 7499NSMO|   565918| rs7067281|  Y|15349598|                T|                T|file:///tmp/tmp7b...|
|          10| 7499NSMO|   565925| rs7067322|  Y| 8636886|                C|                C|file:///tmp/tmp7b...|
|          10| 7499NSMO|   545564|rs62617921|  Y|12210566|                A|                A|file:///tmp/tmp7b...|
|          10| 7499NSMO|   565926| rs7067329|  Y|19379628|                T|                T|file:///tmp/tmp7b...|
|          10| 7499NSMO|   565915| rs7067226|  Y|19821941|                C|                C|file:///tmp/tmp7b...|
|          10| 7499NSMO|   565928| rs7067330|  Y|18995645|                T|                T|file:///tmp/tmp7b...|
+------------+---------+---------+----------+---+--------+-----------------+-----------------+--------------------+
only showing top 20 rows


#####################
#####################
We have as many unique samples in illumina reports as samples in sample map?
#####################
#####################
False
False

#####################
#####################
We have as many genotypes as samples*snps in the maps
#####################
#####################
False

#####################
#####################
Multiple checks within each sample
#####################
#####################
+-------+
|check_1|
+-------+
|   true|
+-------+

CHECK 2:
False
True
CHECK 2b:
True
CHECK 2c:
IMPORTANT: DO WE HAVE DUPLICATED POSITIONS
The difference between the number of SNPs in the map and the distinct positions is 6785
+--------+
|check_2d|
+--------+
|    true|
+--------+

CHECK 3: True
CHECK 4: True
CHECK 5: True
CHECK 6: True
CHECK 7: True
CHECK 8: True
CHECK 9: True
CHECK 10

#####################
#####################
see unique alleles
#####################
#####################
+-----------------+
|Allele1 - Forward|
+-----------------+
|                T|
|                D|
|                C|
|                -|
|                A|
|                G|
|                I|
+-----------------+

+-----------------+
|Allele2 - Forward|
+-----------------+
|                T|
|                D|
|                C|
|                -|
|                A|
|                G|
|                I|
+-----------------+


#####################
#####################
Preparing lgen file
#####################
#####################
+---------+--------------------+-----------------+-----------------+
|Sample ID|            SNP Name|Allele1 - Forward|Allele2 - Forward|
+---------+--------------------+-----------------+-----------------+
| 7497JWMO|         1:103380393|                G|                G|
| 7497JWMO|         1:109439680|                A|                A|
| 7497JWMO|         1:110198788|                T|                T|
| 7497JWMO|         1:110201112|                C|                C|
| 7497JWMO|         1:110201667|                C|                C|
| 7497JWMO|         1:110202904|                T|                T|
| 7497JWMO|         1:110203240|                G|                G|
| 7497JWMO|         1:110203911|                C|                C|
| 7497JWMO|         1:110206675|                A|                A|
| 7497JWMO|1:110228436_CNV_G...|                -|                -|
| 7497JWMO|1:110228505_CNV_G...|                -|                -|
| 7497JWMO|1:110228615_CNV_G...|                -|                -|
| 7497JWMO|1:110228695_CNV_G...|                -|                -|
| 7497JWMO|1:110229315_CNV_G...|                -|                -|
| 7497JWMO|1:110229436_CNV_G...|                -|                -|
| 7497JWMO|1:110229816_CNV_G...|                -|                -|
| 7497JWMO|1:110230105_CNV_G...|                -|                -|
| 7497JWMO|1:110230206_CNV_G...|                -|                -|
| 7497JWMO|1:110230206_CNV_G...|                -|                -|
| 7497JWMO|1:110230335_CNV_G...|                -|                -|
+---------+--------------------+-----------------+-----------------+
only showing top 20 rows

+---------+--------------------+-----------------------+-----------------------+
|Sample ID|            SNP Name|Allele1 - Forward_final|Allele2 - Forward_final|
+---------+--------------------+-----------------------+-----------------------+
| 7497JWMO|         1:103380393|                      G|                      G|
| 7497JWMO|         1:109439680|                      A|                      A|
| 7497JWMO|         1:110198788|                      T|                      T|
| 7497JWMO|         1:110201112|                      C|                      C|
| 7497JWMO|         1:110201667|                      C|                      C|
| 7497JWMO|         1:110202904|                      T|                      T|
| 7497JWMO|         1:110203240|                      G|                      G|
| 7497JWMO|         1:110203911|                      C|                      C|
| 7497JWMO|         1:110206675|                      A|                      A|
| 7497JWMO|1:110228436_CNV_G...|                      0|                      0|
| 7497JWMO|1:110228505_CNV_G...|                      0|                      0|
| 7497JWMO|1:110228615_CNV_G...|                      0|                      0|
| 7497JWMO|1:110228695_CNV_G...|                      0|                      0|
| 7497JWMO|1:110229315_CNV_G...|                      0|                      0|
| 7497JWMO|1:110229436_CNV_G...|                      0|                      0|
| 7497JWMO|1:110229816_CNV_G...|                      0|                      0|
| 7497JWMO|1:110230105_CNV_G...|                      0|                      0|
| 7497JWMO|1:110230206_CNV_G...|                      0|                      0|
| 7497JWMO|1:110230206_CNV_G...|                      0|                      0|
| 7497JWMO|1:110230335_CNV_G...|                      0|                      0|
+---------+--------------------+-----------------------+-----------------------+
only showing top 20 rows


#####################
#####################
Check that all SNPs do NOT have '-' or '--' for allele 1 and 2
#####################
#####################
[Stage 62:>                                                         (0 + 5) / 5][Stage 62:===========>                                              (1 + 4) / 5][Stage 62:==================================>                       (3 + 2) / 5]                                                                                [Stage 63:>                                                         (0 + 5) / 5][Stage 63:===========>                                              (1 + 4) / 5][Stage 63:==============================================>           (4 + 1) / 5][Stage 65:>                                                         (0 + 2) / 2]                                                                                [Stage 66:>                                                         (0 + 5) / 5][Stage 66:===========>                                              (1 + 4) / 5][Stage 66:==================================>                       (3 + 2) / 5]                                                                                [Stage 69:>                                                         (0 + 5) / 5][Stage 69:==============================================>           (4 + 1) / 5]                                                                                +--------------------+---------+---------+-----------------------+-----------------------+
|                 FID|Sample ID| SNP Name|Allele1 - Forward_final|Allele2 - Forward_final|
+--------------------+---------+---------+-----------------------+-----------------------+
|combat_ILGSA24-17873| 7497JWMO|rs6454789|                      C|                      C|
|combat_ILGSA24-17873| 7497JWMO|rs6455540|                      A|                      A|
|combat_ILGSA24-17873| 7497JWMO|rs6454802|                      T|                      C|
|combat_ILGSA24-17873| 7497JWMO|rs6454859|                      A|                      A|
|combat_ILGSA24-17873| 7497JWMO|rs6454881|                      A|                      C|
|combat_ILGSA24-17873| 7497JWMO|rs6454945|                      T|                      T|
|combat_ILGSA24-17873| 7497JWMO|rs6454990|                      A|                      A|
|combat_ILGSA24-17873| 7497JWMO|rs6455017|                      C|                      C|
|combat_ILGSA24-17873| 7497JWMO|rs6455332|                      C|                      C|
|combat_ILGSA24-17873| 7497JWMO|rs6455383|                      T|                      T|
|combat_ILGSA24-17873| 7497JWMO|rs6455386|                      C|                      C|
|combat_ILGSA24-17873| 7497JWMO|rs6455400|                      T|                      C|
|combat_ILGSA24-17873| 7497JWMO|rs6455422|                      G|                      G|
|combat_ILGSA24-17873| 7497JWMO|rs6455455|                      T|                      T|
|combat_ILGSA24-17873| 7497JWMO|rs6455468|                      G|                      G|
|combat_ILGSA24-17873| 7497JWMO|rs6455491|                      G|                      G|
|combat_ILGSA24-17873| 7497JWMO|rs6455507|                      T|                      C|
|combat_ILGSA24-17873| 7497JWMO| rs645551|                      T|                      T|
|combat_ILGSA24-17873| 7497JWMO|rs6455529|                      T|                      C|
|combat_ILGSA24-17873| 7497JWMO|rs6455530|                      A|                      A|
+--------------------+---------+---------+-----------------------+-----------------------+
only showing top 20 rows


#####################
#####################
Preparing fam file
#####################
#####################

#####################
#####################
Check sex in sample map and phenotype data
#####################
#####################
     Gender        Age  ...  Week 8 Pred VO2max  AGRF code
0         M  25.000000  ...                47.7   8244TCOJ
1         M  43.720548  ...                43.6   6976MCJS
2         M  35.049315  ...                49.0   3484JSJJ
3         F  23.561644  ...                43.6   1389HSNM
4         M  26.164384  ...                54.0   7593DBAO
...     ...        ...  ...                 ...        ...
1459    NaN        NaN  ...                 NaN   2471AWMA
1460    NaN        NaN  ...                 NaN   6897TSSS
1461    NaN        NaN  ...                 NaN   6899DWOS
1462    NaN        NaN  ...                 NaN   6296TONJ
1463    NaN        NaN  ...                 NaN   7799BTDO

[1464 rows x 9 columns]
1193    11.1O
Name: Week 8 beep test, dtype: object

#####################
#####################
All samples with genetic data are included in pheno_data?
#####################
#####################
False

#####################
#####################
How many samples with genetic data are included in pheno_data?
#####################
#####################
1242 out 1248

#####################
#####################
The new sex variable is correctly coded?
#####################
#####################
True

#####################
#####################
See fam file:
#####################
#####################
                       FID        ID IID_father IID_mother Gender  phenotype
0     combat_ILGSA24-17873  7497JWMO          0          0      1         -9
1     combat_ILGSA24-17873  7498YQOO          0          0      1         -9
2     combat_ILGSA24-17873  7400RRAO          0          0      1         -9
3     combat_ILGSA24-17873  7494MTNO          0          0      1         -9
4     combat_ILGSA24-17873  7489BMJO          0          0      1         -9
...                    ...       ...        ...        ...    ...        ...
1243  combat_ILGSA24-17873  9596KGSM          0          0      1         -9
1244  combat_ILGSA24-17873  9196GCNM          0          0      1         -9
1245  combat_ILGSA24-17873  9199ACMM          0          0      1         -9
1246  combat_ILGSA24-17873  0197SNMM          0          0      2         -9
1247  combat_ILGSA24-17873  6701ESJS          0          0      2         -9

[1248 rows x 6 columns]

#####################
#####################
Preparing map file
#####################
#####################
         Index           Name Chromosome  ...  ILMN Strand  Customer Strand NormID
0            1    1:103380393          1  ...          BOT              TOP     28
1            2    1:109439680          1  ...          TOP              TOP      1
2            3    1:110198788          1  ...          BOT              BOT      4
3            4    1:110201112          1  ...          BOT              TOP    101
4            5    1:110201667          1  ...          BOT              BOT      1
...        ...            ...        ...  ...          ...              ...    ...
654022  654023  Y:8804321-A-C          Y  ...          BOT              TOP      3
654023  654024  Y:8852748-A-C          Y  ...          BOT              TOP      3
654024  654025  Y:8894070-A-T          Y  ...          TOP              BOT    203
654025  654026  Y:9145267-T-C          Y  ...          BOT              BOT      3
654026  654027  Y:9785736-A-G          Y  ...          TOP              TOP      3

[654027 rows x 9 columns]
       Chromosome           Name  centimorgans   Position
0               1    1:103380393             0  102914837
1               1    1:109439680             0  108897058
2               1    1:110198788             0  109656166
3               1    1:110201112             0  109658490
4               1    1:110201667             0  109659045
...           ...            ...           ...        ...
654022          Y  Y:8804321-A-C             0    8936280
654023          Y  Y:8852748-A-C             0    8984707
654024          Y  Y:8894070-A-T             0    9026029
654025          Y  Y:9145267-T-C             0    9307658
654026          Y  Y:9785736-A-G             0    9948127

[654027 rows x 4 columns]

#####################
#####################
checks with lgen, map and fam files
#####################
#####################
SNPs are the same in lgen and map files?
samples are the same in lgen and fam files?

#####################
#####################
create plink binaries per sample
#####################
#####################

#####################
#####################
We have the correct number of lgen files? i.e., one per sample?
#####################
#####################
False
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./plink_bed_files/ILGSA24-17873/01_bed_per_sample/sample_00001/ILGSA24-17873_sample_00001.log.
Options in effect:
  --lfile ./plink_inputs/ILGSA24-17873/ILGSA24-17873_lgen_files/inputs_sample_00001/part-00001-d8d26f7f-b434-468f-a25e-d1f60a8930fb-c000
  --out ./plink_bed_files/ILGSA24-17873/01_bed_per_sample/sample_00001/ILGSA24-17873_sample_00001
  --recode

64162 MB RAM detected; reserving 32081 MB for main workspace.
Processing .lgen file... 0%PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./plink_bed_files/ILGSA24-17873/01_bed_per_sample/sample_00000/ILGSA24-17873_sample_00000.log.
Options in effect:
  --lfile ./plink_inputs/ILGSA24-17873/ILGSA24-17873_lgen_files/inputs_sample_00000/part-00000-d8d26f7f-b434-468f-a25e-d1f60a8930fb-c000
  --out ./plink_bed_files/ILGSA24-17873/01_bed_per_sample/sample_00000/ILGSA24-17873_sample_00000
  --recode

64162 MB RAM detected; reserving 32081 MB for main workspace.
Processing .lgen file... 0%1%1%2%2%3%3%4%4%5%5%6%6%7%7%8%8%9%9%10%10%11%11%12%12%13%13%14%14%15%15%16%16%17%17%18%18%18%19%18%19%20%20%21%21%22%22%23%23%24%24%25%25%26%26%27%27%28%28%29%29%30%30%31%31%32%32%33%33%34%34%35%35%36%36%37%37%38%38%39%39%40%40%41%41%42%42%43%43%44%44%45%45%46%46%47%47%48%48%49%49%50%50%51%51%52%52%53%53%54%54%55%55%56%56%57%57%58%58%59%59%60%60%61%61%62%62%63%63%64%64%65%65%66%66%67%67%68%68%69%69%69%70%69%70%71%71%72%72%73%73%74%74%75%75%76%76%77%77%78%78%79%79%80%80%81%81%82%82%83%83%84%84%85%85%86%86%87%87%88%88%89%89%90%90%91%91%92%92%93%93%94%94%95%95%96%96%97%97%98%98%99%99%100%100%done.
--lfile:
./plink_bed_files/ILGSA24-17873/01_bed_per_sample/sample_00001/ILGSA24-17873_sample_00001-temporary.bed
+
./plink_bed_files/ILGSA24-17873/01_bed_per_sample/sample_00001/ILGSA24-17873_sample_00001-temporary.bim
+
./plink_bed_files/ILGSA24-17873/01_bed_per_sample/sample_00001/ILGSA24-17873_sample_00001-temporary.fam
written.
654027 variants loaded from .bim file.
1 person (1 male, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1 founder and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%done.
--lfile:
./plink_bed_files/ILGSA24-17873/01_bed_per_sample/sample_00000/ILGSA24-17873_sample_00000-temporary.bed
+
./plink_bed_files/ILGSA24-17873/01_bed_per_sample/sample_00000/ILGSA24-17873_sample_00000-temporary.bim
+
./plink_bed_files/ILGSA24-17873/01_bed_per_sample/sample_00000/ILGSA24-17873_sample_00000-temporary.fam
written.
654027 variants loaded from .bim file.
1 person (1 male, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1 founder and 0 nonfounders present.
Calculating allele frequencies... 0%4%1%5%2%6%3%7%4%8%5%9%6%10%7%11%8%12%9%13%10%14%11%15%12%16%13%17%14%18%15%19%16%20%17%21%18%22%19%23%20%24%21%25%22%26%23%27%24%28%25%29%26%30%27%31%28%32%29%33%30%34%31%35%32%36%33%37%34%38%35%39%36%40%37%41%38%42%39%43%40%44%41%45%42%46%43%47%44%48%45%49%46%50%47%51%48%52%49%53%50%54%51%55%52%56%53%57%54%58%55%59%56%60%57%61%58%62%59%63%60%64%61%65%62%66%63%67%64%68%65%69%66%70%67%71%68%72%69%73%70%74%71%75%72%76%73%77%74%78%75%79%76%80%77%81%78%82%79%83%80%84%81%85%82%86%83%87%84%88%85%89%86%90%87%91%88%92%89%93%90%94%91%95%92%96%93%94%97%95%98%96%99%97% done.
Warning: 3 het. haploid genotypes present (see
./plink_bed_files/ILGSA24-17873/01_bed_per_sample/sample_00001/ILGSA24-17873_sample_00001.hh
); many commands treat these as missing.
98%Total genotyping rate is 0.993344.
654027 variants and 1 person pass filters and QC.
Note: No phenotypes present.
--recode ped to
./plink_bed_files/ILGSA24-17873/01_bed_per_sample/sample_00001/ILGSA24-17873_sample_00001.ped
+
./plink_bed_files/ILGSA24-17873/01_bed_per_sample/sample_00001/ILGSA24-17873_sample_00001.map
... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%99% done.
Warning: 1 het. haploid genotype present (see
./plink_bed_files/ILGSA24-17873/01_bed_per_sample/sample_00000/ILGSA24-17873_sample_00000.hh
); many commands treat these as missing.
Total genotyping rate is 0.993402.
654027 variants and 1 person pass filters and QC.
Note: No phenotypes present.
--recode ped to
./plink_bed_files/ILGSA24-17873/01_bed_per_sample/sample_00000/ILGSA24-17873_sample_00000.ped
+
./plink_bed_files/ILGSA24-17873/01_bed_per_sample/sample_00000/ILGSA24-17873_sample_00000.map
... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
done.
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./ILGSA24-17873_sample_00000.log.
Options in effect:
  --file ./ILGSA24-17873_sample_00000
  --make-bed
  --out ./ILGSA24-17873_sample_00000

64162 MB RAM detected; reserving 32081 MB for main workspace.
Scanning .ped file... 0%100%PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./ILGSA24-17873_sample_00001.log.
Options in effect:
  --file ./ILGSA24-17873_sample_00001
  --make-bed
  --out ./ILGSA24-17873_sample_00001

64162 MB RAM detected; reserving 32081 MB for main workspace.
Scanning .ped file... 0%100%.ped scan complete (for binary autoconversion).
Performing single-pass .bed write (654027 variants, 1 person).
0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%.ped scan complete (for binary autoconversion).
Performing single-pass .bed write (654027 variants, 1 person).
0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%--file: ./ILGSA24-17873_sample_00000-temporary.bed +
./ILGSA24-17873_sample_00000-temporary.bim +
./ILGSA24-17873_sample_00000-temporary.fam written.
654027 variants loaded from .bim file.
1 person (1 male, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1 founder and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%--file: ./ILGSA24-17873_sample_00001-temporary.bed +
./ILGSA24-17873_sample_00001-temporary.bim +
./ILGSA24-17873_sample_00001-temporary.fam written.
654027 variants loaded from .bim file.
1 person (1 male, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1 founder and 0 nonfounders present.
Calculating allele frequencies... 0%36%1%37%2%38%3%39%4%40%5%41%6%42%7%43%8%44%9%45%10%46%11%47%12%48%13%49%14%50%15%51%16%52%17%53%18%54%19%55%20%56%21%57%22%58%23%59%24%60%25%61%26%62%27%63%28%64%29%65%30%66%31%67%32%68%33%69%34%70%35%71%36%72%37%73%38%74%39%75%40%76%41%77%42%78%43%79%44%80%45%81%46%82%47%83%48%84%49%85%50%86%51%87%52%88%53%89%54%90%55%91%56%92%57%93%58%94%59%95%60%96%61%62%97%63%98%64%99%65% done.
Warning: 1 het. haploid genotype present (see ./ILGSA24-17873_sample_00000.hh
); many commands treat these as missing.
66%67%Total genotyping rate is 0.993402.
654027 variants and 1 person pass filters and QC.
Note: No phenotypes present.
68%--make-bed to ./ILGSA24-17873_sample_00000.bed +
./ILGSA24-17873_sample_00000.bim + ./ILGSA24-17873_sample_00000.fam ... 0%1%69%2%70%3%4%71%5%72%6%73%7%74%8%75%9%10%76%11%77%12%78%13%79%14%15%80%16%81%17%82%18%83%19%84%20%21%85%22%86%23%87%24%88%25%26%89%27%90%28%91%29%92%30%93%31%32%94%33%95%34%35%96%36%97%37%38%98%39%40%99%41% done.
Warning: 3 het. haploid genotypes present (see ./ILGSA24-17873_sample_00001.hh
); many commands treat these as missing.
42%43%Total genotyping rate is 0.993344.
654027 variants and 1 person pass filters and QC.
Note: No phenotypes present.
44%--make-bed to ./ILGSA24-17873_sample_00001.bed +
./ILGSA24-17873_sample_00001.bim + ./ILGSA24-17873_sample_00001.fam ... 0%1%45%2%46%3%47%4%48%5%49%6%50%7%51%8%52%9%53%10%54%11%55%12%56%13%57%14%58%15%59%16%60%17%61%18%62%19%63%20%64%21%65%22%66%23%67%24%68%25%69%26%70%27%71%28%72%29%73%30%74%31%75%32%76%33%77%34%78%35%79%36%80%37%81%38%82%39%83%40%84%41%85%42%86%43%87%44%88%45%89%46%90%47%91%48%92%49%93%50%94%51%95%52%96%53%97%54%98%55%99%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
done.
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ../03_merged_data/ILGSA24-17873_merged_data.log.
Options in effect:
  --merge-list ./list_to_merge.txt
  --out ../03_merged_data/ILGSA24-17873_merged_data

64162 MB RAM detected; reserving 32081 MB for main workspace.
Warning: Variants 'rs387907306.1' and 'rs387907306' have the same position.
Warning: Variants 'rs113445782' and 'GSA-rs113445782' have the same position.
Warning: Variants 'rs36083022' and 'GSA-rs36083022' have the same position.
5435 more same-position warnings: see log file.
Performing single-pass merge (2 people, 654027 variants).
Pass 1: fileset #1 complete.                                              Merged fileset written to ../03_merged_data/ILGSA24-17873_merged_data.bed +
../03_merged_data/ILGSA24-17873_merged_data.bim +
../03_merged_data/ILGSA24-17873_merged_data.fam .
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./04_inspect_snp_dup/00_list_dup/ILGSA24-17873_duplicates.log.
Options in effect:
  --bfile ./03_merged_data/ILGSA24-17873_merged_data
  --list-duplicate-vars suppress-first ids-only
  --out ./04_inspect_snp_dup/00_list_dup/ILGSA24-17873_duplicates

64162 MB RAM detected; reserving 32081 MB for main workspace.
654027 variants loaded from .bim file.
2 people (2 males, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 2 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Warning: 4 het. haploid genotypes present (see
./04_inspect_snp_dup/00_list_dup/ILGSA24-17873_duplicates.hh ); many commands
treat these as missing.
Total genotyping rate is 0.993373.
654027 variants and 2 people pass filters and QC.
Note: No phenotypes present.
--list-duplicate-vars report written to
./04_inspect_snp_dup/00_list_dup/ILGSA24-17873_duplicates.dupvar .
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./04_inspect_snp_dup/01_remove_dup/ILGSA24-17873_merged_data_no_snp_dup.log.
Options in effect:
  --bfile ./03_merged_data/ILGSA24-17873_merged_data
  --exclude ./04_inspect_snp_dup/00_list_dup/ILGSA24-17873_duplicates.dupvar
  --make-bed
  --out ./04_inspect_snp_dup/01_remove_dup/ILGSA24-17873_merged_data_no_snp_dup

64162 MB RAM detected; reserving 32081 MB for main workspace.
654027 variants loaded from .bim file.
2 people (2 males, 0 females) loaded from .fam.
--exclude: 649374 variants remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 2 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Warning: 4 het. haploid genotypes present (see
./04_inspect_snp_dup/01_remove_dup/ILGSA24-17873_merged_data_no_snp_dup.hh );
many commands treat these as missing.
Total genotyping rate is 0.9955.
649374 variants and 2 people pass filters and QC.
Note: No phenotypes present.
--make-bed to
./04_inspect_snp_dup/01_remove_dup/ILGSA24-17873_merged_data_no_snp_dup.bed +
./04_inspect_snp_dup/01_remove_dup/ILGSA24-17873_merged_data_no_snp_dup.bim +
./04_inspect_snp_dup/01_remove_dup/ILGSA24-17873_merged_data_no_snp_dup.fam ...
0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./ILGSA24-17873_duplicates.log.
Options in effect:
  --bfile ./ILGSA24-17873_merged_data_no_snp_dup
  --list-duplicate-vars suppress-first ids-only
  --out ./ILGSA24-17873_duplicates

64162 MB RAM detected; reserving 32081 MB for main workspace.
649374 variants loaded from .bim file.
2 people (2 males, 0 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 2 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Warning: 4 het. haploid genotypes present (see ./ILGSA24-17873_duplicates.hh );
many commands treat these as missing.
Total genotyping rate is 0.9955.
649374 variants and 2 people pass filters and QC.
Note: No phenotypes present.
--list-duplicate-vars report written to ./ILGSA24-17873_duplicates.dupvar .
TRUE

#####################
#####################
merge binaries of all samples
#####################
#####################

#####################
#####################
look for duplicates
#####################
#####################

#####################
#####################
the number of duplicates according with plink matches my previous estimation with spark?
#####################
#####################
False

#####################
#####################
Do we have zero duplicated positions after filtering? THIS CHECK CAN BE PRINTED BEFORE THIS LINE
#####################
#####################
