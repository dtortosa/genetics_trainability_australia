Setting default log level to "WARN".
To adjust logging level use sc.setLogLevel(newLevel). For SparkR, use setLogLevel(newLevel).
23/02/28 20:17:01 WARN NativeCodeLoader: Unable to load native-hadoop library for your platform... using builtin-java classes where applicable
#################################################################################################################################
#################################################################################################################################
############################################# STARTING BATCH NUMBER: ILGSA24-17303 ##############################################
#################################################################################################################################
#################################################################################################################################

#######################################
#######################################
Unzipping data: 
#######################################
#######################################
ILGSA24-17303_FinalReport172.txt
ILGSA24-17303_FinalReport100.txt
ILGSA24-17303_FinalReport24.txt
ILGSA24-17303_FinalReport156.txt
SNP_Map.txt
Sample_Map.txt

#######################################
#######################################
the number of files extracted is correct?: 
#######################################
#######################################
False

#######################################
#######################################
the number of listed files is correct?: 
#######################################
#######################################
False

#####################
#####################
read illumina reports and maps with spark
#####################
#####################

#####################
#####################
all the columns in each report are the same than in the first report?
#####################
#####################
True

#####################
#####################
check the column names of the reports DF is correct
#####################
#####################
True
root
 |-- Sample Index: integer (nullable = true)
 |-- Sample ID: string (nullable = true)
 |-- Sample Name: string (nullable = true)
 |-- SNP Index: integer (nullable = true)
 |-- SNP Name: string (nullable = true)
 |-- Chr: string (nullable = true)
 |-- Position: integer (nullable = true)
 |-- GT Score: double (nullable = true)
 |-- GC Score: double (nullable = true)
 |-- Allele1 - AB: string (nullable = true)
 |-- Allele2 - AB: string (nullable = true)
 |-- Allele1 - Top: string (nullable = true)
 |-- Allele2 - Top: string (nullable = true)
 |-- Allele1 - Forward: string (nullable = true)
 |-- Allele2 - Forward: string (nullable = true)
 |-- Allele1 - Design: string (nullable = true)
 |-- Allele2 - Design: string (nullable = true)
 |-- Theta: double (nullable = true)
 |-- R: double (nullable = true)
 |-- X Raw: integer (nullable = true)
 |-- Y Raw: integer (nullable = true)
 |-- X: double (nullable = true)
 |-- Y: double (nullable = true)
 |-- B Allele Freq: double (nullable = true)
 |-- Log R Ratio: double (nullable = true)
 |-- SNP Aux: double (nullable = true)
 |-- SNP: string (nullable = true)
 |-- ILMN Strand: string (nullable = true)
 |-- Top Genomic Sequence: string (nullable = true)
 |-- Customer Strand: string (nullable = true)

None
['Sample Index', 'Sample ID', 'Sample Name', 'SNP Index', 'SNP Name', 'Chr', 'Position', 'GT Score', 'GC Score', 'Allele1 - AB', 'Allele2 - AB', 'Allele1 - Top', 'Allele2 - Top', 'Allele1 - Forward', 'Allele2 - Forward', 'Allele1 - Design', 'Allele2 - Design', 'Theta', 'R', 'X Raw', 'Y Raw', 'X', 'Y', 'B Allele Freq', 'Log R Ratio', 'SNP Aux', 'SNP', 'ILMN Strand', 'Top Genomic Sequence', 'Customer Strand']
+--------------+
|(Position + 1)|
+--------------+
|     102914838|
|     108897059|
|     109656167|
|     109658491|
|     109659046|
|     109660283|
|     109660619|
|     109661290|
|     109664054|
|     109685815|
|     109685884|
|     109685994|
|     109686074|
|     109686694|
|     109686815|
|     109687195|
|     109687484|
|     109687585|
|     109687585|
|     109687714|
+--------------+
only showing top 20 rows

+------------+---------+---------+--------------------+---+---------+-----------------+-----------------+
|Sample Index|Sample ID|SNP Index|            SNP Name|Chr| Position|Allele1 - Forward|Allele2 - Forward|
+------------+---------+---------+--------------------+---+---------+-----------------+-----------------+
|         156| 2491MRDA|        1|         1:103380393|  1|102914837|                G|                G|
|         156| 2491MRDA|        2|         1:109439680|  1|108897058|                A|                A|
|         156| 2491MRDA|        3|         1:110198788|  1|109656166|                T|                T|
|         156| 2491MRDA|        4|         1:110201112|  1|109658490|                C|                C|
|         156| 2491MRDA|        5|         1:110201667|  1|109659045|                C|                C|
|         156| 2491MRDA|        6|         1:110202904|  1|109660282|                T|                T|
|         156| 2491MRDA|        7|         1:110203240|  1|109660618|                G|                G|
|         156| 2491MRDA|        8|         1:110203911|  1|109661289|                C|                C|
|         156| 2491MRDA|        9|         1:110206675|  1|109664053|                A|                A|
|         156| 2491MRDA|       10|1:110228436_CNV_G...|  1|109685814|                -|                -|
|         156| 2491MRDA|       11|1:110228505_CNV_G...|  1|109685883|                -|                -|
|         156| 2491MRDA|       12|1:110228615_CNV_G...|  1|109685993|                -|                -|
|         156| 2491MRDA|       13|1:110228695_CNV_G...|  1|109686073|                -|                -|
|         156| 2491MRDA|       14|1:110229315_CNV_G...|  1|109686693|                -|                -|
|         156| 2491MRDA|       15|1:110229436_CNV_G...|  1|109686814|                -|                -|
|         156| 2491MRDA|       16|1:110229816_CNV_G...|  1|109687194|                -|                -|
|         156| 2491MRDA|       17|1:110230105_CNV_G...|  1|109687483|                -|                -|
|         156| 2491MRDA|       18|1:110230206_CNV_G...|  1|109687584|                -|                -|
|         156| 2491MRDA|       19|1:110230206_CNV_G...|  1|109687584|                -|                -|
|         156| 2491MRDA|       20|1:110230335_CNV_G...|  1|109687713|                -|                -|
+------------+---------+---------+--------------------+---+---------+-----------------+-----------------+
only showing top 20 rows

23/02/28 20:17:08 WARN package: Truncated the string representation of a plan since it was too large. This behavior can be adjusted by setting 'spark.sql.debug.maxToStringFields'.
[Stage 4:>                                                          (0 + 2) / 4][Stage 4:==============>                                            (1 + 3) / 4][Stage 4:=============================>                             (2 + 2) / 4]                                                                                +------------+---------+---------+--------------------+---+---------+-----------------+-----------------+--------------------+
|Sample Index|Sample ID|SNP Index|            SNP Name|Chr| Position|Allele1 - Forward|Allele2 - Forward|          input_file|
+------------+---------+---------+--------------------+---+---------+-----------------+-----------------+--------------------+
|         156| 2491MRDA|        1|         1:103380393|  1|102914837|                G|                G|file:///tmp/tmptg...|
|         156| 2491MRDA|        2|         1:109439680|  1|108897058|                A|                A|file:///tmp/tmptg...|
|         156| 2491MRDA|        3|         1:110198788|  1|109656166|                T|                T|file:///tmp/tmptg...|
|         156| 2491MRDA|        4|         1:110201112|  1|109658490|                C|                C|file:///tmp/tmptg...|
|         156| 2491MRDA|        5|         1:110201667|  1|109659045|                C|                C|file:///tmp/tmptg...|
|         156| 2491MRDA|        6|         1:110202904|  1|109660282|                T|                T|file:///tmp/tmptg...|
|         156| 2491MRDA|        7|         1:110203240|  1|109660618|                G|                G|file:///tmp/tmptg...|
|         156| 2491MRDA|        8|         1:110203911|  1|109661289|                C|                C|file:///tmp/tmptg...|
|         156| 2491MRDA|        9|         1:110206675|  1|109664053|                A|                A|file:///tmp/tmptg...|
|         156| 2491MRDA|       10|1:110228436_CNV_G...|  1|109685814|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       11|1:110228505_CNV_G...|  1|109685883|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       12|1:110228615_CNV_G...|  1|109685993|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       13|1:110228695_CNV_G...|  1|109686073|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       14|1:110229315_CNV_G...|  1|109686693|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       15|1:110229436_CNV_G...|  1|109686814|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       16|1:110229816_CNV_G...|  1|109687194|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       17|1:110230105_CNV_G...|  1|109687483|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       18|1:110230206_CNV_G...|  1|109687584|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       19|1:110230206_CNV_G...|  1|109687584|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       20|1:110230335_CNV_G...|  1|109687713|                -|                -|file:///tmp/tmptg...|
+------------+---------+---------+--------------------+---+---------+-----------------+-----------------+--------------------+
only showing top 20 rows

+------------+---------+---------+--------------------+---+---------+-----------------+-----------------+--------------------+
|Sample Index|Sample ID|SNP Index|            SNP Name|Chr| Position|Allele1 - Forward|Allele2 - Forward|          input_file|
+------------+---------+---------+--------------------+---+---------+-----------------+-----------------+--------------------+
|         156| 2491MRDA|        1|         1:103380393|  1|102914837|                G|                G|file:///tmp/tmptg...|
|         156| 2491MRDA|        2|         1:109439680|  1|108897058|                A|                A|file:///tmp/tmptg...|
|         156| 2491MRDA|        3|         1:110198788|  1|109656166|                T|                T|file:///tmp/tmptg...|
|         156| 2491MRDA|        4|         1:110201112|  1|109658490|                C|                C|file:///tmp/tmptg...|
|         156| 2491MRDA|        5|         1:110201667|  1|109659045|                C|                C|file:///tmp/tmptg...|
|         156| 2491MRDA|        6|         1:110202904|  1|109660282|                T|                T|file:///tmp/tmptg...|
|         156| 2491MRDA|        7|         1:110203240|  1|109660618|                G|                G|file:///tmp/tmptg...|
|         156| 2491MRDA|        8|         1:110203911|  1|109661289|                C|                C|file:///tmp/tmptg...|
|         156| 2491MRDA|        9|         1:110206675|  1|109664053|                A|                A|file:///tmp/tmptg...|
|         156| 2491MRDA|       10|1:110228436_CNV_G...|  1|109685814|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       11|1:110228505_CNV_G...|  1|109685883|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       12|1:110228615_CNV_G...|  1|109685993|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       13|1:110228695_CNV_G...|  1|109686073|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       14|1:110229315_CNV_G...|  1|109686693|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       15|1:110229436_CNV_G...|  1|109686814|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       16|1:110229816_CNV_G...|  1|109687194|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       17|1:110230105_CNV_G...|  1|109687483|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       18|1:110230206_CNV_G...|  1|109687584|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       19|1:110230206_CNV_G...|  1|109687584|                -|                -|file:///tmp/tmptg...|
|         156| 2491MRDA|       20|1:110230335_CNV_G...|  1|109687713|                -|                -|file:///tmp/tmptg...|
+------------+---------+---------+--------------------+---+---------+-----------------+-----------------+--------------------+
only showing top 20 rows

[Stage 5:=============================>                             (2 + 2) / 4]                                                                                [Stage 11:=============================>                            (2 + 2) / 4]                                                                                [Stage 14:>                                                         (0 + 2) / 4][Stage 14:=============================>                            (2 + 2) / 4]                                                                                [Stage 17:>                                                         (0 + 2) / 4][Stage 17:=============================>                            (2 + 2) / 4]