
#######################################
#######################################
checking function to print nicely: header 1
#######################################
#######################################

###### checking function to print nicely: header 2 ######

## checking function to print nicely: header 3 ##

# checking function to print nicely: header 4 #

#######################################
#######################################
check behaviour run_bash
#######################################
#######################################

###### see working directory ######
/home/dftortosa/diego_docs/science/other_projects/australian_army_bishop/heavy_analyses/australian_army_bishop/quality_control


###### list files/folders there ######
02a_pre_imputation_qc.out
02bb_pre_imputation_qc_eval_admix_plot.Rout
data
literature
scripts
singularity_containers


#######################################
#######################################
starting with the pre-imputation QC using 28 cores 
#######################################
#######################################

###### merging batches ######

## check we have 216 and 1242 samples for batch 1 and 2 (batch 2 lost 6 samples that were duplicated), respectively looking at the merged fam file of each batch and the list of samples to be merged ##
TRUE

TRUE


## create new folders to store files ##
total 8
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 19 20:23 data_to_merge
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 19 20:23 merged_plink_files


## copy the plink files of both batches ##
total 97656
-rw-r--r-- 1 dftortosa dftortosa 13585705 Dec 20 21:39 ILGSA24-17303_merged_data.bed.gz
-rw-r--r-- 1 dftortosa dftortosa  6354595 Dec 20 21:39 ILGSA24-17303_merged_data.bim.gz
-rw-r--r-- 1 dftortosa dftortosa     1108 Dec 20 21:39 ILGSA24-17303_merged_data.fam.gz
-rw-r--r-- 1 dftortosa dftortosa   457913 Dec 20 21:39 ILGSA24-17303_merged_data.log
-rw-r--r-- 1 dftortosa dftortosa 72767656 Dec 20 21:39 ILGSA24-17873_merged_data.bed.gz
-rw-r--r-- 1 dftortosa dftortosa  6349290 Dec 20 21:39 ILGSA24-17873_merged_data.bim.gz
-rw-r--r-- 1 dftortosa dftortosa     5854 Dec 20 21:39 ILGSA24-17873_merged_data.fam.gz
-rw-r--r-- 1 dftortosa dftortosa   457914 Dec 20 21:39 ILGSA24-17873_merged_data.log
-rw-rw-r-- 1 dftortosa dftortosa       52 Dec 19 20:22 list_files_to_merge.txt


## create a .txt with the name of the plink inputs for each batch ##
total 97656
-rw-r--r-- 1 dftortosa dftortosa 13585705 Dec 20 21:39 ILGSA24-17303_merged_data.bed.gz
-rw-r--r-- 1 dftortosa dftortosa  6354595 Dec 20 21:39 ILGSA24-17303_merged_data.bim.gz
-rw-r--r-- 1 dftortosa dftortosa     1108 Dec 20 21:39 ILGSA24-17303_merged_data.fam.gz
-rw-r--r-- 1 dftortosa dftortosa   457913 Dec 20 21:39 ILGSA24-17303_merged_data.log
-rw-r--r-- 1 dftortosa dftortosa 72767656 Dec 20 21:39 ILGSA24-17873_merged_data.bed.gz
-rw-r--r-- 1 dftortosa dftortosa  6349290 Dec 20 21:39 ILGSA24-17873_merged_data.bim.gz
-rw-r--r-- 1 dftortosa dftortosa     5854 Dec 20 21:39 ILGSA24-17873_merged_data.fam.gz
-rw-r--r-- 1 dftortosa dftortosa   457914 Dec 20 21:39 ILGSA24-17873_merged_data.log
-rw-rw-r-- 1 dftortosa dftortosa       52 Dec 20 21:39 list_files_to_merge.txt
ILGSA24-17303_merged_data
ILGSA24-17873_merged_data


## decompress the plink inputs ##
total 369788
-rw-r--r-- 1 dftortosa dftortosa  35317461 Dec 20 21:39 ILGSA24-17303_merged_data.bed
-rw-r--r-- 1 dftortosa dftortosa  13585705 Dec 20 21:39 ILGSA24-17303_merged_data.bed.gz
-rw-r--r-- 1 dftortosa dftortosa  19936667 Dec 20 21:39 ILGSA24-17303_merged_data.bim
-rw-r--r-- 1 dftortosa dftortosa   6354595 Dec 20 21:39 ILGSA24-17303_merged_data.bim.gz
-rw-r--r-- 1 dftortosa dftortosa      8424 Dec 20 21:39 ILGSA24-17303_merged_data.fam
-rw-r--r-- 1 dftortosa dftortosa      1108 Dec 20 21:39 ILGSA24-17303_merged_data.fam.gz
-rw-r--r-- 1 dftortosa dftortosa    457913 Dec 20 21:39 ILGSA24-17303_merged_data.log
-rw-r--r-- 1 dftortosa dftortosa 203402400 Dec 20 21:39 ILGSA24-17873_merged_data.bed
-rw-r--r-- 1 dftortosa dftortosa  72767656 Dec 20 21:39 ILGSA24-17873_merged_data.bed.gz
-rw-r--r-- 1 dftortosa dftortosa  19936667 Dec 20 21:39 ILGSA24-17873_merged_data.bim
-rw-r--r-- 1 dftortosa dftortosa   6349290 Dec 20 21:39 ILGSA24-17873_merged_data.bim.gz
-rw-r--r-- 1 dftortosa dftortosa     48438 Dec 20 21:39 ILGSA24-17873_merged_data.fam
-rw-r--r-- 1 dftortosa dftortosa      5854 Dec 20 21:39 ILGSA24-17873_merged_data.fam.gz
-rw-r--r-- 1 dftortosa dftortosa    457914 Dec 20 21:39 ILGSA24-17873_merged_data.log
-rw-rw-r-- 1 dftortosa dftortosa        52 Dec 20 21:39 list_files_to_merge.txt


## merge the two batches using two different approaches in plink: --merge-list and --bmerge ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ../merged_plink_files/merged_batches.log.
Options in effect:
  --merge-list ./list_files_to_merge.txt
  --out ../merged_plink_files/merged_batches

63997 MB RAM detected; reserving 31998 MB for main workspace.
Performing single-pass merge (1458 people, 654027 variants).

Pass 1: fileset #1 complete.
                                              
Merged fileset written to ../merged_plink_files/merged_batches.bed +
../merged_plink_files/merged_batches.bim +
../merged_plink_files/merged_batches.fam .

Warning: Variants 'rs387907306.1' and 'rs387907306' have the same position.
Warning: Variants 'rs113445782' and 'GSA-rs113445782' have the same position.
Warning: Variants 'rs36083022' and 'GSA-rs36083022' have the same position.
5435 more same-position warnings: see log file.

PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ../merged_plink_files/merged_batches_2.log.
Options in effect:
  --bfile ILGSA24-17303_merged_data
  --bmerge ILGSA24-17873_merged_data
  --out ../merged_plink_files/merged_batches_2

63997 MB RAM detected; reserving 31998 MB for main workspace.
216 people loaded from ILGSA24-17303_merged_data.fam.
1242 people to be merged from ILGSA24-17873_merged_data.fam.
Of these, 1242 are new, while 0 are present in the base dataset.
654027 markers loaded from ILGSA24-17303_merged_data.bim.
654027 markers to be merged from ILGSA24-17873_merged_data.bim.
Of these, 0 are new, while 654027 are present in the base dataset.
Performing single-pass merge (1458 people, 654027 variants).

Pass 1: fileset #1 complete.
                                              
Merged fileset written to ../merged_plink_files/merged_batches_2.bed +
../merged_plink_files/merged_batches_2.bim +
../merged_plink_files/merged_batches_2.fam .

Warning: Variants 'rs387907306.1' and 'rs387907306' have the same position.
Warning: Variants 'rs113445782' and 'GSA-rs113445782' have the same position.
Warning: Variants 'rs36083022' and 'GSA-rs36083022' have the same position.
5435 more same-position warnings: see log file.


## check that merging the two batches with --merge-list and --bmerge gives the same ##
TRUE


## remove the second fileset created only for the check ##
TRUE


## check that the number of unique sample IDs in the merged fam file is equal to the total number of samples, i.e., no ID is duplicated ##
TRUE


## check we do NOT have a .missnp file, where variants with more than two alleles are indicated. We should not have this file ##
TRUE

ls: cannot access '*.missnp': No such file or directory


## check that the bim files (SNP maps) of both batches and the merged file have the same SNPs, although the minor can be different ##
TRUE


## see if the first SNPs that have different minor/major allele between batches are indeed different in terms of frequency and alleles according to plink --freq ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to plink.log.
Options in effect:
  --bfile ./data_to_merge/ILGSA24-17303_merged_data
  --freq

63997 MB RAM detected; reserving 31998 MB for main workspace.
654027 variants loaded from .bim file.
216 people (165 males, 17 females, 34 ambiguous) loaded from .fam.
Ambiguous sex IDs written to plink.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 216 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.988162.
--freq: Allele frequencies (founders only) written to plink.frq .
 CHR                                             SNP   A1   A2          MAF  NCHROBS
   0                                 GSA-10:47138541    0    C            0      428
   0                                 GSA-rs145797772    A    C     0.006977      430

Warning: 22460 het. haploid genotypes present (see plink.hh ); many commands
treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.

PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to plink.log.
Options in effect:
  --bfile ./data_to_merge/ILGSA24-17873_merged_data
  --freq

63997 MB RAM detected; reserving 31998 MB for main workspace.
654027 variants loaded from .bim file.
1242 people (1057 males, 177 females, 8 ambiguous) loaded from .fam.
Ambiguous sex IDs written to plink.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1242 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.992153.
--freq: Allele frequencies (founders only) written to plink.frq .
 CHR                                             SNP   A1   A2          MAF  NCHROBS
   0                                 GSA-10:47138541    T    C    0.0008065     2480
   0                                 GSA-rs145797772    0    C            0     2480

Warning: 30972 het. haploid genotypes present (see plink.hh ); many commands
treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.

PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to plink.log.
Options in effect:
  --bfile ./merged_plink_files/merged_batches
  --freq

63997 MB RAM detected; reserving 31998 MB for main workspace.
654027 variants loaded from .bim file.
1458 people (1222 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to plink.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1458 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.991562.
--freq: Allele frequencies (founders only) written to plink.frq .
 CHR                                             SNP   A1   A2          MAF  NCHROBS
   0                                 GSA-10:47138541    T    C    0.0006878     2908
   0                                 GSA-rs145797772    A    C     0.001031     2910

Warning: 53432 het. haploid genotypes present (see plink.hh ); many commands
treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


## remove freq files ##
total 8
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:39 data_to_merge
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:39 merged_plink_files


## compress the merged files ##
total 355612
-rw-rw-r-- 1 dftortosa dftortosa  86364095 Dec 20 21:39 merged_batches.bed.gz
-rw-rw-r-- 1 dftortosa dftortosa   6340275 Dec 20 21:39 merged_batches.bim.gz
-rw-rw-r-- 1 dftortosa dftortosa      7003 Dec 20 21:39 merged_batches.fam.gz
-rw-rw-r-- 1 dftortosa dftortosa    457962 Dec 20 21:39 merged_batches.log
-rw-r--r-- 1 dftortosa dftortosa 143931915 Dec 19 20:23 plink.frq.strat
-rw-rw-r-- 1 dftortosa dftortosa   2184602 Dec 19 20:23 plink.hh
-rw-r--r-- 1 dftortosa dftortosa    105048 Dec 19 20:23 plink.imiss
-rw-r--r-- 1 dftortosa dftortosa  52439486 Dec 19 20:23 plink.lmiss
-rw-rw-r-- 1 dftortosa dftortosa      1197 Dec 19 20:23 plink.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 19 20:23 plink.nosex
-rw-rw-r-- 1 dftortosa dftortosa  72219200 Dec 19 20:23 plink_awk_processed.frq.strat
-rw-rw-r-- 1 dftortosa dftortosa     77140 Dec 19 20:23 plink_awk_processed.imiss


###### remove the decompressed input files ######
total 97656
-rw-r--r-- 1 dftortosa dftortosa 13585705 Dec 20 21:39 ILGSA24-17303_merged_data.bed.gz
-rw-r--r-- 1 dftortosa dftortosa  6354595 Dec 20 21:39 ILGSA24-17303_merged_data.bim.gz
-rw-r--r-- 1 dftortosa dftortosa     1108 Dec 20 21:39 ILGSA24-17303_merged_data.fam.gz
-rw-r--r-- 1 dftortosa dftortosa   457913 Dec 20 21:39 ILGSA24-17303_merged_data.log
-rw-r--r-- 1 dftortosa dftortosa 72767656 Dec 20 21:39 ILGSA24-17873_merged_data.bed.gz
-rw-r--r-- 1 dftortosa dftortosa  6349290 Dec 20 21:39 ILGSA24-17873_merged_data.bim.gz
-rw-r--r-- 1 dftortosa dftortosa     5854 Dec 20 21:39 ILGSA24-17873_merged_data.fam.gz
-rw-r--r-- 1 dftortosa dftortosa   457914 Dec 20 21:39 ILGSA24-17873_merged_data.log
-rw-rw-r-- 1 dftortosa dftortosa       52 Dec 20 21:39 list_files_to_merge.txt


## check again we have the exact sum of samples from both batches ##
TRUE


## check again after merging we still have 654027 snps, and this is the number of variants than in each of the batches ##
TRUE


###### do some checks on the plink files of the batch ######

## perform missing report with the merged data ##

# calculate missing reports of the plink file sets generated in the previous step #
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to plink.log.
Options in effect:
  --bfile ./merged_batches
  --missing

63997 MB RAM detected; reserving 31998 MB for main workspace.
654027 variants loaded from .bim file.
1458 people (1222 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to plink.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1458 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.991562.
--missing: Sample missing data report written to plink.imiss, and variant-based
missing data report written to plink.lmiss.
total 608268
-rw-rw-r-- 1 dftortosa dftortosa 238719858 Dec 20 21:39 merged_batches.bed
-rw-rw-r-- 1 dftortosa dftortosa  86364095 Dec 20 21:39 merged_batches.bed.gz
-rw-rw-r-- 1 dftortosa dftortosa  19936667 Dec 20 21:39 merged_batches.bim
-rw-rw-r-- 1 dftortosa dftortosa   6340275 Dec 20 21:39 merged_batches.bim.gz
-rw-rw-r-- 1 dftortosa dftortosa     56862 Dec 20 21:39 merged_batches.fam
-rw-rw-r-- 1 dftortosa dftortosa      7003 Dec 20 21:39 merged_batches.fam.gz
-rw-rw-r-- 1 dftortosa dftortosa    457962 Dec 20 21:39 merged_batches.log
-rw-r--r-- 1 dftortosa dftortosa 143931915 Dec 19 20:23 plink.frq.strat
-rw-rw-r-- 1 dftortosa dftortosa   2184602 Dec 20 21:39 plink.hh
-rw-r--r-- 1 dftortosa dftortosa    105048 Dec 20 21:39 plink.imiss
-rw-r--r-- 1 dftortosa dftortosa  52439486 Dec 20 21:39 plink.lmiss
-rw-rw-r-- 1 dftortosa dftortosa      1192 Dec 20 21:39 plink.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:39 plink.nosex
-rw-rw-r-- 1 dftortosa dftortosa  72219200 Dec 19 20:23 plink_awk_processed.frq.strat
-rw-rw-r-- 1 dftortosa dftortosa     77140 Dec 19 20:23 plink_awk_processed.imiss

gzip: ./merged_batches.log: unknown suffix -- ignored
Warning: 53432 het. haploid genotypes present (see plink.hh ); many commands
treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


# see first rows of the missing report for samples #
                   FID        IID MISS_PHENO   N_MISS   N_GENO   F_MISS
  combat_ILGSA24-17303   0200ADMM          Y     4314   654027 0.006596
  combat_ILGSA24-17303   0200ASJM          Y     4268   649889 0.006567
  combat_ILGSA24-17303   0200BHNM          Y     4416   649889 0.006795
  combat_ILGSA24-17303   0200CBOM          Y     4997   654027  0.00764
  combat_ILGSA24-17303   0200CDFM          Y     4302   649889  0.00662
  combat_ILGSA24-17303   0200CDJM          Y     4277   649889 0.006581
  combat_ILGSA24-17303   0200JCJM          Y     6155   654027 0.009411
  combat_ILGSA24-17303   0200JCMM          Y     4255   654027 0.006506


## check about the number of genotypes in the DNA report file ##

# load the bim file #

# check that the number of variants with 0 for the allele1 and allele2 is 3846 #
the number of SNPs with allele1 and allele1 as zero is 3846, which is exactly the number of SNPs lacking in the sum of SNPs called+non-called of the DNA report for each individual. This explains that this sum does not total to 654027. These cases with allele1 and allele2 as zero cannot have genotypes (there are no alleles), and without genotypes you cannot calculate the GS_score, which is used to determine whether a SNP is called or not.

## check what is going on with the samples in the missing file whose potential number of total SNPs is lower ##

# see the distinct values for the number of potential SNPs across the whole sample missing report #
N_GENO
654027
649889


# process the sample missing file with awk in order to read it with pandas #


# load the missing sample report and the fam file into python #

# check we have the correct number of samples in each batch #
True
True

# calculate the number of variants excluding those in Y chromosome #
649889

# check that the number of unique cases for n_snps in sample missing is only 2, being one the total number of snps and the second the number of snps minus Y snps. Also check that the samples in the missing report with less than 654027 are non-males, because they should not have SNPs in Y chromosome (chromosome 24) #
We do have the expected number of potential genotypes for samples in the missing report according to the number of non-Y variants in non-male samples. Y SNPs in females are obligatory missing, so they are not counted.

## check differences in call rate and MAF between batches. According to Ritchie's tutorial, one simple approach to detect batch effects is to calculate the average minor allele frequency and average genotyping call rate across all SNPs for each batch. Gross differences in either of these on any batch can easily be identified ##

# call rate #
average call rate for batch 1 and 2 is 0.988 and 0.992, respectively
The difference in call rate between batches is 0.004%

# MAF #
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to plink.log.
Options in effect:
  --bfile ./merged_batches
  --family
  --freq

63997 MB RAM detected; reserving 31998 MB for main workspace.
654027 variants loaded from .bim file.
1458 people (1222 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to plink.nosex .
--family: 2 clusters defined.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1458 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.991562.
--freq: Cluster-stratified allele frequencies (founders only) written to
plink.frq.strat .
total 608268
-rw-rw-r-- 1 dftortosa dftortosa 238719858 Dec 20 21:39 merged_batches.bed
-rw-rw-r-- 1 dftortosa dftortosa  86364095 Dec 20 21:39 merged_batches.bed.gz
-rw-rw-r-- 1 dftortosa dftortosa  19936667 Dec 20 21:39 merged_batches.bim
-rw-rw-r-- 1 dftortosa dftortosa   6340275 Dec 20 21:39 merged_batches.bim.gz
-rw-rw-r-- 1 dftortosa dftortosa     56862 Dec 20 21:39 merged_batches.fam
-rw-rw-r-- 1 dftortosa dftortosa      7003 Dec 20 21:39 merged_batches.fam.gz
-rw-rw-r-- 1 dftortosa dftortosa    457962 Dec 20 21:39 merged_batches.log
-rw-r--r-- 1 dftortosa dftortosa 143931915 Dec 20 21:39 plink.frq.strat
-rw-rw-r-- 1 dftortosa dftortosa   2184602 Dec 20 21:39 plink.hh
-rw-r--r-- 1 dftortosa dftortosa    105048 Dec 20 21:39 plink.imiss
-rw-r--r-- 1 dftortosa dftortosa  52439486 Dec 20 21:39 plink.lmiss
-rw-rw-r-- 1 dftortosa dftortosa      1197 Dec 20 21:39 plink.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:39 plink.nosex
-rw-rw-r-- 1 dftortosa dftortosa  72219200 Dec 19 20:23 plink_awk_processed.frq.strat
-rw-rw-r-- 1 dftortosa dftortosa     77140 Dec 20 21:39 plink_awk_processed.imiss

Warning: 53432 het. haploid genotypes present (see plink.hh ); many commands
treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.

CHR	SNP	CLST	A1	A2	MAF	MAC	NCHROBS
0	10:86912383	combat_ILGSA24-17303	0	I	0	0	430
0	10:86912383	combat_ILGSA24-17873	0	I	0	0	2482
0	1:145030589	combat_ILGSA24-17303	T	G	0.01408	6	426
0	1:145030589	combat_ILGSA24-17873	T	G	0.01174	29	2470
0	22:24301858_CNV_GSTT2B_Ilmndup1	combat_ILGSA24-17303	0	0	0	0	0
0	22:24301858_CNV_GSTT2B_Ilmndup1	combat_ILGSA24-17873	0	0	0	0	0
0	22:24301858_CNV_GSTT2B_Ilmndup2	combat_ILGSA24-17303	0	0	0	0	0
0	22:24301858_CNV_GSTT2B_Ilmndup2	combat_ILGSA24-17873	0	0	0	0	0
0	22:24301858_CNV_GSTT2B_Ilmndup3	combat_ILGSA24-17303	0	0	0	0	0

average MAF for batch 1 and 2 is 0.122 and 0.12, respectively
The difference in call rate between batches is 0.002%

## check we have the correct number of samples looking at the merged fam file ##
TRUE


## check that we do NOT have the duplicate samples (1100JHJM, 1200JPJM and 7800AGSO) in the second batch ##
TRUE


###### Remove SNPs duplicated. We are going to remove first duplicates because this should not be affected by population structure ######

## check we have 654027 SNPs, saving the number of SNPs into a variable ##
654027

True

## check SNPs IDs are not duplicated, as plink 1.9 does not look for duplicates using the ID ##
TRUE


## check again SNPs IDs are not duplicated using pandas ##

## list duplicated SNPs ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./quality_control/00_snp_duplicates/list_duplicates.log.
Options in effect:
  --bfile ./plink_bed_files/merged_batches/merged_plink_files/merged_batches
  --list-duplicate-vars suppress-first ids-only
  --out ./quality_control/00_snp_duplicates/list_duplicates

63997 MB RAM detected; reserving 31998 MB for main workspace.
654027 variants loaded from .bim file.
1458 people (1222 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./quality_control/00_snp_duplicates/list_duplicates.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1458 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.991562.
654027 variants and 1458 people pass filters and QC.
Note: No phenotypes present.
--list-duplicate-vars report written to
./quality_control/00_snp_duplicates/list_duplicates.dupvar .
total 2216
-rw-rw-r-- 1 dftortosa dftortosa   72023 Dec 20 21:39 list_duplicates.dupvar
-rw-rw-r-- 1 dftortosa dftortosa 2184602 Dec 20 21:39 list_duplicates.hh
-rw-rw-r-- 1 dftortosa dftortosa    1439 Dec 20 21:39 list_duplicates.log
-rw-rw-r-- 1 dftortosa dftortosa    1260 Dec 20 21:39 list_duplicates.nosex

Warning: 53432 het. haploid genotypes present (see
./quality_control/00_snp_duplicates/list_duplicates.hh ); many commands treat
these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


## load the files with duplicates into pandas ##
                                                      0
0                                  9:136149096-CAGT-CGA
1     GSA-rs142775857 exm1660072 rs184047537 rs20028...
2     22:24301858_CNV_GSTT2B_Ilmndup2 22:24301858_CN...
3     GSA-1:145032464 GSA-1:145066921 GSA-9:40357724...
4     GSA-1:143919714 GSA-1:144087945 GSA-1:14502177...
...                                                 ...
2596                                         exm2216500
2597                                        rs117565943
2598                                         rs35134837
2599                                     exm-rs41378955
2600                                  MTReverseDLOOP_61

[2601 rows x 1 columns]

## the file generated has in each row ALL snps that have the same position and alleles, except the first one, thus, the number of rows it is not the total number of duplicates. Therefore, we need also to know the number of snps in each row. ##
For example: GSA-rs142775857 rs184047537 rs200286606

## see number of plink duplicates ##
3536
The number of duplicates is 0.540650462442682 percent respect to the total number of SNPs

## calculate the number of duplicates with pandas and check is the same than plink duplicates. As we want to consider as duplicates SNPs with the same alleles, irrespectively of the assigment, we need to create a new column where we get both alleles in the same order independently if allele 1 is A or T. Therefore A1=A and A2=T will be the same than A1=T and A2=A, i.e., AT. ##
True

## if there are less than 2% of duplicates, cool, else stop ##
less than 2% of duplicates, good to go!

## filter these snps ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./quality_control/00_snp_duplicates/merged_batches_no_snp_duplicates.log.
Options in effect:
  --bfile ./plink_bed_files/merged_batches/merged_plink_files/merged_batches
  --exclude ./quality_control/00_snp_duplicates/list_duplicates.dupvar
  --make-bed
  --out ./quality_control/00_snp_duplicates/merged_batches_no_snp_duplicates

63997 MB RAM detected; reserving 31998 MB for main workspace.
654027 variants loaded from .bim file.
1458 people (1222 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./quality_control/00_snp_duplicates/merged_batches_no_snp_duplicates.nosex .
--exclude: 650491 variants remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1458 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.993691.
650491 variants and 1458 people pass filters and QC.
Note: No phenotypes present.
--make-bed to
./quality_control/00_snp_duplicates/merged_batches_no_snp_duplicates.bed +
./quality_control/00_snp_duplicates/merged_batches_no_snp_duplicates.bim +
./quality_control/00_snp_duplicates/merged_batches_no_snp_duplicates.fam ...
0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
total 255596
-rw-rw-r-- 1 dftortosa dftortosa     72023 Dec 20 21:39 list_duplicates.dupvar
-rw-rw-r-- 1 dftortosa dftortosa   2184602 Dec 20 21:39 list_duplicates.hh
-rw-rw-r-- 1 dftortosa dftortosa      1439 Dec 20 21:39 list_duplicates.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:39 list_duplicates.nosex
-rw-rw-r-- 1 dftortosa dftortosa 237429218 Dec 20 21:40 merged_batches_no_snp_duplicates.bed
-rw-rw-r-- 1 dftortosa dftortosa  19803358 Dec 20 21:40 merged_batches_no_snp_duplicates.bim
-rw-rw-r-- 1 dftortosa dftortosa     56862 Dec 20 21:40 merged_batches_no_snp_duplicates.fam
-rw-rw-r-- 1 dftortosa dftortosa   2155413 Dec 20 21:40 merged_batches_no_snp_duplicates.hh
-rw-rw-r-- 1 dftortosa dftortosa      1710 Dec 20 21:40 merged_batches_no_snp_duplicates.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_no_snp_duplicates.nosex

Warning: 52716 het. haploid genotypes present (see
./quality_control/00_snp_duplicates/merged_batches_no_snp_duplicates.hh ); many
commands treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


###### remove the non-compressed fileset of the input folder ######
total 355612
-rw-rw-r-- 1 dftortosa dftortosa  86364095 Dec 20 21:39 merged_batches.bed.gz
-rw-rw-r-- 1 dftortosa dftortosa   6340275 Dec 20 21:39 merged_batches.bim.gz
-rw-rw-r-- 1 dftortosa dftortosa      7003 Dec 20 21:39 merged_batches.fam.gz
-rw-rw-r-- 1 dftortosa dftortosa    457962 Dec 20 21:39 merged_batches.log
-rw-r--r-- 1 dftortosa dftortosa 143931915 Dec 20 21:39 plink.frq.strat
-rw-rw-r-- 1 dftortosa dftortosa   2184602 Dec 20 21:39 plink.hh
-rw-r--r-- 1 dftortosa dftortosa    105048 Dec 20 21:39 plink.imiss
-rw-r--r-- 1 dftortosa dftortosa  52439486 Dec 20 21:39 plink.lmiss
-rw-rw-r-- 1 dftortosa dftortosa      1197 Dec 20 21:39 plink.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:39 plink.nosex
-rw-rw-r-- 1 dftortosa dftortosa  72219200 Dec 20 21:39 plink_awk_processed.frq.strat
-rw-rw-r-- 1 dftortosa dftortosa     77140 Dec 20 21:39 plink_awk_processed.imiss


## check again for duplicates ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./check_no_duplicates/check_duplicates.log.
Options in effect:
  --bfile ./merged_batches_no_snp_duplicates
  --list-duplicate-vars suppress-first ids-only
  --out ./check_no_duplicates/check_duplicates

63997 MB RAM detected; reserving 31998 MB for main workspace.
650491 variants loaded from .bim file.
1458 people (1222 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to ./check_no_duplicates/check_duplicates.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1458 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.993691.
650491 variants and 1458 people pass filters and QC.
Note: No phenotypes present.
--list-duplicate-vars report written to
./check_no_duplicates/check_duplicates.dupvar .
total 2116
-rw-rw-r-- 1 dftortosa dftortosa       0 Dec 20 21:40 check_duplicates.dupvar
-rw-rw-r-- 1 dftortosa dftortosa 2155413 Dec 20 21:40 check_duplicates.hh
-rw-rw-r-- 1 dftortosa dftortosa    1389 Dec 20 21:40 check_duplicates.log
-rw-rw-r-- 1 dftortosa dftortosa    1260 Dec 20 21:40 check_duplicates.nosex

Warning: 52716 het. haploid genotypes present (see
./check_no_duplicates/check_duplicates.hh ); many commands treat these as
missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


## Do we have zero duplicated positions after filtering? ##
TRUE


## load the bim file after removing duplicates ##
         0                                1  2      3  4  5
0        0                      10:86912383  0      0  0  I
1        0                      1:145030589  0      0  T  G
2        0  22:24301858_CNV_GSTT2B_Ilmndup1  0      0  0  0
3        0                  GSA-10:47138541  0      0  T  C
4        0                  GSA-10:47146867  0      0  A  G
...     ..                              ... ..    ... .. ..
650486  26                      rs142662828  0  16456  A  G
650487  26                       chrM_16465  0  16465  T  C
650488  26                        200610-37  0  16482  G  A
650489  26                        rs3937033  0  16519  T  C
650490  26                      rs386829316  0  16527  T  C

[650491 rows x 6 columns]

## check that the IDs in the original bim file after excluding pandas dups are the same than the remaining IDs in the new bim file obtained with plink ##
True

## check that we do not have any NA in the SNP IDs in the cleaned bim file ##
We do NOT have NA in SNP IDs, so good to go!

###### filter SNPs by chromosome type ######

## create folder to do operations ##
total 8
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 00_snp_duplicates
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 01_chromosome_filtering


## see the unique chromosome names in the SNP map ##

# select the name of the zip file with batch data based on the batch name because ILGSA24-17873 is called CAGRF20093767.zip, not ILGSA24-17873.zip #

# ILGSA24-17873: starting #
zip name is: CAGRF20093767

# ILGSA24-17873: load zip info from the zip file #

# ILGSA24-17873: extract the zipinfo of the SNP_map #
<ZipInfo filename='SNP_Map.txt' compress_type=deflate external_attr=0x20 file_size=36706614 compress_size=10781991>

# ILGSA24-17873: extract the SNP map #

# ILGSA24-17873: add batch name to the SNP map file #
total 35848
-rw-rw-r-- 1 dftortosa dftortosa 36706614 Dec 20 21:40 ILGSA24-17873_SNP_Map.txt


# ILGSA24-17303: starting #
zip name is: ILGSA24-17303

# ILGSA24-17303: load zip info from the zip file #

# ILGSA24-17303: extract the zipinfo of the SNP_map #
<ZipInfo filename='SNP_Map.txt' compress_type=deflate filemode='-rw-rw-r--' file_size=36706614 compress_size=10663453>

# ILGSA24-17303: extract the SNP map #

# ILGSA24-17303: add batch name to the SNP map file #
total 71696
-rw-rw-r-- 1 dftortosa dftortosa 36706614 Dec 20 21:40 ILGSA24-17303_SNP_Map.txt
-rw-rw-r-- 1 dftortosa dftortosa 36706614 Dec 20 21:40 ILGSA24-17873_SNP_Map.txt


# check both SNP maps identical #
Index	Name	Chromosome	Position	GenTrain Score	SNP	ILMN Strand	Customer Strand	NormID
1	1:103380393	1	102914837	0.7987	[T/C]	BOT	TOP	28
2	1:109439680	1	108897058	0.8792	[A/G]	TOP	TOP	1
3	1:110198788	1	109656166	0.8780	[T/C]	BOT	BOT	4
4	1:110201112	1	109658490	0.8584	[G/C]	BOT	TOP	101
5	1:110201667	1	109659045	0.7815	[T/C]	BOT	BOT	1
6	1:110202904	1	109660282	0.8816	[A/G]	TOP	BOT	1
7	1:110203240	1	109660618	0.7256	[A/C]	TOP	BOT	3
8	1:110203911	1	109661289	0.6915	[T/C]	BOT	BOT	1
9	1:110206675	1	109664053	0.8811	[T/C]	BOT	TOP	1
Index	Name	Chromosome	Position	GenTrain Score	SNP	ILMN Strand	Customer Strand	NormID
1	1:103380393	1	102914837	0.7987	[T/C]	BOT	TOP	28
2	1:109439680	1	108897058	0.8792	[A/G]	TOP	TOP	1
3	1:110198788	1	109656166	0.8780	[T/C]	BOT	BOT	4
4	1:110201112	1	109658490	0.8584	[G/C]	BOT	TOP	101
5	1:110201667	1	109659045	0.7815	[T/C]	BOT	BOT	1
6	1:110202904	1	109660282	0.8816	[A/G]	TOP	BOT	1
7	1:110203240	1	109660618	0.7256	[A/C]	TOP	BOT	3
8	1:110203911	1	109661289	0.6915	[T/C]	BOT	BOT	1
9	1:110206675	1	109664053	0.8811	[T/C]	BOT	TOP	1
TRUE


# remove the map of one batch are retain just one to do heck as they are identical #
total 35848
-rw-rw-r-- 1 dftortosa dftortosa 36706614 Dec 20 21:40 SNP_Map.txt


# extract the unique chromosome names using awk #
1
0
10
11
12
13
14
15
16
17
18
19
6
2
20
MT
Y
21
22
5
7
4
3
8
9
X
XY


# split the string generated with the awk unique chromsome names using '
', but avoid the last element which is the last empty line, then order using natural sorting #
['0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '11', '12', '13', '14', '15', '16', '17', '18', '19', '20', '21', '22', 'MT', 'X', 'XY', 'Y']

# create a list with the expected chromosome names, i.e., unknown (0), 22 autosomals, mito, sex and pseudo-autosomal #

# check we have the expect unique chromosome names #
True

# check again we have the expect unique chromosome names using pandas this time #
True

## we will use an empty list to save the IDs of the SNPs with strange chromosomes, then use plink to exclude ##
[]

## explore chromosome 0 ##

# check we have 0 chromosome in the SNP_map #
True

# check 0 in plink is 0 in illumina snp_map #
True

# count SNPs for which we have 0 chromosome #
We have 11 SNPs with chromosome zero
we have less than 50 variants with chromosome zero, no problem! add them to the list to SNPs to be excluded
['10:86912383', '1:145030589', '22:24301858_CNV_GSTT2B_Ilmndup1', 'GSA-10:47138541', 'GSA-10:47146867', 'GSA-1:144865278', 'GSA-1:148552472', 'GSA-rs3010970', 'Variant15773', 'rs1057517198', 'rs2301953']

## explore SNPs with XY ##

# check we have XY chromosome in the SNP_map #
True

# check 25 in plink is XY in illumina snp_map #
True

# count SNPs for which we have XY chromosome, i.e., pseudo-autosomal #
We have 859 SNPs pseudo-autosomal regions
we have less than 1000 variants in pseudo-autosomal regions, no problem!

## explore SNPs in MT ##

# check we have MT chromosome in the SNP_map #
True

# check 26 in plink is MT in illumina snp_map #
True

# count SNPs for which we have MT chromosome #
We have 1010 SNPs in mito genome
we have less than 1500 variants in mito genome, no problem!

## explore SNPs in X ##

# check we have X chromosome in the SNP_map #
True

# check 23 in plink is X in illumina snp_map #
True

# count SNPs in X #
We have 26781 SNPs in X
we have more than 20000 variants in X, no problem!

## explore SNPs in Y ##

# check we have Y chromosome in the SNP_map #
True

# check 24 in plink is Y in illumina snp_map #
True

# count SNPs in Y #
We have 3843 SNPs in Y
variants in Y are more than 3K and less than 10K, no problem!

## remove selected SNPs ##

# save to a file the list of SNPs to be excluded, each SNP in anew line #
10:86912383
1:145030589
22:24301858_CNV_GSTT2B_Ilmndup1
GSA-10:47138541
GSA-10:47146867
GSA-1:144865278
GSA-1:148552472
GSA-rs3010970
Variant15773
rs1057517198
rs2301953


# exclude these SNPs using --exclude of plink #
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./01_chromosome_filtering/merged_batches_filtered_chromosomes.log.
Options in effect:
  --bfile ./00_snp_duplicates/merged_batches_no_snp_duplicates
  --exclude ./01_chromosome_filtering/snps_to_exclude.txt
  --make-bed
  --out ./01_chromosome_filtering/merged_batches_filtered_chromosomes

63997 MB RAM detected; reserving 31998 MB for main workspace.
650491 variants loaded from .bim file.
1458 people (1222 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./01_chromosome_filtering/merged_batches_filtered_chromosomes.nosex .
--exclude: 650480 variants remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1458 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.993693.
650480 variants and 1458 people pass filters and QC.
Note: No phenotypes present.
--make-bed to ./01_chromosome_filtering/merged_batches_filtered_chromosomes.bed
+ ./01_chromosome_filtering/merged_batches_filtered_chromosomes.bim +
./01_chromosome_filtering/merged_batches_filtered_chromosomes.fam ... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
total 289228
-rw-rw-r-- 1 dftortosa dftortosa  36706614 Dec 20 21:40 SNP_Map.txt
-rw-rw-r-- 1 dftortosa dftortosa 237425203 Dec 20 21:40 merged_batches_filtered_chromosomes.bed
-rw-rw-r-- 1 dftortosa dftortosa  19803078 Dec 20 21:40 merged_batches_filtered_chromosomes.bim
-rw-rw-r-- 1 dftortosa dftortosa     56862 Dec 20 21:40 merged_batches_filtered_chromosomes.fam
-rw-rw-r-- 1 dftortosa dftortosa   2155413 Dec 20 21:40 merged_batches_filtered_chromosomes.hh
-rw-rw-r-- 1 dftortosa dftortosa      1657 Dec 20 21:40 merged_batches_filtered_chromosomes.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_filtered_chromosomes.nosex
-rw-rw-r-- 1 dftortosa dftortosa       170 Dec 20 21:40 snps_to_exclude.txt

Warning: 52716 het. haploid genotypes present (see
./01_chromosome_filtering/merged_batches_filtered_chromosomes.hh ); many
commands treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


# check that the excluded SNPs are actually out of the new bim file #
True

# check that the number of snps removed from the bim file is the same than the number of snps in the exclusion list #
True

# check that snps present in the first bim file but not in the new one are exactly those of the exclusion list #
True

# check all the unwanted chromosomes are removed #
True
True

# see the remaining chromosomes #
[ 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24
 25 26]

# check again we do not have duplicated snp ids #
True

###### GeneCall and GeneTrain scores ######

## We are not going to use GeneCall and GeneTrain scores. See script for further details ##

###### check no genetic position in map and select only snps ######

## check no genetic position in the map, it should be 0 always ##
[ True]

## check no SNP has empty ID ##
True
True

## select only SNPs ##

# see unique alleles: we have insertions and deletions (indels) along with 0, which means all samples are major homozigous and no minor allele is present #
['0' 'C' 'A' 'T' 'G' 'D' 'I']
['C' 'T' 'G' 'A' 'I' 'D' '0']

# make new dir #
total 12
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 00_snp_duplicates
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 01_chromosome_filtering
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 02_remove_non_snps


# remove non-SNPs #
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./02_remove_non_snps/merged_batches_remove_non_snps.log.
Options in effect:
  --bfile ./01_chromosome_filtering/merged_batches_filtered_chromosomes
  --make-bed
  --out ./02_remove_non_snps/merged_batches_remove_non_snps
  --snps-only just-acgt

63997 MB RAM detected; reserving 31998 MB for main workspace.
640897 out of 650480 variants loaded from .bim file.
1458 people (1222 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./02_remove_non_snps/merged_batches_remove_non_snps.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1458 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.993625.
640897 variants and 1458 people pass filters and QC.
Note: No phenotypes present.
--make-bed to ./02_remove_non_snps/merged_batches_remove_non_snps.bed +
./02_remove_non_snps/merged_batches_remove_non_snps.bim +
./02_remove_non_snps/merged_batches_remove_non_snps.fam ... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
total 249676
-rw-rw-r-- 1 dftortosa dftortosa 233927408 Dec 20 21:40 merged_batches_remove_non_snps.bed
-rw-rw-r-- 1 dftortosa dftortosa  19518309 Dec 20 21:40 merged_batches_remove_non_snps.bim
-rw-rw-r-- 1 dftortosa dftortosa     56862 Dec 20 21:40 merged_batches_remove_non_snps.fam
-rw-rw-r-- 1 dftortosa dftortosa   2146623 Dec 20 21:40 merged_batches_remove_non_snps.hh
-rw-rw-r-- 1 dftortosa dftortosa      1548 Dec 20 21:40 merged_batches_remove_non_snps.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_remove_non_snps.nosex

Warning: 52506 het. haploid genotypes present (see
./02_remove_non_snps/merged_batches_remove_non_snps.hh ); many commands treat
these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


# check no indels are present and we only have ACTG + 0 #
[True, True, True, True, True]
[True, True, True, True, True]
We have lost 9583 rows after removing INDELS

###### remove again duplicates but this time only considering position ######

## see duplicates by position ##
         0              1  2         3  4  5
303      1    rs387907306  0   2228866  A  G
304      1  rs387907306.1  0   2228866  T  G
2955     1     1:11855218  0  11795161  0  A
2956     1    rs121434297  0  11795161  0  T
4007     1     rs497078.1  0  15440540  A  C
...     ..            ... ..       ... .. ..
640605  26    rs368688251  0     12822  G  A
640662  26      200610-69  0     13626  T  C
640663  26    rs376146541  0     13626  A  G
640780  26     exm2216468  0     15257  A  G
640781  26    rs376262718  0     15257  T  C

[2447 rows x 6 columns]

## make new dir ##
total 16
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 00_snp_duplicates
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 01_chromosome_filtering
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 02_remove_non_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 03_remove_pos_dups


## select those SNPs with the same position ##
['rs387907306.1', 'rs121434297', 'rs497078.2', 'rs587782604.1', 'rs1131691052.2', 'rs387906795.1', 'rs818202', 'rs763494292', 'rs35019869', 'rs2640464', 'rs148412181.1', 'rs137852700.1', 'rs137852700.2', 'rs121918057.1', 'rs587782228.1', 'rs34126013', 'rs121918241.1', 'rs267606962.1', 'rs515726176.2', 'rs56053398.1', 'rs56053398.2', 'rs770273135.1', 'rs2297669.2', 'rs61750562.2', 'rs61749455.1', 'rs748639205.2', 'rs200687447.1', 'rs3918290.1', 'rs3918290.2', 'rs777425216.2', 'rs11555177.2', 'rs4646412', 'rs121434596.1', 'rs121913237.1', 'rs17852419.2', 'rs3748742.2', 'rs3748742.3', 'rs387906613.1', 'rs80356771.1', 'rs80356771.2', 'rs76763715.2', 'rs57966821.2', 'rs139875047.2', 'rs57629361.1', 'rs80338938', 'rs2814778', 'rs121913589.1', 'rs770546306.1', 'rs72549325.1', 'rs72549331.1', 'rs121918207.1', 'rs755796920.1', 'rs189678019.1', 'rs145489194.1', 'rs62635659.1', 'rs80338782.1', 'rs80338778.1', 'rs45525839.1', 'rs397516457.1', 'rs387907033.1', 'rs4149230.2', 'rs367543076.1', 'rs748659198.1', 'rs794728708.1', 'rs794728746.1', 'rs794728756.1', 'rs794728780.1', 'rs121913123.1', 'rs75086406.1', 'rs202166344.1', 'rs121908153.1', 'rs1876482', 'rs387907085.1', 'rs771015234.2', 'rs1799812', 'rs146377316.2', 'rs1801700', 'rs80356585.1', 'rs56175199.2', 'rs148542782.2', 'rs55989760.1', 'rs55771538.2', 'rs397517154.1', 'rs397517150.1', 'rs6756629.1', 'rs11887534.1', 'rs774857058.1', 'rs774857058.2', 'rs63751444.1', 'rs267607689.1', 'rs1114167845.2', 'rs12476364.1', 'rs587779067', 'rs587779067.1', 'rs267607940.1', 'rs151244108.2', 'rs267607949.1', 'rs267607948.1', 'rs267607957.2', 'rs63751207.1', 'rs63751656.1', 'rs267607969.1', 'rs1114167816.2', 'rs63750280.2', 'rs876659961_MNV', 'rs267608001.1', 'rs63751155.1', 'rs267608019.1', 'rs267608017.1', 'rs1114167818.2', 'rs1114167734.2', 'rs750528093.1', 'rs864622435', 'rs587781462.2', 'rs587779923.2', '2:47801001.2', '2:47803418.2', 'rs182024561.2', 'rs63750949.2', 'rs121908960.1', 'rs772624348.1', 'rs4149521', 'rs893793', 'rs549522925.1', 'rs34555492', 'rs794727444.1', 'rs779614747.1', 'rs199727342.1', 'rs764037830.1', 'rs796053014.1', 'rs794726789.1', 'rs542420576.1', 'rs775214722.1', 'rs794726718.1', 'rs767045134.1', 'rs794726742.1', 'rs763400390.1', 'rs794726713.1', 'rs781746113.1', 'rs794726827.1', 'rs794726827.2', 'rs760361423.1', 'rs764444350.1', 'rs80356477.1', 'rs4148770', 'rs35881803', 'rs34442536', 'rs771511344.1', 'rs112240298.1', 'rs756715989.1', 'rs72646850', 'rs769392594.1', 'rs559590585.1', 'rs751502842.1', 'rs746669146.1', 'rs72648987', 'rs763722868.1', 'rs121909398.1', 'rs587779518.2', 'rs587779464.1', 'rs397509370.1', 'rs587779691', 'rs121912914.1', 'rs886038925_mnv', 'rs111505097.2', 'rs80358239.1', 'rs137852752.1', 'rs2043449', 'rs757205958.1', 'rs201716417.1', 'rs201716417.2', 'rs121912595.1', 'rs952718', 'rs72551322.1', 'rs72551322.2', 'rs121908118.1', 'rs397516698.1', 'rs59962885.1', 'rs2234675', 'rs563607795.1', 'rs16828074.1', 'rs28969682.2', 'rs1817154', 'rs28948390.2', 'rs13426130.2', 'rs41264157.2', 'rs35350960.2', 'rs3771341.2', 'rs28946890.2', 'rs2302538', 'rs28934877.1', 'rs28900406.2', 'rs34993780.2', 'rs34116584.2', 'rs34116584.3', 'rs180177227.1', 'rs180177227.2', 'rs121908529.2', 'rs121908527.1', 'rs121908527.2', 'rs17034687.1', '3:10142109.2', 'rs5030829.2', 'rs5030810.1', 'rs5030833.2', 'rs397516826.1', 'rs1344870', 'rs199660234.1', 'rs730880224.1', 'rs63751012.2', 'rs63751012.3', 'rs63750206.1', 'rs267607725.2', 'rs63750266.2', 'rs63750781.1', 'rs267607742.1', 'rs63750866', 'rs193922370.1', 'rs267607755', 'rs267607759.1', 'rs63751711', 'rs267607778.1', 'rs267607784.1', '3:37014489.2', 'rs267607790.1', 'rs267607795.1', 'rs63751194.1', 'rs63750144.1', 'rs63751715.1', 'rs63751715.2', 'rs267607825.1', 'rs746536721.2', 'rs267607837.2', 'rs267607853.2', 'rs63751202.2', 'rs63749900.1', 'rs63751662.1', 'rs267607879.2', 'rs267607884.1', 'rs267607888.1', 'rs267607888.2', 'rs267607889.1', 'rs267607893.2', 'rs267607893.3', 'rs41315493.2', 'rs199473293.1', 'rs199473292.1', 'rs751787337.1', 'rs757843082.1', 'rs794728879.1', 'rs199473606.1', 'rs199473225.1', 'rs199473172.1', 'rs199473144.1', 'rs730880211_MNV', 'rs199473576.1', 'rs3918389.1', 'rs3918389.2', 'rs765669597.2', 'rs387907460.1', 'rs2290547.1', 'rs387907494.1', 'rs756998699.1', 'rs567032648.1', 'rs80338671.1', 'rs2623382', 'rs193922427_MNV', 'rs387907401.1', 'rs115532916.1', 'rs387907297.1', 'rs121908140.1', 'rs121908140.2', 'rs35942089', 'rs762988755.2', 'rs34749281', 'rs11552530.2', 'rs2233463', 'rs121908846.1', 'rs1355366', 'rs77722678.1', 'rs121908321.1', 'rs764719093.1', 'rs74452732.1', 'rs11947105.2', 'rs28672900', 'rs17146904.2', 'rs139309909', 'rs12233719.3', 'rs13123057.2', 'rs7697482.2', 'rs71599906.2', 'rs71599906.3', 'rs41297391.2', 'rs41299994', 'rs74821926.1', 'rs74821926.2', 'rs370520589.3', 'rs2231164', 'rs45605536', 'rs4148157', 'rs2622628', 'rs2231142', 'rs3109823', 'rs2231135', 'rs34592089.2', 'rs28580297.2', 'rs747904021.1', 'rs140948465.1', 'rs121912562.1', 'rs199469664.1', 'rs1554472', 'rs121964955.1', 'rs4742.2', 'rs146494374.1', 'rs870347', 'rs13172324.1', 'rs587783994.1', 'rs104893884.1', 'rs10515115.2', 'rs545185248.1', 'rs2369754', 'rs376213437.2', 'rs376213437.3', 'rs863225365.2', 'rs587779798', 'rs775126020.1', 'rs141582813.2', 'rs559510809.1', 'rs1060503340.1', 'rs1114167599.2', '5:112838797.2', '5:112839421_MNV', 'rs372535376.2', 'rs386134223.1', 'rs776395588.1', 'rs786203805.1', 'rs121909211.1', 'rs121909212.1', 'rs121909212.2', 'rs121908458.1', 'rs104893939.2', 'rs386833493.1', 'rs281864916.1', 'rs390299', 'rs1040045', 'rs597697', 'rs477199', 'rs796024', 'rs669331', 'rs612959', 'rs562777', 'rs112913018.1', 'rs2517922', 'chr6:29816371.1', 'rs1264319', 'rs2259571', 'NEU1:c.808C>T', 'rs28362675.1', 'rs1059615.2', 'rs1042136.1', 'rs121912949.1', 'rs770888294.1', 'rs2229633.1', 'rs121909075.1', 'rs387906837.1', 'rs137852949.1', 'rs137852949.2', 'rs17672049.2', 'rs45479896', 'rs398124581.1', 'rs398124581.2', 'rs387906593.1', 'rs749355583.1', 'rs447818', 'rs201995415.1', 'rs2273827', 'rs34447885.2', 'rs35546288.2', 'rs4646278.2', 'rs34888879.2', 'rs34295611.2', 'rs34059508.1', 'rs35270274.2', 'rs8177507.2', 'rs387907238.1', '7:5978595.2', 'rs778531080.1', 'rs1064794577.2', '7:5995533.2', 'rs763308607.1', 'rs587780059.1', 'rs587779333.1', 'rs935765', 'rs387906596.1', 'rs193921340.1', 'rs193921338.1', 'rs2230445.1', 'rs12537282.2', 'rs752916287.1', 'rs8187801.2', 'rs2230028.2', 'rs3747806', 'rs2229109.1', 'rs28381801', 'rs2230768.2', 'rs28371765', 'rs113667357.2', 'rs4986908.1', 'rs111033205.1', 'rs386833481.1', 'rs1800074.1', 'rs397508285.1', 'rs397508291.1', 'rs397508464.1', 'rs397508490.1', 'rs397508571.1', 'rs397508694.1', 'rs397508720.1', 'rs397508725.1', 'rs397508137.1', 'rs397508222.1', 'rs80055610.1', 'rs397508297.1', 'rs121908748.1', 'rs397508314.1', 'rs397508314.2', 'rs397508316.1', 'rs397508363.1', 'rs397508444.1', 'rs397508465.1', 'rs397508465.2', 'rs397508508.1', 'rs755416052.1', 'rs77902683.1', 'rs77902683.2', 'rs12531711.1', 'rs199422116.1', 'rs397507484.1', 'rs113488022.2', 'rs113488022.3', 'rs397507481.1', 'rs397516904.1', 'rs397507466.1', 'rs387906660.1', 'rs863223895.1', 'rs752550849.1', 'rs776595927.1', 'rs199473000.1', 'rs12720441.1', 'rs199473039.1', 'rs199473039.2', 'rs199473428.2', 'rs199472926.1', 'rs199472926.2', 'rs199473517.1', 'rs199472916.1', 'rs199472914.1', 'rs199472886.1', 'rs199473422.1', 'rs199473421.1', '7:150974856.2', 'rs754921704.1', 'rs754921704.2', 'rs199472839.1', 'rs199472828.1', 'rs104894064.2', 'rs146017816.1', 'rs4986991.2', 'rs55793712.2', 'rs55793712.3', 'rs56387565', 'rs56054745.2', 'HGSNAT:c.1150C>T', 'rs1051660.1', 'rs515726183.1', 'rs199599591.1', 'rs386833592.1', 'rs386833592.2', 'rs587778189.1', 'rs111033656.1', 'rs111033670.1', 'rs111033690.1', 'rs111033722.1', 'rs111033744.2', 'rs111033755.1', 'rs111033808.1', 'rs749047676.1', 'rs387906789.1', 'rs200479612.2', 'rs965897', 'rs864622293', 'rs28933692.1', 'rs137853022.2', 'rs1140064', 'rs754282058.1', 'rs1463729', 'rs3814134', 'rs727504173.1', 'rs773073663.1', 'rs751930594.1', 'rs772370177.1', 'rs118203717.2', 'rs118203447.2', 'rs759183842.1', 'rs118203353.2', 'rs764446683.1', 'rs13297509.1', 'rs386833778.1', 'rs386833778.2', 'rs3780962', 'rs560020203.1', 'rs79781594.1', 'rs79890926.2', 'rs143795581.2', 'rs377767439.2', 'rs55947360.1', 'rs201101792.1', 'rs377767429_mnv', 'rs78347871.1', 'rs200330818.2', 'rs111033260.1', 'rs111033260.2', 'rs376560330.2', 'rs199470473.1', 'rs17851642.2', 'rs140592056', 'rs786201995.1', 'rs786201995.2', 'rs398123317.1', 'rs786202733', 'rs1114167667.2', 'rs786201041.1', 'rs1114167624.2', 'rs1326830', 'rs3814637.1', 'rs17878459.2', 'rs770829708.2', 'rs55640102.2', 'rs564813580.2', 'rs762239445.2', 'rs56165452.2', 'rs28371686.1', 'rs121908386.1', 'rs17222744.2', 'rs4267009.2', 'rs4267009.3', 'rs56199535.1', 'rs56199535.2', 'rs56220353.2', 'rs3740071.2', 'rs3740070.2', 'rs3740070.3', 'rs8187692.1', 'CYP17A1:c.1243+5G>A', 'rs104894144.2', 'rs72559710.2', 'rs55897648.2', 'rs104894226.1', 'rs104894230.1', 'rs104894230.2', 'rs104894229.1', 'rs35705950.1', 'rs179489.1', 'rs199473398.2', 'rs120074178.1', 'rs199472712.1', 'rs120074179.1', 'rs199472722.1', 'rs199472722.2', 'rs199472755.1', 'rs12720459.1', 'rs199472763.3', 'rs199473471.1', 'rs145974930.1', 'rs199472815.1', 'rs33978907.1', 'rs33978907.2', 'rs33919821.2', 'rs33952266.2', 'rs33914668.2', 'rs33913413.1', 'rs33913413.2', 'rs33913413.3', 'rs33914944.1', 'rs33913712.2', 'rs33987903.1', 'rs33987903.2', 'rs11549407.2', 'rs11549407.3', 'rs33974936.1', 'rs33948615.1', 'rs33948615.2', 'rs33943001.2', 'rs35456885.2', 'rs35724775.2', 'rs33915217.2', 'rs33915217.3', 'rs33956879.1', 'rs33971440.2', 'rs33960103.1', 'rs33954632.1', 'rs33954632.2', 'rs35424040.2', 'rs35424040.3', 'rs33950507.1', 'rs33950507.3', 'rs33986703.2', 'rs33986703.3', 'rs33974228.2', 'rs334.2', 'rs334.3', 'rs33983205.1', 'rs33983205.2', 'rs33941849.2', 'rs33941849.3', 'rs33931746.2', 'rs33980857.1', 'rs33980857.2', 'rs33981098.2', 'rs33994806.1', 'rs33994806.3', 'rs33944208.1', 'rs33944208.2', 'rs33944208.3', 'rs120074117.1', 'rs120074117.2', 'rs35098198', 'rs56144125.1', 'rs12161765.2', 'rs74339576.1', 'rs28936370.2', 'rs151344623.1', 'rs151344623.2', 'rs570388861.1', 'rs2074317.2', 'rs2074317.3', 'rs1028564', 'rs387906883.1', 'rs397516020.1', 'rs121909377.2', 'rs397516002.2', 'rs112738974.1', 'rs397515912.1', 'rs193922386.2', 'rs121909254.1', 'rs201108965.1', 'rs11568623.2', 'rs119103258.1', 'rs119103258.2', 'rs1114167477.2', 'rs1114167471.2', 'rs1114167511_mnv', 'rs1063385.1', 'rs11553892.2', 'rs121909768.1', 'rs121909768.2', 'rs80338858.1', 'MYO7A:c.5581C>T', 'rs121908293.1', 'rs2229437.1', 'rs63159160.1', 'rs104894318.1', 'rs2456568.2', 'rs730881359.1', 'rs55861249.1', 'rs749036865.1', 'rs730881348.1', 'rs587781558.1', 'rs587781558.2', 'rs587776549_MNV', 'rs587779866', 'rs17174393.1', 'rs17174393.2', 'rs104894276.2', 'PTS:c.407A>T', 'rs675.1', 'rs397517076.1', 'rs730880056.1', 'rs104895223.1', 'rs104895223.2', 'rs780787386.1', 'rs973934', 'rs55901008.2', 'rs56387224.2', 'rs56199088.2', 'rs2291550', 'rs17851045.2', 'rs121913238.2', 'rs727503110.1', 'rs112445441.2', 'rs112445441.3', 'rs121913529.2', 'rs121913529.3', 'rs745595833.1', 'rs199583774', 'rs200586695', 'rs121918193.1', 'rs121918193.2', 'rs104894331.1', 'rs371712630.2', 'rs61630004', 'rs28933087.1', 'rs150511103.1', 'rs150511103.3', 'rs62638191.1', 'rs62638191.2', 'rs62638193.1', 'rs121917867.1', 'rs62516095.1', 'rs5030849.2', 'rs75193786.2', 'rs75193786.3', 'rs62508575.1', 'rs397516407.1', 'rs397516404.1', 'rs202080221.1', 'rs397507507.1', 'rs397507510.1', 'rs397507514.1', 'rs397507520.1', 'rs397507539.1', 'rs397507539.2', 'rs397507545.1', 'rs80338950.2', 'rs72474224.1', 'rs397508045.1', 'rs397507603.1', 'rs80358507.1', 'rs80358507.2', 'rs81002795.2', 'rs80358726.1', 'rs144848', 'rs397507634.1', 'rs80358579.1', '13:32338134.2', 'rs41293497.1', 'rs56253082.1', 'rs398122558.1', 'rs397507861_MNV', 'rs377698594.2', 'rs397507378.1', 'rs80359009.2', 'rs80359009.3', 'rs1060502459.2', 'rs886038177', 'rs80359018.1', 'rs80359027.1', 'rs81002874.1', 'rs41293513.1', 'rs41293513.2', 'rs730881615_mnv', 'rs80359077.1', 'rs397507404', 'rs80359105.1', 'rs45469092.1', 'rs276174916_mnv', 'rs80359165.1', 'rs886040820_MNV', 'rs886040952_mnv', 'rs80359195.1', 'rs80359195.2', '13:32398161.2', 'rs781641023.1', 'rs387906959.1', 'rs1131690843.2', '13:48362957.2', 'rs121913301', 'rs1131690884.2', 'rs1131690882.2', 'rs76151636.1', 'rs751078884.2', 'rs540935874.2', 'rs777629392.2', '13:51957608.2', 'rs137853284.2', 'rs137853280.2', 'rs104894386.1', 'rs6492764.2', 'rs4148536', 'rs2274407.1', 'rs2274407.2', 'rs4646212', 'rs6046.2', 'rs34116882', 'rs776631057.1', 'rs121908678.2', 'rs146582474.1', 'rs397516253.1', 'rs763538103.1', 'rs370328209.2', 'rs397516233.2', 'rs730880770.1', 'rs758891557.2', 'rs2856897.2', 'rs730880742.1', 'rs727504241.1', 'rs727504272.2', 'rs397516089.1', 'rs397516259.2', 'rs121918731.1', 'rs767983', 'rs387906597.1', 'rs28940314.1', 'rs138495705.1', 'rs7975.3', 'GALC:c.2002A>C', 'rs11623.1', 'rs763801533.1', 'rs121434548.2', 'rs147713329.1', '15:48415566.2', '15:48415572.2', '15:48415723.2', '15:48415758.2', '15:48420764.2', 'rs1085307921.2', '15:48425424.2', '15:48427566.2', 'rs371097218.2', '15:48428396.2', '15:48428460.2', 'rs794728252.2', 'rs794728251.1', '15:48441797.2', '15:48446705.2', '15:48446706.2', '15:48446823.2', '15:48452604.2', '15:48748833', '15:48463898.2', '15:48465789.2', '15:48468504.2', '15:48470745.2', 'rs112375043.2', '15:48474366.2', 'rs1064796522_mnv', 'rs1060501075', 'rs137854456.2', '15:48488419.2', 'rs112202622.1', '15:48492466.2', '15:48492575.2', '15:48492577.2', '15:48492578.2', 'rs794728322', '15:48497272.2', 'rs794728178', '15:48513626.2', '15:48515392.2', '15:48537721.2', '15:48600148.2', '15:48600175.2', 'rs112660651.1', '15:48613046.2', 'rs368764302.2', 'rs28757184', 'rs753780877.1', 'rs200549195.1', 'rs104894483.2', 'rs761628767.1', 'rs28941770.2', 'rs28941770.3', 'rs1823718', 'rs4986873', 'rs1049968.2', 'rs2075590', 'rs2075589', 'rs4986881.2', 'rs56240201.2', 'rs56313657.2', 'rs2069525.2', 'rs2069525.3', 'rs72547512.2', 'rs56107638.2', 'rs762972003.1', 'rs11557300.2', 'rs779007169.1', 'rs1114167465.2', 'rs45517126.1', 'rs45517148.2', 'rs45517148.3', 'rs45509697.2', 'rs45438400.3', 'rs45517206.1', 'rs45437797.1', 'rs45502196.2', 'rs45468292.2', 'rs397515319.2', 'rs45517263.2', 'rs45517268.1', 'rs45517270.2', 'rs397515087.2', 'rs45517289.2', 'rs137854065.1', 'rs45517346.2', '16:2085028.2', 'rs45517358.2', 'rs137854882.2', 'rs45517393.2', 'rs45517395.1', 'rs756181906.1', 'rs28940579.1', 'rs28940579.2', 'rs28940580.1', 'rs28940580.2', 'rs63751325.1', 'rs60791294.1', 'rs63750427.1', 'rs67561842.1', 'rs9930886.1', 'rs753153576.1', 'rs587776417.1', 'rs45494092', 'rs9923231.2', 'rs34667348.1', 'rs6500304.2', 'rs2066845.1', 'rs138043021.2', 'rs368492235.2', 'rs1131341.1', 'rs34278797', 'rs1805007.1', 'rs12948217.2', 'rs121909516.1', 'rs794727773.1', 'rs11575996.2', 'rs587781525.1', 'rs763098116.1', 'rs1057520006.2', 'rs1057520006.3', 'rs1057519988.2', 'rs1057519990', 'rs121912651', 'rs1057520008.1', 'rs28934874.1', 'rs1131691036_mnv', 'rs1057519975.2', 'rs1057519975.3', '17:7675992.2', 'rs786201057.1', 'rs1060501195.2', 'rs769078093.1', 'rs2108978', 'rs786203390.1', 'rs369798171.3', 'rs782460555.1', 'rs104894598.1', 'rs104894598.2', 'rs104894598.3', 'rs2593595', 'rs80356482.1', 'rs80356482.2', 'rs80356487.1', 'rs80356942', 'rs80357069', 'rs878853286_mnv', 'rs80357074.2', 'rs80357442.1', 'rs397507244.2', 'rs80357222.1', 'rs80187739.2', 'rs80358086.1', 'rs80356988.1', 'rs886040240_MNV', 'rs80357389.1', 'rs41293455.1', 'rs397507219.2', 'rs886038025', 'rs799917.3', 'rs886040010_MNV', 'rs4986850.2', 'rs80357118.1', 'rs80357371.1', 'rs397508903.1', 'rs886040899_mnv', 'rs80357244.2', 'rs80357180.2', 'rs886037972', 'rs886040032_mnv', 'rs80357064.1', 'rs80357446.1', 'rs80356880.1', 'rs80358018', 'rs397509332.2', 'rs61732578.1', 'rs61732578.2', 'rs63750959.1', 'rs1003355.2', 'rs756368560.1', 'rs587780875.1', 'rs80338792.2', 'rs121908330.1', 'rs2587507', 'rs28940868.2', 'rs104894637.1', 'rs17555442', 'rs569629', 'rs777286835.1', 'rs985492', 'rs34315917', 'rs112675807.2', 'rs730881969.1', 'rs730881970.1', 'rs121913315.1', 'rs121913322.2', 'rs121913322.3', 'rs864622488', 'rs767399782.1', 'rs944580031.2', 'rs879254411_mnv', 'rs879254498.2', 'rs879254541', 'rs1131692196.2', 'rs879254628_MNV', 'rs879254652.2', 'rs879254668.2', 'rs730882089.2', '19:11110698.2', 'rs544453230.1', 'rs879254758_mnv', 'rs879254771.2', 'rs879254774.2', 'rs368708058.2', 'rs879254887_MNV', 'rs879254907.2', 'rs879254985', 'rs730882109.1', '19:11116910.2', 'rs879255025.2', 'rs879255054.2', 'rs121434373.2', 'rs121434371.2', 'rs3810364', 'rs121918592.2', 'rs193922764.2', 'rs118192162.1', 'rs193922772.1', 'rs919322708.2', 'rs369466056.2', 'rs118192177.1', 'rs28933396.1', 'rs118192178.1', 'rs6413474', '19:41352808_CNV_CYP2A6', 'rs28399442.2', 'rs35303484.1', 'rs45459594.2', 'rs12721646.1', 'rs12721646.2', 'rs80356537.1', 'rs104894680.1', 'rs11569679', 'rs11569680.2', 'rs11569680.3', 'rs121434561', 'rs727503504.1', 'rs397516354.1', 'rs74315418.1', 'rs143383', 'rs2232583.2', 'rs149718395.1', 'rs149718395.2', 'rs11554273.1', 'rs11554273.2', 'rs6090151.2', 'rs759584387.1', 'rs797044938.1', 'rs796052625.1', 'rs771298943.1', 'rs770095972.1', 'rs121964964.1', 'rs121964964.2', 'rs121434254.1', 'rs4818.2', 'rs730881687.1', 'rs780872661.2', '22:29658265.2', 'rs199935023.1', 'rs121434533', 'rs121434529', '22:42477725_CYP2D6', 'rs28371736.2', 'rs28371736.2_CYP2D6', 'rs75467367', 'rs1135838_CYP2D6', 'rs1135832.3', 'rs28371732', 'rs28371729_CYP2D6', 'rs77312092.2', 'rs267608295.2_CYP2D6', 'rs148250267', 'rs79738337_CYP2D6', 'rs5030865.2', 'rs199849357_CYP2D6', 'rs267608289_CYP2D6', 'rs76187628', 'rs267608309', 'rs35046171_CYP2D6', 'rs1080983', '22:42536294-GA_CYP2D6', 'kgp7804958_CYP2D6', 'kgp15077039_CYP2D6', 'JHU_22.42539231_CYP2D6', 'rs797044454.1', 'rs74315478.1', 'rs74315478.2', 'rs80338819.2', 'rs2228431', 'Variant67151', 'rs2407834', 'rs2317327', 'rs61753174.2', 'rs61753164.1', 'rs61752158.2', 'rs1801161.2', 'rs104894934.2', 'rs104894928.2', 'rs137853259', 'rs922257', 'rs144970500.2', 'rs1921917', 'rs1444718', 'rs28940302.2', 'rs398123834.1', 'rs398123834.2', 'rs398124094.1', 'rs1800279', 'rs1800278', 'rs398124036', 'rs398124008.2', 'rs142814364', 'rs1801187', 'rs398123921.2', 'rs398123918.2', 'rs398123908.1', 'rs201366610.1', 'rs398123876.2', 'rs398123872.2', 'variant.107892', 'rs398123852.2', 'rs2194610', 'Variant67198', 'rs62640592.2', 'rs66550389.2', 'rs66550389.3', 'rs68026851', 'rs67367843.1', 'rs104894867', 'rs104894874', 'rs757027813.1', 'rs104894800', 'rs3027471', 'rs137852304', 'rs200220547.2', 'rs727504814.1', 'rs397516675.1', 'X:70329158', 'rs80338758', 'Variant67306', 'rs1340989', 'rs122445112', 'rs3827440', 'rs600977', 'rs143963614', 'exm-rs525869', 'rs2782723', 'rs149059579', 'rs756414485.1', 'rs104894770', 'rs398123224.1', 'rs398123224.2', 'rs869312427.2', 'rs869312402.2', 'rs869312399.2', 'rs397515874.2', 'newrs138886989', 'rs5945037.2', 'kgp30954619', 'rs72554660.2', 'rs80338676', 'var_X_107938639', 'rs587783568.2', 'rs587783563.1', 'rs398122394', 'rs2497538', 'exm1654177', 'rs2843594', 'rs3761555', 'rs502434', 'rs2356746', 'rs240170', 'rs864538', 'rs146235294.2', 'rs147038228.2', 'rs602930', 'rs1575093', 'rs104894863', 'exm-rs530501', 'rs113993953.1', 'rs567517', 'rs587783796.1', 'rs398123113.1', 'rs398123113.2', 'Variant67440', 'rs61751443.1', 'rs61749746.2', 'rs61749739.1', 'rs61749739.2', 'rs61748381', 'rs61748408.1', 'rs61755763.2', 'rs61754457.2', 'rs11549300.2', 'rs72554664', 'rs72554665.1', 'rs72554665.2', 'rs137852317', 'rs2230037', 'rs137852321', 'rs137852329', 'rs137852328.2', 'rs5030868', 'rs137852331', 'rs137852314', 'rs1050829', 'rs1050828', 'rs137852315', 'rs28933668.2', 'rs2058276', 'rs377553396', 'rs768983', 'rs534624521.2', 'rs3853052', 'rs3853054', 'exm-rs1236440', 'Y:15591446-C-G', 'rs373831864.2', 'rs574492814.2', 'Y:19105726-A-C', 'Y:19538933-T-C', 'rs9786805', 'rs3848982', 'rs371933901', 'rs3905', 'Y:21765763-A-G', 'rs871626', 'rs1276035', 'rs1276034', 'rs1276032', 'w23000898302', 'rs3924295', 'rs312259', 'rs2376574', 'rs28527344.2', 'exm2216260', 'exm2216261', 'rs369195256', 'rs374227446', 'rs386420007', 'rs371360308', 'exm2216303', 'rs386420010', 'rs28461189.2', 'rs374549428', 'rs373105186', 'rs376130276', 'rs367951226', 'rs367621332', 'rs368709860', 'rs386419997', 'rs372532331', 'rs373240586', 'rs3088053', 'rs368688251', 'rs376146541', 'rs376262718']

## check the number of SNPs with this problem ##
We have 1276 snps with duplicated position

## save as txt ##
rs387907306.1
rs121434297
rs497078.2
rs587782604.1
rs1131691052.2
rs387906795.1
rs818202
rs763494292
rs35019869
rs2640464


## check we have the correct number of SNPs in the list ##
TRUE


## remove these SNPs ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./03_remove_pos_dups/merged_batches_remove_dup_pos.log.
Options in effect:
  --bfile ./02_remove_non_snps/merged_batches_remove_non_snps
  --exclude ./03_remove_pos_dups/snps_pos_dup.txt
  --make-bed
  --out ./03_remove_pos_dups/merged_batches_remove_dup_pos

63997 MB RAM detected; reserving 31998 MB for main workspace.
640897 variants loaded from .bim file.
1458 people (1222 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./03_remove_pos_dups/merged_batches_remove_dup_pos.nosex .
--exclude: 639621 variants remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1458 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.993621.
639621 variants and 1458 people pass filters and QC.
Note: No phenotypes present.
--make-bed to ./03_remove_pos_dups/merged_batches_remove_dup_pos.bed +
./03_remove_pos_dups/merged_batches_remove_dup_pos.bim +
./03_remove_pos_dups/merged_batches_remove_dup_pos.fam ... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
total 249192
-rw-rw-r-- 1 dftortosa dftortosa 233461668 Dec 20 21:40 merged_batches_remove_dup_pos.bed
-rw-rw-r-- 1 dftortosa dftortosa  19478970 Dec 20 21:40 merged_batches_remove_dup_pos.bim
-rw-rw-r-- 1 dftortosa dftortosa     56862 Dec 20 21:40 merged_batches_remove_dup_pos.fam
-rw-rw-r-- 1 dftortosa dftortosa   2139848 Dec 20 21:40 merged_batches_remove_dup_pos.hh
-rw-rw-r-- 1 dftortosa dftortosa      1582 Dec 20 21:40 merged_batches_remove_dup_pos.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_remove_dup_pos.nosex
-rw-rw-r-- 1 dftortosa dftortosa     16779 Dec 20 21:40 snps_pos_dup.txt

Warning: 52344 het. haploid genotypes present (see
./03_remove_pos_dups/merged_batches_remove_dup_pos.hh ); many commands treat
these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


## check for pos dups after filtering ##

# load the bim file after filtering #
         0                1  2       3  4  5
0        1        rs9651229  0  632287  0  C
1        1        rs9701872  0  632828  C  T
2        1       rs11497407  0  633147  A  G
3        1  GSA-rs116587930  0  792461  A  G
4        1        rs3131972  0  817341  T  C
...     ..              ... ..     ... .. ..
639616  26      rs142662828  0   16456  A  G
639617  26       chrM_16465  0   16465  T  C
639618  26        200610-37  0   16482  G  A
639619  26        rs3937033  0   16519  T  C
639620  26      rs386829316  0   16527  T  C

[639621 rows x 6 columns]

# check for position duplicates #
True

## check also for duplicates in ID ##
True

###### MAF filtering ######
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./04_remove_low_maf_snps/merged_batches_remove_low_maf.log.
Options in effect:
  --bfile ./03_remove_pos_dups/merged_batches_remove_dup_pos
  --maf 0.05
  --make-bed
  --out ./04_remove_low_maf_snps/merged_batches_remove_low_maf

63997 MB RAM detected; reserving 31998 MB for main workspace.
639621 variants loaded from .bim file.
1458 people (1222 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./04_remove_low_maf_snps/merged_batches_remove_low_maf.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1458 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.993621.
339759 variants removed due to minor allele threshold(s)
(--maf/--max-maf/--mac/--max-mac).
299862 variants and 1458 people pass filters and QC.
Note: No phenotypes present.
--make-bed to ./04_remove_low_maf_snps/merged_batches_remove_low_maf.bed +
./04_remove_low_maf_snps/merged_batches_remove_low_maf.bim +
./04_remove_low_maf_snps/merged_batches_remove_low_maf.fam ... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
total 117532
-rw-rw-r-- 1 dftortosa dftortosa 109449633 Dec 20 21:40 merged_batches_remove_low_maf.bed
-rw-rw-r-- 1 dftortosa dftortosa   8689605 Dec 20 21:40 merged_batches_remove_low_maf.bim
-rw-rw-r-- 1 dftortosa dftortosa     56862 Dec 20 21:40 merged_batches_remove_low_maf.fam
-rw-rw-r-- 1 dftortosa dftortosa   2139848 Dec 20 21:40 merged_batches_remove_low_maf.hh
-rw-rw-r-- 1 dftortosa dftortosa      1622 Dec 20 21:40 merged_batches_remove_low_maf.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_remove_low_maf.nosex

Warning: 52344 het. haploid genotypes present (see
./04_remove_low_maf_snps/merged_batches_remove_low_maf.hh ); many commands
treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


## see the number of SNPs removed ##
The number of SNPs lost due to MAF below 0.05 is: 339759

## create freq report ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to plink.log.
Options in effect:
  --bfile merged_batches_remove_low_maf
  --freq

63997 MB RAM detected; reserving 31998 MB for main workspace.
299862 variants loaded from .bim file.
1458 people (1222 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to plink.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1458 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.989276.
--freq: Allele frequencies (founders only) written to plink.frq .
 CHR                                             SNP   A1   A2          MAF  NCHROBS
   1                                 GSA-rs116587930    A    G      0.05781     2906
   1                                       rs3131972    T    C       0.1842     2910
   1                                      rs12127425    A    G      0.08809     2906
   1                                       rs4970383    T    G       0.2557     2882
   1                                       rs4970382    G    A       0.4069     2912
   1                                   GSA-rs4475691    T    C       0.2023     2902
   1                                       rs7537756    G    A       0.2101     2908
   1                                      rs13302982    A    G      0.06048     2910
   1                                       rs2880024    A    G       0.4242     2902

Warning: 43439 het. haploid genotypes present (see plink.hh ); many commands
treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


## check that no SNP has a MAF below the selected threshold ##
TRUE


###### filter by SNP missingness ######

## create missing report per SNP and sample ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to plink.log.
Options in effect:
  --bfile merged_batches_remove_low_maf
  --missing

63997 MB RAM detected; reserving 31998 MB for main workspace.
299862 variants loaded from .bim file.
1458 people (1222 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to plink.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1458 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.989276.
--missing: Sample missing data report written to plink.imiss, and variant-based
missing data report written to plink.lmiss.
total 167744
-rw-rw-r-- 1 dftortosa dftortosa 109449633 Dec 20 21:40 merged_batches_remove_low_maf.bed
-rw-rw-r-- 1 dftortosa dftortosa   8689605 Dec 20 21:40 merged_batches_remove_low_maf.bim
-rw-rw-r-- 1 dftortosa dftortosa     56862 Dec 20 21:40 merged_batches_remove_low_maf.fam
-rw-rw-r-- 1 dftortosa dftortosa   2139848 Dec 20 21:40 merged_batches_remove_low_maf.hh
-rw-rw-r-- 1 dftortosa dftortosa      1622 Dec 20 21:40 merged_batches_remove_low_maf.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_remove_low_maf.nosex
-rw-r--r-- 1 dftortosa dftortosa  25488355 Dec 20 21:40 plink.frq
-rw-rw-r-- 1 dftortosa dftortosa   1766533 Dec 20 21:40 plink.hh
-rw-r--r-- 1 dftortosa dftortosa    105048 Dec 20 21:40 plink.imiss
-rw-r--r-- 1 dftortosa dftortosa  24041587 Dec 20 21:40 plink.lmiss
-rw-rw-r-- 1 dftortosa dftortosa      1194 Dec 20 21:40 plink.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 plink.nosex

Warning: 43439 het. haploid genotypes present (see plink.hh ); many commands
treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


## See the first lines of the lmiss file ##
 CHR                                             SNP   N_MISS   N_GENO   F_MISS
   1                                 GSA-rs116587930        5     1458 0.003429
   1                                       rs3131972        3     1458 0.002058
   1                                      rs12127425        5     1458 0.003429
   1                                       rs4970383       17     1458  0.01166
   1                                       rs4970382        2     1458 0.001372
   1                                   GSA-rs4475691        7     1458 0.004801
   1                                       rs7537756        4     1458 0.002743
   1                                      rs13302982        3     1458 0.002058
   1                                       rs2880024        7     1458 0.004801


## remove SNPs with low call rate to avoid their influence when filtering samples ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./05_remove_missing_snps/merged_batches_remove_missing_snps.log.
Options in effect:
  --bfile ./04_remove_low_maf_snps/merged_batches_remove_low_maf
  --geno 0.01
  --make-bed
  --out ./05_remove_missing_snps/merged_batches_remove_missing_snps

63997 MB RAM detected; reserving 31998 MB for main workspace.
299862 variants loaded from .bim file.
1458 people (1222 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./05_remove_missing_snps/merged_batches_remove_missing_snps.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1458 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.989276.
9018 variants removed due to missing genotype data (--geno).
290844 variants and 1458 people pass filters and QC.
Note: No phenotypes present.
--make-bed to ./05_remove_missing_snps/merged_batches_remove_missing_snps.bed +
./05_remove_missing_snps/merged_batches_remove_missing_snps.bim +
./05_remove_missing_snps/merged_batches_remove_missing_snps.fam ... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
total 113664
-rw-rw-r-- 1 dftortosa dftortosa 106158063 Dec 20 21:40 merged_batches_remove_missing_snps.bed
-rw-rw-r-- 1 dftortosa dftortosa   8393080 Dec 20 21:40 merged_batches_remove_missing_snps.bim
-rw-rw-r-- 1 dftortosa dftortosa     56862 Dec 20 21:40 merged_batches_remove_missing_snps.fam
-rw-rw-r-- 1 dftortosa dftortosa   1766533 Dec 20 21:40 merged_batches_remove_missing_snps.hh
-rw-rw-r-- 1 dftortosa dftortosa      1626 Dec 20 21:40 merged_batches_remove_missing_snps.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_remove_missing_snps.nosex

Warning: 43439 het. haploid genotypes present (see
./05_remove_missing_snps/merged_batches_remove_missing_snps.hh ); many commands
treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


## see the number of SNPs removed ##
The number of SNPs lost due to call rate below 0.99 is: 9018

## create again the missing report ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to plink.log.
Options in effect:
  --bfile merged_batches_remove_missing_snps
  --missing

63997 MB RAM detected; reserving 31998 MB for main workspace.
290844 variants loaded from .bim file.
1458 people (1222 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to plink.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1458 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.997943.
--missing: Sample missing data report written to plink.imiss, and variant-based
missing data report written to plink.lmiss.
total 133396
-rw-rw-r-- 1 dftortosa dftortosa 106158063 Dec 20 21:40 merged_batches_remove_missing_snps.bed
-rw-rw-r-- 1 dftortosa dftortosa   8393080 Dec 20 21:40 merged_batches_remove_missing_snps.bim
-rw-rw-r-- 1 dftortosa dftortosa     56862 Dec 20 21:40 merged_batches_remove_missing_snps.fam
-rw-rw-r-- 1 dftortosa dftortosa   1766533 Dec 20 21:40 merged_batches_remove_missing_snps.hh
-rw-rw-r-- 1 dftortosa dftortosa      1626 Dec 20 21:40 merged_batches_remove_missing_snps.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_remove_missing_snps.nosex
-rw-rw-r-- 1 dftortosa dftortosa   1712032 Dec 20 21:40 plink.hh
-rw-r--r-- 1 dftortosa dftortosa    106238 Dec 20 21:40 plink.imiss
-rw-r--r-- 1 dftortosa dftortosa  18375782 Dec 20 21:40 plink.lmiss
-rw-rw-r-- 1 dftortosa dftortosa      1199 Dec 20 21:40 plink.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 plink.nosex

Warning: 42110 het. haploid genotypes present (see plink.hh ); many commands
treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


## check that no SNP has a missing % above the selected threshold ##
TRUE


###### Initial HWE filter ######

## create folder for this step ##
total 28
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 00_snp_duplicates
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 01_chromosome_filtering
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 02_remove_non_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 03_remove_pos_dups
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 04_remove_low_maf_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 05_remove_missing_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 06_first_hwe_filter


## apply HWE filter ##
PLINK v2.00a4.2LM 64-bit Intel (31 May 2023)   www.cog-genomics.org/plink/2.0/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./06_first_hwe_filter/merged_batches_hwe_filtered.log.
Options in effect:
  --bfile ./05_remove_missing_snps/merged_batches_remove_missing_snps
  --hwe 1e-25 keep-fewhet midp
  --make-bed
  --out ./06_first_hwe_filter/merged_batches_hwe_filtered

Start time: Fri Dec 20 21:40:07 2024
63997 MiB RAM detected, ~56488 available; reserving 31998 MiB for main
workspace.
Using up to 32 threads (change this with --threads).
1458 samples (194 females, 1222 males, 42 ambiguous; 1458 founders) loaded from
./05_remove_missing_snps/merged_batches_remove_missing_snps.fam.
290844 variants loaded from
./05_remove_missing_snps/merged_batches_remove_missing_snps.bim.
Note: No phenotype data present.
Calculating allele frequencies... 0%22%45%67%90%done.
Computing chrX Hardy-Weinberg midp-values... 0%0%1%1%2%2%3%3%4%4%5%5%6%6%7%7%8%8%9%9%10%10%11%11%12%12%13%13%14%14%15%15%16%16%17%17%18%18%19%19%20%20%21%21%22%22%23%23%24%25%25%26%26%27%27%28%28%29%29%30%30%31%31%32%32%33%33%34%34%35%35%36%36%37%37%38%38%39%39%40%40%41%41%42%42%43%43%44%44%45%45%46%46%47%47%48%48%49%50%50%51%51%52%52%53%53%54%54%55%55%56%56%57%57%58%58%59%59%60%60%61%61%62%62%63%63%64%64%65%65%66%66%67%67%68%68%69%69%70%70%71%71%72%72%73%73%74%75%75%76%76%77%77%78%78%79%79%80%80%81%81%82%82%83%83%84%84%85%85%86%86%87%87%88%88%89%89%90%90%91%91%92%92%93%93%94%94%95%95%96%96%97%97%98%98%99%done.
--hwe midp keep-fewhet: 21 variants removed due to Hardy-Weinberg exact test
(founders only).
290823 variants remaining after main filters.
Writing ./06_first_hwe_filter/merged_batches_hwe_filtered.fam ... done.
Writing ./06_first_hwe_filter/merged_batches_hwe_filtered.bim ... done.
Writing ./06_first_hwe_filter/merged_batches_hwe_filtered.bed ... 0%22%45%67%90%done.
End time: Fri Dec 20 21:40:07 2024


## Less than 22 SNPs have been removed by the initial HWE filter ##
TRUE


###### remove SNPs that are considered to be pseudoautosomals but in reality are not in pseudo-autosomal regions of XY ######

## create folder for this step ##
total 32
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 00_snp_duplicates
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 01_chromosome_filtering
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 02_remove_non_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 03_remove_pos_dups
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 04_remove_low_maf_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 05_remove_missing_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 06_first_hwe_filter
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 07_par_problem_cleanup


## see SNPs that are considered to be pseudoautosomals (chr=25) but in reality are not in pseudo-autosomal regions of XY ##


## check we ONLY have 21 of these problematic cases ##
TRUE


## create a list WITHOUT SNPs that are problematic for PAR: We discard SNPs that are considered to be pseudoautosomals but in reality are not in pseudo-autosomal regions of XY ##


## retain only these SNPs without the problem ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./07_par_problem_cleanup/merged_batches_hwe_par.log.
Options in effect:
  --bfile ./06_first_hwe_filter/merged_batches_hwe_filtered
  --extract ./07_par_problem_cleanup/snps_par_no_problem.txt
  --make-bed
  --out ./07_par_problem_cleanup/merged_batches_hwe_par

63997 MB RAM detected; reserving 31998 MB for main workspace.
290823 variants loaded from .bim file.
1458 people (1222 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./07_par_problem_cleanup/merged_batches_hwe_par.nosex .
--extract: 290802 variants remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1458 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.997943.
290802 variants and 1458 people pass filters and QC.
Note: No phenotypes present.
--make-bed to ./07_par_problem_cleanup/merged_batches_hwe_par.bed +
./07_par_problem_cleanup/merged_batches_hwe_par.bim +
./07_par_problem_cleanup/merged_batches_hwe_par.fam ... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
total 32
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 00_snp_duplicates
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 01_chromosome_filtering
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 02_remove_non_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 03_remove_pos_dups
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 04_remove_low_maf_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 05_remove_missing_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 06_first_hwe_filter
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 07_par_problem_cleanup

Warning: 42110 het. haploid genotypes present (see
./07_par_problem_cleanup/merged_batches_hwe_par.hh ); many commands treat these
as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


## quick check ##
TRUE


###### filter by sample missingness ######

## create folder for this step ##
total 36
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 00_snp_duplicates
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 01_chromosome_filtering
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 02_remove_non_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 03_remove_pos_dups
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 04_remove_low_maf_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 05_remove_missing_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 06_first_hwe_filter
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 07_par_problem_cleanup
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 08_remove_low_call_samples


## make sample missing report after previous filters ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./08_remove_low_call_samples/merged_batches_hwe_par_miss_report.log.
Options in effect:
  --bfile ./07_par_problem_cleanup/merged_batches_hwe_par
  --missing
  --out ./08_remove_low_call_samples/merged_batches_hwe_par_miss_report

63997 MB RAM detected; reserving 31998 MB for main workspace.
290802 variants loaded from .bim file.
1458 people (1222 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./08_remove_low_call_samples/merged_batches_hwe_par_miss_report.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1458 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.997943.
--missing: Sample missing data report written to
./08_remove_low_call_samples/merged_batches_hwe_par_miss_report.imiss, and
variant-based missing data report written to
./08_remove_low_call_samples/merged_batches_hwe_par_miss_report.lmiss.

Warning: 42110 het. haploid genotypes present (see
./08_remove_low_call_samples/merged_batches_hwe_par_miss_report.hh ); many
commands treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.

                   FID        IID MISS_PHENO   N_MISS   N_GENO   F_MISS
  combat_ILGSA24-17303   0200ADMM          Y       73   290802 0.000251
  combat_ILGSA24-17303   0200ASJM          Y       86   290391 0.0002962
  combat_ILGSA24-17303   0200BHNM          Y      115   290391 0.000396
  combat_ILGSA24-17303   0200CBOM          Y      374   290802 0.001286
  combat_ILGSA24-17303   0200CDFM          Y       66   290391 0.0002273
  combat_ILGSA24-17303   0200CDJM          Y       61   290391 0.0002101
  combat_ILGSA24-17303   0200JCJM          Y      923   290802 0.003174
  combat_ILGSA24-17303   0200JCMM          Y       82   290802 0.000282
  combat_ILGSA24-17303   0200JEJM          Y       76   290802 0.0002613


## check that F_MISS is just the number of missing genotype divided by the number of potentially valid calls ##
TRUE


## load the report with awk and then save it controlling the delimiter. If I load it directly into pandas, I got problems separating the columns ##
FID	IID	MISS_PHENO	N_MISS	N_GENO	F_MISS
combat_ILGSA24-17303	0200ADMM	Y	73	290802	0.000251
combat_ILGSA24-17303	0200ASJM	Y	86	290391	0.0002962
combat_ILGSA24-17303	0200BHNM	Y	115	290391	0.000396
combat_ILGSA24-17303	0200CBOM	Y	374	290802	0.001286
combat_ILGSA24-17303	0200CDFM	Y	66	290391	0.0002273
combat_ILGSA24-17303	0200CDJM	Y	61	290391	0.0002101
combat_ILGSA24-17303	0200JCJM	Y	923	290802	0.003174
combat_ILGSA24-17303	0200JCMM	Y	82	290802	0.000282
combat_ILGSA24-17303	0200JEJM	Y	76	290802	0.0002613


## load in pandas ##
                       FID       IID MISS_PHENO  N_MISS  N_GENO    F_MISS
0     combat_ILGSA24-17303  0200ADMM          Y      73  290802  0.000251
1     combat_ILGSA24-17303  0200ASJM          Y      86  290391  0.000296
2     combat_ILGSA24-17303  0200BHNM          Y     115  290391  0.000396
3     combat_ILGSA24-17303  0200CBOM          Y     374  290802  0.001286
4     combat_ILGSA24-17303  0200CDFM          Y      66  290391  0.000227
...                    ...       ...        ...     ...     ...       ...
1453  combat_ILGSA24-17873  9693JMNM          Y      55  290802  0.000189
1454  combat_ILGSA24-17873  9696DWFM          Y      64  290802  0.000220
1455  combat_ILGSA24-17873  9697STJM          Y      80  290802  0.000275
1456  combat_ILGSA24-17873  9699DNOM          Y      59  290802  0.000203
1457  combat_ILGSA24-17873  9699ISMM          Y     109  290802  0.000375

[1458 rows x 6 columns]

## check we have the correct number of samples and columns in the missing sample report ##
True
True

## calculate the proportion of samples retained at different missing thresholds ##
see the thresholds selected
[0.98, 0.981, 0.982, 0.983, 0.984, 0.985, 0.986, 0.987, 0.988, 0.989, 0.99, 0.991, 0.992, 0.993, 0.994, 0.995, 0.996, 0.997, 0.998, 0.999]
see thresholds and proportion of retained samples
    threshold  proportion_remaining
0       0.980              0.993141
1       0.981              0.993141
2       0.982              0.993141
3       0.983              0.993141
4       0.984              0.993141
5       0.985              0.993141
6       0.986              0.993141
7       0.987              0.993141
8       0.988              0.993141
9       0.989              0.993141
10      0.990              0.993141
11      0.991              0.992455
12      0.992              0.992455
13      0.993              0.992455
14      0.994              0.991770
15      0.995              0.991084
16      0.996              0.989026
17      0.997              0.986968
18      0.998              0.980110
19      0.999              0.914266

## plot sample missing thresholds against the proportion of samples retained ##

## remove samples with low call rate ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./08_remove_low_call_samples/merged_batches_hwe_par_callrate.log.
Options in effect:
  --bfile ./07_par_problem_cleanup/merged_batches_hwe_par
  --make-bed
  --mind 0.01
  --out ./08_remove_low_call_samples/merged_batches_hwe_par_callrate

63997 MB RAM detected; reserving 31998 MB for main workspace.
290802 variants loaded from .bim file.
1458 people (1222 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./08_remove_low_call_samples/merged_batches_hwe_par_callrate.nosex .
10 people removed due to missing genotype data (--mind).
IDs written to
./08_remove_low_call_samples/merged_batches_hwe_par_callrate.irem .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1448 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate in remaining samples is 0.999522.
290802 variants and 1448 people pass filters and QC.
Note: No phenotypes present.
--make-bed to ./08_remove_low_call_samples/merged_batches_hwe_par_callrate.bed
+ ./08_remove_low_call_samples/merged_batches_hwe_par_callrate.bim +
./08_remove_low_call_samples/merged_batches_hwe_par_callrate.fam ... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.

Warning: 25115 het. haploid genotypes present (see
./08_remove_low_call_samples/merged_batches_hwe_par_callrate.hh ); many
commands treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


## see the number of samples removed ##
The number of samples lost due to call rate below 0.99 is: 10

## create again the missing report ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to merged_batches_hwe_par_callrate_missing.log.
Options in effect:
  --bfile merged_batches_hwe_par_callrate
  --missing
  --out merged_batches_hwe_par_callrate_missing

63997 MB RAM detected; reserving 31998 MB for main workspace.
290802 variants loaded from .bim file.
1448 people (1212 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to merged_batches_hwe_par_callrate_missing.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1448 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.999522.
--missing: Sample missing data report written to
merged_batches_hwe_par_callrate_missing.imiss, and variant-based missing data
report written to merged_batches_hwe_par_callrate_missing.lmiss.
total 148M
-rw-rw-r-- 1 dftortosa dftortosa 101M Dec 20 21:40 merged_batches_hwe_par_callrate.bed
-rw-rw-r-- 1 dftortosa dftortosa 8.1M Dec 20 21:40 merged_batches_hwe_par_callrate.bim
-rw-rw-r-- 1 dftortosa dftortosa  56K Dec 20 21:40 merged_batches_hwe_par_callrate.fam
-rw-rw-r-- 1 dftortosa dftortosa 995K Dec 20 21:40 merged_batches_hwe_par_callrate.hh
-rw-rw-r-- 1 dftortosa dftortosa  300 Dec 20 21:40 merged_batches_hwe_par_callrate.irem
-rw-rw-r-- 1 dftortosa dftortosa 1.7K Dec 20 21:40 merged_batches_hwe_par_callrate.log
-rw-rw-r-- 1 dftortosa dftortosa 1.3K Dec 20 21:40 merged_batches_hwe_par_callrate.nosex
-rw-rw-r-- 1 dftortosa dftortosa 995K Dec 20 21:40 merged_batches_hwe_par_callrate_missing.hh
-rw-r--r-- 1 dftortosa dftortosa 104K Dec 20 21:40 merged_batches_hwe_par_callrate_missing.imiss
-rw-r--r-- 1 dftortosa dftortosa  18M Dec 20 21:40 merged_batches_hwe_par_callrate_missing.lmiss
-rw-rw-r-- 1 dftortosa dftortosa 1.4K Dec 20 21:40 merged_batches_hwe_par_callrate_missing.log
-rw-rw-r-- 1 dftortosa dftortosa 1.3K Dec 20 21:40 merged_batches_hwe_par_callrate_missing.nosex
-rw-rw-r-- 1 dftortosa dftortosa 1.7M Dec 20 21:40 merged_batches_hwe_par_miss_report.hh
-rw-r--r-- 1 dftortosa dftortosa 104K Dec 20 21:40 merged_batches_hwe_par_miss_report.imiss
-rw-r--r-- 1 dftortosa dftortosa  18M Dec 20 21:40 merged_batches_hwe_par_miss_report.lmiss
-rw-rw-r-- 1 dftortosa dftortosa 1.5K Dec 20 21:40 merged_batches_hwe_par_miss_report.log
-rw-rw-r-- 1 dftortosa dftortosa 1.3K Dec 20 21:40 merged_batches_hwe_par_miss_report.nosex
-rw-rw-r-- 1 dftortosa dftortosa  75K Dec 20 21:40 merged_batches_hwe_par_miss_report_awk_processed.imiss
-rw-rw-r-- 1 dftortosa dftortosa  24K Dec 20 21:40 merged_batches_plot_sample_retention_thresholds.png

Warning: 25115 het. haploid genotypes present (see
merged_batches_hwe_par_callrate_missing.hh ); many commands treat these as
missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


## check that no sample has a missing % above the selected threshold ##
TRUE


###### remove samples with LogR SD above the illumina expectation ######

## obtain the samples above the expectation for logR dev in each batch ##

# ILGSA24-17873: process the file with the logR deviation #
CAGRF20093767_CNMetrics

## ILGSA24-17873: get the ID of samples above the illumina expectation for logR SD ##
1487CMJM
6297ANSJ
7400DZDO
7993KHJN
8502JGMJ
9601AVJM
9692NYOM
9198ACMM

['1487CMJM', '6297ANSJ', '7400DZDO', '7993KHJN', '8502JGMJ', '9601AVJM', '9692NYOM', '9198ACMM']

# ILGSA24-17303: process the file with the logR deviation #
ILGSA24-17303_CNMetrics

## ILGSA24-17303: get the ID of samples above the illumina expectation for logR SD ##
7699ZSSO
3400SMJJ
2498STAA

['7699ZSSO', '3400SMJJ', '2498STAA']

## combine the IDs from both batched into one single file ##
combat_ILGSA24-17303	7699ZSSO
combat_ILGSA24-17303	3400SMJJ
combat_ILGSA24-17303	2498STAA
combat_ILGSA24-17873	1487CMJM
combat_ILGSA24-17873	6297ANSJ
combat_ILGSA24-17873	7400DZDO
combat_ILGSA24-17873	7993KHJN
combat_ILGSA24-17873	8502JGMJ
combat_ILGSA24-17873	9601AVJM
combat_ILGSA24-17873	9692NYOM
combat_ILGSA24-17873	9198ACMM


## check we have the correct IDs in the merged file ##

# get IDs from the merged file #
7699ZSSO
3400SMJJ
2498STAA
1487CMJM
6297ANSJ
7400DZDO
7993KHJN
8502JGMJ
9601AVJM
9692NYOM
9198ACMM


# combine the list of ID samples from both batches and check it is identical than the merged list #
7699ZSSO
3400SMJJ
2498STAA

1487CMJM
6297ANSJ
7400DZDO
7993KHJN
8502JGMJ
9601AVJM
9692NYOM
9198ACMM

True

## remove these samples ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./09_remove_high_LogRDev_samples/merged_batches_hwe_par_callrate_LogRDev.log.
Options in effect:
  --bfile ./08_remove_low_call_samples/merged_batches_hwe_par_callrate
  --make-bed
  --out ./09_remove_high_LogRDev_samples/merged_batches_hwe_par_callrate_LogRDev
  --remove ../cn_metrics/merged_batches_samples_filter_out_LogRDev.tsv

63997 MB RAM detected; reserving 31998 MB for main workspace.
290802 variants loaded from .bim file.
1448 people (1212 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./09_remove_high_LogRDev_samples/merged_batches_hwe_par_callrate_LogRDev.nosex
.
--remove: 1446 people remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1446 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate in remaining samples is 0.999531.
290802 variants and 1446 people pass filters and QC.
Note: No phenotypes present.
--make-bed to
./09_remove_high_LogRDev_samples/merged_batches_hwe_par_callrate_LogRDev.bed +
./09_remove_high_LogRDev_samples/merged_batches_hwe_par_callrate_LogRDev.bim +
./09_remove_high_LogRDev_samples/merged_batches_hwe_par_callrate_LogRDev.fam
... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
total 112060
-rw-rw-r-- 1 dftortosa dftortosa 105270327 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev.bed
-rw-rw-r-- 1 dftortosa dftortosa   8391859 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev.bim
-rw-rw-r-- 1 dftortosa dftortosa     56394 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev.fam
-rw-rw-r-- 1 dftortosa dftortosa   1018062 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev.hh
-rw-rw-r-- 1 dftortosa dftortosa      1760 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev.nosex

Warning: 25107 het. haploid genotypes present (see
./09_remove_high_LogRDev_samples/merged_batches_hwe_par_callrate_LogRDev.hh );
many commands treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


## check that the corresponding samples are indeed not included in the new fam file ##
True

## see the number of samples removed ##
The number of samples lost due to logR SD above illumina expectations is: 2; Note that we previously filtered by missingness, so we already removed there some samples with logR dev problems

###### MAF filtering second round ######

## apply the filter ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./10_remove_low_maf_snps/merged_batches_hwe_par_callrate_LogRDev_maf.log.
Options in effect:
  --bfile ./09_remove_high_LogRDev_samples/merged_batches_hwe_par_callrate_LogRDev
  --maf 0.05
  --make-bed
  --out ./10_remove_low_maf_snps/merged_batches_hwe_par_callrate_LogRDev_maf

63997 MB RAM detected; reserving 31998 MB for main workspace.
290802 variants loaded from .bim file.
1446 people (1210 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./10_remove_low_maf_snps/merged_batches_hwe_par_callrate_LogRDev_maf.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1446 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.999531.
1654 variants removed due to minor allele threshold(s)
(--maf/--max-maf/--mac/--max-mac).
289148 variants and 1446 people pass filters and QC.
Note: No phenotypes present.
--make-bed to
./10_remove_low_maf_snps/merged_batches_hwe_par_callrate_LogRDev_maf.bed +
./10_remove_low_maf_snps/merged_batches_hwe_par_callrate_LogRDev_maf.bim +
./10_remove_low_maf_snps/merged_batches_hwe_par_callrate_LogRDev_maf.fam ...
0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
total 111428
-rw-rw-r-- 1 dftortosa dftortosa 104671579 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf.bed
-rw-rw-r-- 1 dftortosa dftortosa   8340840 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf.bim
-rw-rw-r-- 1 dftortosa dftortosa     56394 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf.fam
-rw-rw-r-- 1 dftortosa dftortosa   1018062 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf.hh
-rw-rw-r-- 1 dftortosa dftortosa      1726 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf.nosex

Warning: 25107 het. haploid genotypes present (see
./10_remove_low_maf_snps/merged_batches_hwe_par_callrate_LogRDev_maf.hh ); many
commands treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


## see the number of SNPs removed ##
The number of SNPs lost due to MAF below 0.05 is: 1654

## create freq report ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to plink.log.
Options in effect:
  --bfile merged_batches_hwe_par_callrate_LogRDev_maf
  --freq

63997 MB RAM detected; reserving 31998 MB for main workspace.
289148 variants loaded from .bim file.
1446 people (1210 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to plink.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1446 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.999531.
--freq: Allele frequencies (founders only) written to plink.frq .
 CHR                            SNP   A1   A2          MAF  NCHROBS
   1                GSA-rs116587930    A    G      0.05644     2888
   1                      rs3131972    T    C       0.1828     2888
   1                     rs12127425    A    G      0.08795     2888
   1                      rs4970382    G    A       0.4084     2892
   1                  GSA-rs4475691    T    C       0.2019     2892
   1                      rs7537756    G    A         0.21     2890
   1                     rs13302982    A    G      0.06051     2892
   1                      rs2880024    A    G       0.4234     2886
   1                      rs3748597    T    C       0.0536     2892

Warning: 25091 het. haploid genotypes present (see plink.hh ); many commands
treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


## check that no SNP has a MAF below the selected threshold ##
TRUE


###### sample relatedness ######

## create folder for this step ##
total 48
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 00_snp_duplicates
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 01_chromosome_filtering
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 02_remove_non_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 03_remove_pos_dups
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 04_remove_low_maf_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 05_remove_missing_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 06_first_hwe_filter
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 07_par_problem_cleanup
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 08_remove_low_call_samples
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 09_remove_high_LogRDev_samples
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 10_remove_low_maf_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 11_remove_related_samples


## calculate kinship coefficient ##

# LD-pruning #
PLINK v2.00a4.2LM 64-bit Intel (31 May 2023)   www.cog-genomics.org/plink/2.0/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./11_remove_related_samples/ldpruned_snplist.log.
Options in effect:
  --bfile ./10_remove_low_maf_snps/merged_batches_hwe_par_callrate_LogRDev_maf
  --indep-pairwise 500kb 1 0.2
  --out ./11_remove_related_samples/ldpruned_snplist

Start time: Fri Dec 20 21:40:09 2024
63997 MiB RAM detected, ~56363 available; reserving 31998 MiB for main
workspace.
Using up to 32 threads (change this with --threads).
1446 samples (194 females, 1210 males, 42 ambiguous; 1446 founders) loaded from
./10_remove_low_maf_snps/merged_batches_hwe_par_callrate_LogRDev_maf.fam.
289148 variants loaded from
./10_remove_low_maf_snps/merged_batches_hwe_par_callrate_LogRDev_maf.bim.
Note: No phenotype data present.
Calculating allele frequencies... 0%22%45%67%90%done.
--indep-pairwise (26 compute threads): 0%50%190270/289148 variants removed.
Writing...
Variant lists written to ./11_remove_related_samples/ldpruned_snplist.prune.in
and ./11_remove_related_samples/ldpruned_snplist.prune.out .
End time: Fri Dec 20 21:40:10 2024
total 3164
-rw-rw-r-- 1 dftortosa dftortosa    1227 Dec 20 21:40 ldpruned_snplist.log
-rw-rw-r-- 1 dftortosa dftortosa 1102610 Dec 20 21:40 ldpruned_snplist.prune.in
-rw-rw-r-- 1 dftortosa dftortosa 2126515 Dec 20 21:40 ldpruned_snplist.prune.out

Do we have at least 70K SNPs after LD pruning like in Ritchie's tutorial?
see first lines of the .prune.in list:
rs3131972
rs12127425
rs13302982
rs2880024
exm2264981
rs6669800
rs6605059
rs4970414
rs28591569
rs3121578
The number of included SNPs is 98878
Is this number greater than 70K?
TRUE

PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./11_remove_related_samples/merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.log.
Options in effect:
  --bfile ./10_remove_low_maf_snps/merged_batches_hwe_par_callrate_LogRDev_maf
  --extract ./11_remove_related_samples/ldpruned_snplist.prune.in
  --make-bed
  --out ./11_remove_related_samples/merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned

63997 MB RAM detected; reserving 31998 MB for main workspace.
289148 variants loaded from .bim file.
1446 people (1210 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./11_remove_related_samples/merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.nosex
.
--extract: 98878 variants remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1446 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.999555.
98878 variants and 1446 people pass filters and QC.
Note: No phenotypes present.
--make-bed to
./11_remove_related_samples/merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.bed
+
./11_remove_related_samples/merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.bim
+
./11_remove_related_samples/merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.fam
... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
total 41152
-rw-rw-r-- 1 dftortosa dftortosa     1227 Dec 20 21:40 ldpruned_snplist.log
-rw-rw-r-- 1 dftortosa dftortosa  1102610 Dec 20 21:40 ldpruned_snplist.prune.in
-rw-rw-r-- 1 dftortosa dftortosa  2126515 Dec 20 21:40 ldpruned_snplist.prune.out
-rw-rw-r-- 1 dftortosa dftortosa 35793839 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.bed
-rw-rw-r-- 1 dftortosa dftortosa  2849592 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.bim
-rw-rw-r-- 1 dftortosa dftortosa    56394 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.fam
-rw-rw-r-- 1 dftortosa dftortosa   185662 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.hh
-rw-rw-r-- 1 dftortosa dftortosa     1804 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.log
-rw-rw-r-- 1 dftortosa dftortosa     1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.nosex

Warning: 4545 het. haploid genotypes present (see
./11_remove_related_samples/merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.hh
); many commands treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


# remove sex chromsomes #
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.log.
Options in effect:
  --autosome
  --bfile ./merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned
  --make-bed
  --out ./merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals

63997 MB RAM detected; reserving 31998 MB for main workspace.
95241 out of 98878 variants loaded from .bim file.
1446 people (1210 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1446 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.999578.
95241 variants and 1446 people pass filters and QC.
Note: No phenotypes present.
--make-bed to
./merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.bed +
./merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.bim +
./merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.fam ...
0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
total 77568
-rw-rw-r-- 1 dftortosa dftortosa     1227 Dec 20 21:40 ldpruned_snplist.log
-rw-rw-r-- 1 dftortosa dftortosa  1102610 Dec 20 21:40 ldpruned_snplist.prune.in
-rw-rw-r-- 1 dftortosa dftortosa  2126515 Dec 20 21:40 ldpruned_snplist.prune.out
-rw-rw-r-- 1 dftortosa dftortosa 35793839 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.bed
-rw-rw-r-- 1 dftortosa dftortosa  2849592 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.bim
-rw-rw-r-- 1 dftortosa dftortosa    56394 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.fam
-rw-rw-r-- 1 dftortosa dftortosa   185662 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.hh
-rw-rw-r-- 1 dftortosa dftortosa     1804 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.log
-rw-rw-r-- 1 dftortosa dftortosa     1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.nosex
-rw-rw-r-- 1 dftortosa dftortosa 34477245 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.bed
-rw-rw-r-- 1 dftortosa dftortosa  2742773 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.bim
-rw-rw-r-- 1 dftortosa dftortosa    56394 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.fam
-rw-rw-r-- 1 dftortosa dftortosa     1388 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.log
-rw-rw-r-- 1 dftortosa dftortosa     1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.nosex

Do we have at least 70K autosomal SNPs after LD pruning like in Ritchie's tutorial?
The number of included autosomal SNPs in linkage equilibrium is 95241
Is this number greater than 70K?
TRUE

All non-autosomals SNPs have been removed from the LD pruned dataset?
TRUE


# calculate the kindship #
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./11_remove_related_samples/ibd_report.log.
Options in effect:
  --bfile ./11_remove_related_samples/merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals
  --genome
  --out ./11_remove_related_samples/ibd_report

63997 MB RAM detected; reserving 31998 MB for main workspace.
95241 variants loaded from .bim file.
1446 people (1210 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to ./11_remove_related_samples/ibd_report.nosex .
Using up to 31 threads (change this with --threads).
Before main variant filters, 1446 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.999578.
95241 variants and 1446 people pass filters and QC.
Note: No phenotypes present.

1152 markers complete.
2304 markers complete.
3456 markers complete.
4608 markers complete.
5760 markers complete.
6912 markers complete.
8064 markers complete.
9216 markers complete.
10368 markers complete.
11520 markers complete.
12672 markers complete.
13824 markers complete.
14976 markers complete.
16128 markers complete.
17280 markers complete.
18432 markers complete.
19584 markers complete.
20736 markers complete.
21888 markers complete.
23040 markers complete.
24192 markers complete.
25344 markers complete.
26496 markers complete.
27648 markers complete.
28800 markers complete.
29952 markers complete.
31104 markers complete.
32256 markers complete.
33408 markers complete.
34560 markers complete.
35712 markers complete.
36864 markers complete.
38016 markers complete.
39168 markers complete.
40320 markers complete.
41472 markers complete.
42624 markers complete.
43776 markers complete.
44928 markers complete.
46080 markers complete.
47232 markers complete.
48384 markers complete.
49536 markers complete.
50688 markers complete.
51840 markers complete.
52992 markers complete.
54144 markers complete.
55296 markers complete.
56448 markers complete.
57600 markers complete.
58752 markers complete.
59904 markers complete.
61056 markers complete.
62208 markers complete.
63360 markers complete.
64512 markers complete.
65664 markers complete.
66816 markers complete.
67968 markers complete.
69120 markers complete.
70272 markers complete.
71424 markers complete.
72576 markers complete.
73728 markers complete.
74880 markers complete.
76032 markers complete.
77184 markers complete.
78336 markers complete.
79488 markers complete.
80640 markers complete.
81792 markers complete.
82944 markers complete.
84096 markers complete.
85248 markers complete.
86400 markers complete.
87552 markers complete.
88704 markers complete.
89856 markers complete.
91008 markers complete.
92160 markers complete.
93312 markers complete.
94464 markers complete.
95241 markers complete.
IBD calculations complete.  

Writing... 1%
Writing... 2%
Writing... 3%
Writing... 4%
Writing... 5%
Writing... 6%
Writing... 7%
Writing... 8%
Writing... 9%
Writing... 10%
Writing... 11%
Writing... 12%
Writing... 13%
Writing... 14%
Writing... 15%
Writing... 16%
Writing... 17%
Writing... 18%
Writing... 19%
Writing... 20%
Writing... 21%
Writing... 22%
Writing... 23%
Writing... 24%
Writing... 25%
Writing... 26%
Writing... 27%
Writing... 28%
Writing... 29%
Writing... 30%
Writing... 31%
Writing... 32%
Writing... 33%
Writing... 34%
Writing... 35%
Writing... 36%
Writing... 37%
Writing... 38%
Writing... 39%
Writing... 40%
Writing... 41%
Writing... 42%
Writing... 43%
Writing... 44%
Writing... 45%
Writing... 46%
Writing... 47%
Writing... 48%
Writing... 49%
Writing... 50%
Writing... 51%
Writing... 52%
Writing... 53%
Writing... 54%
Writing... 55%
Writing... 56%
Writing... 57%
Writing... 58%
Writing... 59%
Writing... 60%
Writing... 61%
Writing... 62%
Writing... 63%
Writing... 64%
Writing... 65%
Writing... 66%
Writing... 67%
Writing... 68%
Writing... 69%
Writing... 70%
Writing... 71%
Writing... 72%
Writing... 73%
Writing... 74%
Writing... 75%
Writing... 76%
Writing... 77%
Writing... 78%
Writing... 79%
Writing... 80%
Writing... 81%
Writing... 82%
Writing... 83%
Writing... 84%
Writing... 85%
Writing... 86%
Writing... 87%
Writing... 88%
Writing... 89%
Writing... 90%
Writing... 91%
Writing... 92%
Writing... 93%
Writing... 94%
Writing... 95%
Writing... 96%
Writing... 97%
Writing... 98%
Writing... 99%
Finished writing ./11_remove_related_samples/ibd_report.genome .
total 216332
-rw-rw-r-- 1 dftortosa dftortosa 142084096 Dec 20 21:40 ibd_report.genome
-rw-rw-r-- 1 dftortosa dftortosa      1158 Dec 20 21:40 ibd_report.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 ibd_report.nosex
-rw-rw-r-- 1 dftortosa dftortosa      1227 Dec 20 21:40 ldpruned_snplist.log
-rw-rw-r-- 1 dftortosa dftortosa   1102610 Dec 20 21:40 ldpruned_snplist.prune.in
-rw-rw-r-- 1 dftortosa dftortosa   2126515 Dec 20 21:40 ldpruned_snplist.prune.out
-rw-rw-r-- 1 dftortosa dftortosa  35793839 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.bed
-rw-rw-r-- 1 dftortosa dftortosa   2849592 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.bim
-rw-rw-r-- 1 dftortosa dftortosa     56394 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.fam
-rw-rw-r-- 1 dftortosa dftortosa    185662 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.hh
-rw-rw-r-- 1 dftortosa dftortosa      1804 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.nosex
-rw-rw-r-- 1 dftortosa dftortosa  34477245 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.bed
-rw-rw-r-- 1 dftortosa dftortosa   2742773 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.bim
-rw-rw-r-- 1 dftortosa dftortosa     56394 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.fam
-rw-rw-r-- 1 dftortosa dftortosa      1388 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.nosex


# explore the kindship file looking for pairs with pi_hat > 0.2 #
See first lines of the IBD report
                  FID1      IID1                  FID2      IID2 RT    EZ      Z0      Z1      Z2  PI_HAT PHE       DST     PPC   RATIO
  combat_ILGSA24-17303  0200ADMM  combat_ILGSA24-17303  0200ASJM OT     0  0.9894  0.0000  0.0106  0.0106  -1  0.733958  0.6340  2.0236
  combat_ILGSA24-17303  0200ADMM  combat_ILGSA24-17303  0200BHNM OT     0  0.9776  0.0155  0.0069  0.0146  -1  0.735053  0.7441  2.0460
  combat_ILGSA24-17303  0200ADMM  combat_ILGSA24-17303  0200CBOM OT     0  0.9707  0.0253  0.0040  0.0167  -1  0.735272  0.1204  1.9212
  combat_ILGSA24-17303  0200ADMM  combat_ILGSA24-17303  0200CDFM OT     0  0.9756  0.0136  0.0108  0.0176  -1  0.735908  0.0685  1.9013
  combat_ILGSA24-17303  0200ADMM  combat_ILGSA24-17303  0200CDJM OT     0  0.9539  0.0461  0.0000  0.0230  -1  0.734355  0.5138  2.0024
  combat_ILGSA24-17303  0200ADMM  combat_ILGSA24-17303  0200JCJM OT     0  0.9749  0.0134  0.0117  0.0184  -1  0.736131  0.3741  1.9781
  combat_ILGSA24-17303  0200ADMM  combat_ILGSA24-17303  0200JCMM OT     0  1.0000  0.0000  0.0000  0.0000  -1  0.734411  0.0381  1.8830
  combat_ILGSA24-17303  0200ADMM  combat_ILGSA24-17303  0200JEJM OT     0  0.9820  0.0118  0.0062  0.0121  -1  0.734492  0.8075  2.0608
  combat_ILGSA24-17303  0200ADMM  combat_ILGSA24-17303  0200KHJM OT     0  0.9785  0.0140  0.0075  0.0145  -1  0.735076  0.6391  2.0247

 See now only those rows for which pi_hat > 0.2
  combat_ILGSA24-17303  7600TJNO  combat_ILGSA24-17303  7695SWJO OT     0  0.0000  0.0000  1.0000  1.0000  -1  1.000000  1.0000      NA
  combat_ILGSA24-17303  7789LMOO  combat_ILGSA24-17873  7796LMOO UN    NA  0.0000  0.0000  1.0000  1.0000  -1  1.000000  1.0000      NA
  combat_ILGSA24-17873  0197SNMM  combat_ILGSA24-17873  9187MFMM OT     0  0.0000  0.0000  1.0000  1.0000  -1  1.000000  1.0000      NA
  combat_ILGSA24-17873  0301DMMJ  combat_ILGSA24-17873  0399AMDJ OT     0  0.0000  0.0000  1.0000  1.0000  -1  0.999995  1.0000      NA
  combat_ILGSA24-17873  1499KMDM  combat_ILGSA24-17873  7201JDAS OT     0  0.4104  0.5843  0.0054  0.2975  -1  0.792120  1.0000  5.8252
  combat_ILGSA24-17873  2299MTMJ  combat_ILGSA24-17873  7496STFO OT     0  0.3204  0.4207  0.2589  0.4692  -1  0.843625  1.0000  8.3094
  combat_ILGSA24-17873  3301THMM  combat_ILGSA24-17873  8244JHMJ OT     0  0.2347  0.4979  0.2673  0.5163  -1  0.853703  1.0000 12.1045
  combat_ILGSA24-17873  3399MBAM  combat_ILGSA24-17873  9101JBJM OT     0  0.2546  0.5462  0.1992  0.4723  -1  0.840300  1.0000  9.6282
  combat_ILGSA24-17873  4596DAJA  combat_ILGSA24-17873  4598DAJA OT     0  0.0000  0.0000  1.0000  1.0000  -1  0.999995  1.0000      NA
  combat_ILGSA24-17873  6192DHJJ  combat_ILGSA24-17873  7592KHJO OT     0  0.0000  0.0000  1.0000  1.0000  -1  1.000000  1.0000      NA
  combat_ILGSA24-17873  6298TJMJ  combat_ILGSA24-17873  6797WFAS OT     0  0.0000  0.0000  1.0000  1.0000  -1  1.000000  1.0000      NA
  combat_ILGSA24-17873  6697EVFA  combat_ILGSA24-17873  7493BVNO OT     0  0.2527  0.5062  0.2411  0.4942  -1  0.847508  1.0000 10.6254
  combat_ILGSA24-17873  6697MMNA  combat_ILGSA24-17873  8697DMNJ OT     0  0.0000  0.0000  1.0000  1.0000  -1  1.000000  1.0000      NA
  combat_ILGSA24-17873  7196AMSS  combat_ILGSA24-17873  9196GCNM OT     0  0.0000  0.0000  1.0000  1.0000  -1  1.000000  1.0000      NA
  combat_ILGSA24-17873  7974SJNN  combat_ILGSA24-17873  8145ORJJ OT     0  0.0000  0.0000  1.0000  1.0000  -1  1.000000  1.0000      NA
  combat_ILGSA24-17873  8002DPAN  combat_ILGSA24-17873  8097JCJN OT     0  0.0000  0.0000  1.0000  1.0000  -1  1.000000  1.0000      NA
  combat_ILGSA24-17873  8244CDSJ  combat_ILGSA24-17873  8244DCDJ OT     0  0.0000  0.0000  1.0000  1.0000  -1  0.999995  1.0000      NA
  combat_ILGSA24-17873  8500AEAJ  combat_ILGSA24-17873  8699WPAJ OT     0  0.0000  0.0000  1.0000  1.0000  -1  1.000000  1.0000      NA
  combat_ILGSA24-17873  8500NHNJ  combat_ILGSA24-17873  8501CGDJ OT     0  0.0000  0.0000  1.0000  1.0000  -1  1.000000  1.0000      NA
  combat_ILGSA24-17873  9196RFJM  combat_ILGSA24-17873  9199ACMM OT     0  0.0000  0.0000  1.0000  1.0000  -1  1.000000  1.0000      NA


# convert delimiter of ibd report #
total 237100
-rw-rw-r-- 1 dftortosa dftortosa 142084096 Dec 20 21:40 ibd_report.genome
-rw-rw-r-- 1 dftortosa dftortosa      1158 Dec 20 21:40 ibd_report.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 ibd_report.nosex
-rw-rw-r-- 1 dftortosa dftortosa  21264041 Dec 20 21:40 ibd_report_awk_processed.genome.tsv.gz
-rw-rw-r-- 1 dftortosa dftortosa      1227 Dec 20 21:40 ldpruned_snplist.log
-rw-rw-r-- 1 dftortosa dftortosa   1102610 Dec 20 21:40 ldpruned_snplist.prune.in
-rw-rw-r-- 1 dftortosa dftortosa   2126515 Dec 20 21:40 ldpruned_snplist.prune.out
-rw-rw-r-- 1 dftortosa dftortosa  35793839 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.bed
-rw-rw-r-- 1 dftortosa dftortosa   2849592 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.bim
-rw-rw-r-- 1 dftortosa dftortosa     56394 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.fam
-rw-rw-r-- 1 dftortosa dftortosa    185662 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.hh
-rw-rw-r-- 1 dftortosa dftortosa      1804 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.nosex
-rw-rw-r-- 1 dftortosa dftortosa  34477245 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.bed
-rw-rw-r-- 1 dftortosa dftortosa   2742773 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.bim
-rw-rw-r-- 1 dftortosa dftortosa     56394 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.fam
-rw-rw-r-- 1 dftortosa dftortosa      1388 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.nosex


# load ibd report as pandas DF #
                         FID1      IID1  ...     PPC   RATIO
0        combat_ILGSA24-17303  0200ADMM  ...  0.6340  2.0236
1        combat_ILGSA24-17303  0200ADMM  ...  0.7441  2.0460
2        combat_ILGSA24-17303  0200ADMM  ...  0.1204  1.9212
3        combat_ILGSA24-17303  0200ADMM  ...  0.0685  1.9013
4        combat_ILGSA24-17303  0200ADMM  ...  0.5138  2.0024
...                       ...       ...  ...     ...     ...
1044730  combat_ILGSA24-17873  9696DWFM  ...  0.6683  2.0302
1044731  combat_ILGSA24-17873  9696DWFM  ...  0.5635  2.0110
1044732  combat_ILGSA24-17873  9697STJM  ...  0.7170  2.0401
1044733  combat_ILGSA24-17873  9697STJM  ...  0.8132  2.0622
1044734  combat_ILGSA24-17873  9699DNOM  ...  0.1417  1.9283

[1044735 rows x 14 columns]

# plot Z0 vs Z1 and Z2 #
check that the cases with Z0 and Z1 equal to 0 are those with Z2=1
TRUE

# plot histogram of pi_hat #

# We have multiple cases with PI_HAT around 0.2, 0.5 and 1, which are potential second, first-degree relatives and twins/duplicated samples, respectively #
                         FID1      IID1                  FID2      IID2  PI_HAT
210766   combat_ILGSA24-17303  7600TJNO  combat_ILGSA24-17303  7695SWJO  1.0000
266315   combat_ILGSA24-17303  7789LMOO  combat_ILGSA24-17873  7796LMOO  1.0000
310823   combat_ILGSA24-17873  0197SNMM  combat_ILGSA24-17873  9187MFMM  1.0000
342051   combat_ILGSA24-17873  0301DMMJ  combat_ILGSA24-17873  0399AMDJ  1.0000
478788   combat_ILGSA24-17873  1499KMDM  combat_ILGSA24-17873  7201JDAS  0.2975
541880   combat_ILGSA24-17873  2299MTMJ  combat_ILGSA24-17873  7496STFO  0.4692
606984   combat_ILGSA24-17873  3301THMM  combat_ILGSA24-17873  8244JHMJ  0.5163
621026   combat_ILGSA24-17873  3399MBAM  combat_ILGSA24-17873  9101JBJM  0.4723
760106   combat_ILGSA24-17873  4596DAJA  combat_ILGSA24-17873  4598DAJA  1.0000
818277   combat_ILGSA24-17873  6192DHJJ  combat_ILGSA24-17873  7592KHJO  1.0000
830675   combat_ILGSA24-17873  6298TJMJ  combat_ILGSA24-17873  6797WFAS  1.0000
893403   combat_ILGSA24-17873  6697EVFA  combat_ILGSA24-17873  7493BVNO  0.4942
894224   combat_ILGSA24-17873  6697MMNA  combat_ILGSA24-17873  8697DMNJ  1.0000
945904   combat_ILGSA24-17873  7196AMSS  combat_ILGSA24-17873  9196GCNM  1.0000
1012418  combat_ILGSA24-17873  7974SJNN  combat_ILGSA24-17873  8145ORJJ  1.0000
1018867  combat_ILGSA24-17873  8002DPAN  combat_ILGSA24-17873  8097JCJN  1.0000
1028445  combat_ILGSA24-17873  8244CDSJ  combat_ILGSA24-17873  8244DCDJ  1.0000
1031773  combat_ILGSA24-17873  8500AEAJ  combat_ILGSA24-17873  8699WPAJ  1.0000
1032648  combat_ILGSA24-17873  8500NHNJ  combat_ILGSA24-17873  8501CGDJ  1.0000
1043957  combat_ILGSA24-17873  9196RFJM  combat_ILGSA24-17873  9199ACMM  1.0000

# print unique related samples with pi_hat > 0.2 #
We have 40 samples with PI_HAT > 0.2
['7600TJNO' '7789LMOO' '0197SNMM' '0301DMMJ' '1499KMDM' '2299MTMJ'
 '3301THMM' '3399MBAM' '4596DAJA' '6192DHJJ' '6298TJMJ' '6697EVFA'
 '6697MMNA' '7196AMSS' '7974SJNN' '8002DPAN' '8244CDSJ' '8500AEAJ'
 '8500NHNJ' '9196RFJM' '7695SWJO' '7796LMOO' '9187MFMM' '0399AMDJ'
 '7201JDAS' '7496STFO' '8244JHMJ' '9101JBJM' '4598DAJA' '7592KHJO'
 '6797WFAS' '7493BVNO' '8697DMNJ' '9196GCNM' '8145ORJJ' '8097JCJN'
 '8244DCDJ' '8699WPAJ' '8501CGDJ' '9199ACMM']

## run KING-robust with plink2 ##

# make subfolder for KING #
total 237136
-rw-rw-r-- 1 dftortosa dftortosa 142084096 Dec 20 21:40 ibd_report.genome
-rw-rw-r-- 1 dftortosa dftortosa      1158 Dec 20 21:40 ibd_report.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 ibd_report.nosex
-rw-rw-r-- 1 dftortosa dftortosa  21264041 Dec 20 21:40 ibd_report_awk_processed.genome.tsv.gz
drwxrwxr-x 2 dftortosa dftortosa      4096 Dec 20 21:40 king_analyses
-rw-rw-r-- 1 dftortosa dftortosa      1227 Dec 20 21:40 ldpruned_snplist.log
-rw-rw-r-- 1 dftortosa dftortosa   1102610 Dec 20 21:40 ldpruned_snplist.prune.in
-rw-rw-r-- 1 dftortosa dftortosa   2126515 Dec 20 21:40 ldpruned_snplist.prune.out
-rw-rw-r-- 1 dftortosa dftortosa  35793839 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.bed
-rw-rw-r-- 1 dftortosa dftortosa   2849592 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.bim
-rw-rw-r-- 1 dftortosa dftortosa     56394 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.fam
-rw-rw-r-- 1 dftortosa dftortosa    185662 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.hh
-rw-rw-r-- 1 dftortosa dftortosa      1804 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.nosex
-rw-rw-r-- 1 dftortosa dftortosa  34477245 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.bed
-rw-rw-r-- 1 dftortosa dftortosa   2742773 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.bim
-rw-rw-r-- 1 dftortosa dftortosa     56394 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.fam
-rw-rw-r-- 1 dftortosa dftortosa      1388 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.nosex
-rw-rw-r-- 1 dftortosa dftortosa     16404 Dec 20 21:40 pairs_relatdness_before_filtering.png
-rw-rw-r-- 1 dftortosa dftortosa     10391 Dec 20 21:40 pi_hat_hist.png


# intro to KING #
The geometric mean of king-cutoffs for second and third-degree relatives (0.125 and 0.0625, respectively) is 0.08838834764831845. This could be used to filter second-degree relatives

# run --make-king-table to get a table with kindship coefficients #
PLINK v2.00a4.2LM 64-bit Intel (31 May 2023)   www.cog-genomics.org/plink/2.0/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./11_remove_related_samples/king_analyses/king_table.log.
Options in effect:
  --bfile ./10_remove_low_maf_snps/merged_batches_hwe_par_callrate_LogRDev_maf
  --king-table-filter 0.088
  --make-king-table
  --out ./11_remove_related_samples/king_analyses/king_table

Start time: Fri Dec 20 21:40:24 2024
63997 MiB RAM detected, ~56312 available; reserving 31998 MiB for main
workspace.
Using up to 32 threads (change this with --threads).
1446 samples (194 females, 1210 males, 42 ambiguous; 1446 founders) loaded from
./10_remove_low_maf_snps/merged_batches_hwe_par_callrate_LogRDev_maf.fam.
289148 variants loaded from
./10_remove_low_maf_snps/merged_batches_hwe_par_callrate_LogRDev_maf.bim.
Note: No phenotype data present.
Excluding 17847 variants on non-autosomes from KING-robust calculation.
--make-king-table pass 1/1: Scanning for rare variants... 0%24%48%72%96%done.
0 variants handled by initial scan (271301 remaining).

--make-king-table pass 1/1: 0 variants complete.
--make-king-table pass 1/1: 1536 variants complete.
--make-king-table pass 1/1: 3072 variants complete.
--make-king-table pass 1/1: 4608 variants complete.
--make-king-table pass 1/1: 6144 variants complete.
--make-king-table pass 1/1: 7680 variants complete.
--make-king-table pass 1/1: 9216 variants complete.
--make-king-table pass 1/1: 10752 variants complete.
--make-king-table pass 1/1: 12288 variants complete.
--make-king-table pass 1/1: 13824 variants complete.
--make-king-table pass 1/1: 15360 variants complete.
--make-king-table pass 1/1: 16896 variants complete.
--make-king-table pass 1/1: 18432 variants complete.
--make-king-table pass 1/1: 19968 variants complete.
--make-king-table pass 1/1: 21504 variants complete.
--make-king-table pass 1/1: 23040 variants complete.
--make-king-table pass 1/1: 24576 variants complete.
--make-king-table pass 1/1: 26112 variants complete.
--make-king-table pass 1/1: 27648 variants complete.
--make-king-table pass 1/1: 29184 variants complete.
--make-king-table pass 1/1: 30720 variants complete.
--make-king-table pass 1/1: 32256 variants complete.
--make-king-table pass 1/1: 33792 variants complete.
--make-king-table pass 1/1: 35328 variants complete.
--make-king-table pass 1/1: 36864 variants complete.
--make-king-table pass 1/1: 38400 variants complete.
--make-king-table pass 1/1: 39936 variants complete.
--make-king-table pass 1/1: 41472 variants complete.
--make-king-table pass 1/1: 43008 variants complete.
--make-king-table pass 1/1: 44544 variants complete.
--make-king-table pass 1/1: 46080 variants complete.
--make-king-table pass 1/1: 47616 variants complete.
--make-king-table pass 1/1: 49152 variants complete.
--make-king-table pass 1/1: 50688 variants complete.
--make-king-table pass 1/1: 52224 variants complete.
--make-king-table pass 1/1: 53760 variants complete.
--make-king-table pass 1/1: 55296 variants complete.
--make-king-table pass 1/1: 56832 variants complete.
--make-king-table pass 1/1: 58368 variants complete.
--make-king-table pass 1/1: 59904 variants complete.
--make-king-table pass 1/1: 61440 variants complete.
--make-king-table pass 1/1: 62976 variants complete.
--make-king-table pass 1/1: 64512 variants complete.
--make-king-table pass 1/1: 66048 variants complete.
--make-king-table pass 1/1: 67584 variants complete.
--make-king-table pass 1/1: 69120 variants complete.
--make-king-table pass 1/1: 70656 variants complete.
--make-king-table pass 1/1: 72192 variants complete.
--make-king-table pass 1/1: 73728 variants complete.
--make-king-table pass 1/1: 75264 variants complete.
--make-king-table pass 1/1: 76800 variants complete.
--make-king-table pass 1/1: 78336 variants complete.
--make-king-table pass 1/1: 79872 variants complete.
--make-king-table pass 1/1: 81408 variants complete.
--make-king-table pass 1/1: 82944 variants complete.
--make-king-table pass 1/1: 84480 variants complete.
--make-king-table pass 1/1: 86016 variants complete.
--make-king-table pass 1/1: 87552 variants complete.
--make-king-table pass 1/1: 89088 variants complete.
--make-king-table pass 1/1: 90624 variants complete.
--make-king-table pass 1/1: 92160 variants complete.
--make-king-table pass 1/1: 93696 variants complete.
--make-king-table pass 1/1: 95232 variants complete.
--make-king-table pass 1/1: 96768 variants complete.
--make-king-table pass 1/1: 98304 variants complete.
--make-king-table pass 1/1: 99840 variants complete.
--make-king-table pass 1/1: 101376 variants complete.
--make-king-table pass 1/1: 102912 variants complete.
--make-king-table pass 1/1: 104448 variants complete.
--make-king-table pass 1/1: 105984 variants complete.
--make-king-table pass 1/1: 107520 variants complete.
--make-king-table pass 1/1: 109056 variants complete.
--make-king-table pass 1/1: 110592 variants complete.
--make-king-table pass 1/1: 112128 variants complete.
--make-king-table pass 1/1: 113664 variants complete.
--make-king-table pass 1/1: 115200 variants complete.
--make-king-table pass 1/1: 116736 variants complete.
--make-king-table pass 1/1: 118272 variants complete.
--make-king-table pass 1/1: 119808 variants complete.
--make-king-table pass 1/1: 121344 variants complete.
--make-king-table pass 1/1: 122880 variants complete.
--make-king-table pass 1/1: 124416 variants complete.
--make-king-table pass 1/1: 125952 variants complete.
--make-king-table pass 1/1: 127488 variants complete.
--make-king-table pass 1/1: 129024 variants complete.
--make-king-table pass 1/1: 130560 variants complete.
--make-king-table pass 1/1: 132096 variants complete.
--make-king-table pass 1/1: 133632 variants complete.
--make-king-table pass 1/1: 135168 variants complete.
--make-king-table pass 1/1: 136704 variants complete.
--make-king-table pass 1/1: 138240 variants complete.
--make-king-table pass 1/1: 139776 variants complete.
--make-king-table pass 1/1: 141312 variants complete.
--make-king-table pass 1/1: 142848 variants complete.
--make-king-table pass 1/1: 144384 variants complete.
--make-king-table pass 1/1: 145920 variants complete.
--make-king-table pass 1/1: 147456 variants complete.
--make-king-table pass 1/1: 148992 variants complete.
--make-king-table pass 1/1: 150528 variants complete.
--make-king-table pass 1/1: 152064 variants complete.
--make-king-table pass 1/1: 153600 variants complete.
--make-king-table pass 1/1: 155136 variants complete.
--make-king-table pass 1/1: 156672 variants complete.
--make-king-table pass 1/1: 158208 variants complete.
--make-king-table pass 1/1: 159744 variants complete.
--make-king-table pass 1/1: 161280 variants complete.
--make-king-table pass 1/1: 162816 variants complete.
--make-king-table pass 1/1: 164352 variants complete.
--make-king-table pass 1/1: 165888 variants complete.
--make-king-table pass 1/1: 167424 variants complete.
--make-king-table pass 1/1: 168960 variants complete.
--make-king-table pass 1/1: 170496 variants complete.
--make-king-table pass 1/1: 172032 variants complete.
--make-king-table pass 1/1: 173568 variants complete.
--make-king-table pass 1/1: 175104 variants complete.
--make-king-table pass 1/1: 176640 variants complete.
--make-king-table pass 1/1: 178176 variants complete.
--make-king-table pass 1/1: 179712 variants complete.
--make-king-table pass 1/1: 181248 variants complete.
--make-king-table pass 1/1: 182784 variants complete.
--make-king-table pass 1/1: 184320 variants complete.
--make-king-table pass 1/1: 185856 variants complete.
--make-king-table pass 1/1: 187392 variants complete.
--make-king-table pass 1/1: 188928 variants complete.
--make-king-table pass 1/1: 190464 variants complete.
--make-king-table pass 1/1: 192000 variants complete.
--make-king-table pass 1/1: 193536 variants complete.
--make-king-table pass 1/1: 195072 variants complete.
--make-king-table pass 1/1: 196608 variants complete.
--make-king-table pass 1/1: 198144 variants complete.
--make-king-table pass 1/1: 199680 variants complete.
--make-king-table pass 1/1: 201216 variants complete.
--make-king-table pass 1/1: 202752 variants complete.
--make-king-table pass 1/1: 204288 variants complete.
--make-king-table pass 1/1: 205824 variants complete.
--make-king-table pass 1/1: 207360 variants complete.
--make-king-table pass 1/1: 208896 variants complete.
--make-king-table pass 1/1: 210432 variants complete.
--make-king-table pass 1/1: 211968 variants complete.
--make-king-table pass 1/1: 213504 variants complete.
--make-king-table pass 1/1: 215040 variants complete.
--make-king-table pass 1/1: 216576 variants complete.
--make-king-table pass 1/1: 218112 variants complete.
--make-king-table pass 1/1: 219648 variants complete.
--make-king-table pass 1/1: 221184 variants complete.
--make-king-table pass 1/1: 222720 variants complete.
--make-king-table pass 1/1: 224256 variants complete.
--make-king-table pass 1/1: 225792 variants complete.
--make-king-table pass 1/1: 227328 variants complete.
--make-king-table pass 1/1: 228864 variants complete.
--make-king-table pass 1/1: 230400 variants complete.
--make-king-table pass 1/1: 231936 variants complete.
--make-king-table pass 1/1: 233472 variants complete.
--make-king-table pass 1/1: 235008 variants complete.
--make-king-table pass 1/1: 236544 variants complete.
--make-king-table pass 1/1: 238080 variants complete.
--make-king-table pass 1/1: 239616 variants complete.
--make-king-table pass 1/1: 241152 variants complete.
--make-king-table pass 1/1: 242688 variants complete.
--make-king-table pass 1/1: 244224 variants complete.
--make-king-table pass 1/1: 245760 variants complete.
--make-king-table pass 1/1: 247296 variants complete.
--make-king-table pass 1/1: 248832 variants complete.
--make-king-table pass 1/1: 250368 variants complete.
--make-king-table pass 1/1: 251904 variants complete.
--make-king-table pass 1/1: 253440 variants complete.
--make-king-table pass 1/1: 254976 variants complete.
--make-king-table pass 1/1: 256512 variants complete.
--make-king-table pass 1/1: 258048 variants complete.
--make-king-table pass 1/1: 259584 variants complete.
--make-king-table pass 1/1: 261120 variants complete.
--make-king-table pass 1/1: 262656 variants complete.
--make-king-table pass 1/1: 264192 variants complete.
--make-king-table pass 1/1: 265728 variants complete.
--make-king-table pass 1/1: 267264 variants complete.
--make-king-table pass 1/1: 268800 variants complete.
--make-king-table pass 1/1: 270336 variants complete.
--make-king-table pass 1/1: Writing...                    done.
--make-king-table: 271301 variants processed.
Results written to ./11_remove_related_samples/king_analyses/king_table.kin0 .
--king-table-filter: 20 relationships reported (1044715 filtered out).
End time: Fri Dec 20 21:40:26 2024
total 237136
-rw-rw-r-- 1 dftortosa dftortosa 142084096 Dec 20 21:40 ibd_report.genome
-rw-rw-r-- 1 dftortosa dftortosa      1158 Dec 20 21:40 ibd_report.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 ibd_report.nosex
-rw-rw-r-- 1 dftortosa dftortosa  21264041 Dec 20 21:40 ibd_report_awk_processed.genome.tsv.gz
drwxrwxr-x 2 dftortosa dftortosa      4096 Dec 20 21:40 king_analyses
-rw-rw-r-- 1 dftortosa dftortosa      1227 Dec 20 21:40 ldpruned_snplist.log
-rw-rw-r-- 1 dftortosa dftortosa   1102610 Dec 20 21:40 ldpruned_snplist.prune.in
-rw-rw-r-- 1 dftortosa dftortosa   2126515 Dec 20 21:40 ldpruned_snplist.prune.out
-rw-rw-r-- 1 dftortosa dftortosa  35793839 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.bed
-rw-rw-r-- 1 dftortosa dftortosa   2849592 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.bim
-rw-rw-r-- 1 dftortosa dftortosa     56394 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.fam
-rw-rw-r-- 1 dftortosa dftortosa    185662 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.hh
-rw-rw-r-- 1 dftortosa dftortosa      1804 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.nosex
-rw-rw-r-- 1 dftortosa dftortosa  34477245 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.bed
-rw-rw-r-- 1 dftortosa dftortosa   2742773 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.bim
-rw-rw-r-- 1 dftortosa dftortosa     56394 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.fam
-rw-rw-r-- 1 dftortosa dftortosa      1388 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.nosex
-rw-rw-r-- 1 dftortosa dftortosa     16404 Dec 20 21:40 pairs_relatdness_before_filtering.png
-rw-rw-r-- 1 dftortosa dftortosa     10391 Dec 20 21:40 pi_hat_hist.png


###### load the talbe in python ######
                   #FID1      IID1  ...      IBS0   KINSHIP
0   combat_ILGSA24-17303  7695SWJO  ...  0.000000  0.500000
1   combat_ILGSA24-17873  0399AMDJ  ...  0.000000  0.499997
2   combat_ILGSA24-17873  4598DAJA  ...  0.000000  0.499997
3   combat_ILGSA24-17873  6797WFAS  ...  0.000000  0.500000
4   combat_ILGSA24-17873  7201JDAS  ...  0.026301  0.146409
5   combat_ILGSA24-17873  7493BVNO  ...  0.016356  0.243733
6   combat_ILGSA24-17873  7496STFO  ...  0.020045  0.231122
7   combat_ILGSA24-17873  7592KHJO  ...  0.000000  0.500000
8   combat_ILGSA24-17873  7796LMOO  ...  0.000000  0.500000
9   combat_ILGSA24-17873  8097JCJN  ...  0.000000  0.499997
10  combat_ILGSA24-17873  8145ORJJ  ...  0.000000  0.500000
11  combat_ILGSA24-17873  8244DCDJ  ...  0.000000  0.499992
12  combat_ILGSA24-17873  8244JHMJ  ...  0.014719  0.258806
13  combat_ILGSA24-17873  8501CGDJ  ...  0.000000  0.500000
14  combat_ILGSA24-17873  8697DMNJ  ...  0.000000  0.500000
15  combat_ILGSA24-17873  8699WPAJ  ...  0.000000  0.499997
16  combat_ILGSA24-17873  9101JBJM  ...  0.016883  0.230080
17  combat_ILGSA24-17873  9187MFMM  ...  0.000000  0.500000
18  combat_ILGSA24-17873  9196GCNM  ...  0.000000  0.500000
19  combat_ILGSA24-17873  9199ACMM  ...  0.000000  0.500000

[20 rows x 8 columns]
extract the unique cases 
We have 40 samples with KING-robust between-family kinship estimate > 0.088
['7695SWJO' '0399AMDJ' '4598DAJA' '6797WFAS' '7201JDAS' '7493BVNO'
 '7496STFO' '7592KHJO' '7796LMOO' '8097JCJN' '8145ORJJ' '8244DCDJ'
 '8244JHMJ' '8501CGDJ' '8697DMNJ' '8699WPAJ' '9101JBJM' '9187MFMM'
 '9196GCNM' '9199ACMM' '7600TJNO' '0301DMMJ' '4596DAJA' '6298TJMJ'
 '1499KMDM' '6697EVFA' '2299MTMJ' '6192DHJJ' '7789LMOO' '8002DPAN'
 '7974SJNN' '8244CDSJ' '3301THMM' '8500NHNJ' '6697MMNA' '8500AEAJ'
 '3399MBAM' '0197SNMM' '7196AMSS' '9196RFJM']

# do we have the same problematic samples in king (kindship>0.088) and pi_hat (pi_Hat>0.2)? #
check we have the exact same problematic IDs
True
Count number of each case with both approaches
Duplicates: PI_HAT=0.5 (15) and KINSHIP>0.354 (15)
First-degree: PI_HAT around 0.5 (4) and KINDSHIP between 0.17 and 0.35 (4)
Second-degree: PI_HAT around 0.25 (1) and KINDSHIP between 0.08 and 0.17 (1)
check that NONE of the problematic cases have all NA for phenotypes, this would be a problem] because we would need to prioritize cases with pheno instead of using the greedy approach implement in PLINK 2

     Gender        Age  ...  Week 8 Pred VO2max  AGRF code
0         M  25.000000  ...                47.7   8244TCOJ
1         M  43.720548  ...                43.6   6976MCJS
2         M  35.049315  ...                49.0   3484JSJJ
3         F  23.561644  ...                43.6   1389HSNM
4         M  26.164384  ...                54.0   7593DBAO
...     ...        ...  ...                 ...        ...
1459    NaN        NaN  ...                 NaN   2471AWMA
1460    NaN        NaN  ...                 NaN   6897TSSS
1461    NaN        NaN  ...                 NaN   6899DWOS
1462    NaN        NaN  ...                 NaN   6296TONJ
1463    NaN        NaN  ...                 NaN   7799BTDO

[1464 rows x 11 columns]

True
True
True

# Remove samples with a kindship above 0.354 #
from the king table, select samples above the monozygotic twins threshold
remove duplicated samples from plink files
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates.log.
Options in effect:
  --bfile ./10_remove_low_maf_snps/merged_batches_hwe_par_callrate_LogRDev_maf
  --make-bed
  --out ./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates
  --remove ./11_remove_related_samples/king_analyses/id_samples_duplicates.txt

63997 MB RAM detected; reserving 31998 MB for main workspace.
289148 variants loaded from .bim file.
1446 people (1210 males, 194 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates.nosex
.
--remove: 1416 people remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1416 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate in remaining samples is 0.999531.
289148 variants and 1416 people pass filters and QC.
Note: No phenotypes present.
--make-bed to
./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates.bed
+
./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates.bim
+
./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates.fam
... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.

Warning: 19361 het. haploid genotypes present (see
./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates.hh
); many commands treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.

load the resulting FAM file and check we do not have the duplicated samples
True
make a new king table to see the result consdering third-degree relatives and above
PLINK v2.00a4.2LM 64-bit Intel (31 May 2023)   www.cog-genomics.org/plink/2.0/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./11_remove_related_samples/king_analyses/king_table_after_dups.log.
Options in effect:
  --bfile ./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates
  --king-table-filter 0.088
  --make-king-table
  --out ./11_remove_related_samples/king_analyses/king_table_after_dups

Start time: Fri Dec 20 21:40:26 2024
63997 MiB RAM detected, ~56339 available; reserving 31998 MiB for main
workspace.
Using up to 32 threads (change this with --threads).
1416 samples (190 females, 1184 males, 42 ambiguous; 1416 founders) loaded from
./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates.fam.
289148 variants loaded from
./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates.bim.
Note: No phenotype data present.
Excluding 17847 variants on non-autosomes from KING-robust calculation.
--make-king-table pass 1/1: Scanning for rare variants... 0%24%48%72%96%done.
0 variants handled by initial scan (271301 remaining).

--make-king-table pass 1/1: 0 variants complete.
--make-king-table pass 1/1: 1536 variants complete.
--make-king-table pass 1/1: 3072 variants complete.
--make-king-table pass 1/1: 4608 variants complete.
--make-king-table pass 1/1: 6144 variants complete.
--make-king-table pass 1/1: 7680 variants complete.
--make-king-table pass 1/1: 9216 variants complete.
--make-king-table pass 1/1: 10752 variants complete.
--make-king-table pass 1/1: 12288 variants complete.
--make-king-table pass 1/1: 13824 variants complete.
--make-king-table pass 1/1: 15360 variants complete.
--make-king-table pass 1/1: 16896 variants complete.
--make-king-table pass 1/1: 18432 variants complete.
--make-king-table pass 1/1: 19968 variants complete.
--make-king-table pass 1/1: 21504 variants complete.
--make-king-table pass 1/1: 23040 variants complete.
--make-king-table pass 1/1: 24576 variants complete.
--make-king-table pass 1/1: 26112 variants complete.
--make-king-table pass 1/1: 27648 variants complete.
--make-king-table pass 1/1: 29184 variants complete.
--make-king-table pass 1/1: 30720 variants complete.
--make-king-table pass 1/1: 32256 variants complete.
--make-king-table pass 1/1: 33792 variants complete.
--make-king-table pass 1/1: 35328 variants complete.
--make-king-table pass 1/1: 36864 variants complete.
--make-king-table pass 1/1: 38400 variants complete.
--make-king-table pass 1/1: 39936 variants complete.
--make-king-table pass 1/1: 41472 variants complete.
--make-king-table pass 1/1: 43008 variants complete.
--make-king-table pass 1/1: 44544 variants complete.
--make-king-table pass 1/1: 46080 variants complete.
--make-king-table pass 1/1: 47616 variants complete.
--make-king-table pass 1/1: 49152 variants complete.
--make-king-table pass 1/1: 50688 variants complete.
--make-king-table pass 1/1: 52224 variants complete.
--make-king-table pass 1/1: 53760 variants complete.
--make-king-table pass 1/1: 55296 variants complete.
--make-king-table pass 1/1: 56832 variants complete.
--make-king-table pass 1/1: 58368 variants complete.
--make-king-table pass 1/1: 59904 variants complete.
--make-king-table pass 1/1: 61440 variants complete.
--make-king-table pass 1/1: 62976 variants complete.
--make-king-table pass 1/1: 64512 variants complete.
--make-king-table pass 1/1: 66048 variants complete.
--make-king-table pass 1/1: 67584 variants complete.
--make-king-table pass 1/1: 69120 variants complete.
--make-king-table pass 1/1: 70656 variants complete.
--make-king-table pass 1/1: 72192 variants complete.
--make-king-table pass 1/1: 73728 variants complete.
--make-king-table pass 1/1: 75264 variants complete.
--make-king-table pass 1/1: 76800 variants complete.
--make-king-table pass 1/1: 78336 variants complete.
--make-king-table pass 1/1: 79872 variants complete.
--make-king-table pass 1/1: 81408 variants complete.
--make-king-table pass 1/1: 82944 variants complete.
--make-king-table pass 1/1: 84480 variants complete.
--make-king-table pass 1/1: 86016 variants complete.
--make-king-table pass 1/1: 87552 variants complete.
--make-king-table pass 1/1: 89088 variants complete.
--make-king-table pass 1/1: 90624 variants complete.
--make-king-table pass 1/1: 92160 variants complete.
--make-king-table pass 1/1: 93696 variants complete.
--make-king-table pass 1/1: 95232 variants complete.
--make-king-table pass 1/1: 96768 variants complete.
--make-king-table pass 1/1: 98304 variants complete.
--make-king-table pass 1/1: 99840 variants complete.
--make-king-table pass 1/1: 101376 variants complete.
--make-king-table pass 1/1: 102912 variants complete.
--make-king-table pass 1/1: 104448 variants complete.
--make-king-table pass 1/1: 105984 variants complete.
--make-king-table pass 1/1: 107520 variants complete.
--make-king-table pass 1/1: 109056 variants complete.
--make-king-table pass 1/1: 110592 variants complete.
--make-king-table pass 1/1: 112128 variants complete.
--make-king-table pass 1/1: 113664 variants complete.
--make-king-table pass 1/1: 115200 variants complete.
--make-king-table pass 1/1: 116736 variants complete.
--make-king-table pass 1/1: 118272 variants complete.
--make-king-table pass 1/1: 119808 variants complete.
--make-king-table pass 1/1: 121344 variants complete.
--make-king-table pass 1/1: 122880 variants complete.
--make-king-table pass 1/1: 124416 variants complete.
--make-king-table pass 1/1: 125952 variants complete.
--make-king-table pass 1/1: 127488 variants complete.
--make-king-table pass 1/1: 129024 variants complete.
--make-king-table pass 1/1: 130560 variants complete.
--make-king-table pass 1/1: 132096 variants complete.
--make-king-table pass 1/1: 133632 variants complete.
--make-king-table pass 1/1: 135168 variants complete.
--make-king-table pass 1/1: 136704 variants complete.
--make-king-table pass 1/1: 138240 variants complete.
--make-king-table pass 1/1: 139776 variants complete.
--make-king-table pass 1/1: 141312 variants complete.
--make-king-table pass 1/1: 142848 variants complete.
--make-king-table pass 1/1: 144384 variants complete.
--make-king-table pass 1/1: 145920 variants complete.
--make-king-table pass 1/1: 147456 variants complete.
--make-king-table pass 1/1: 148992 variants complete.
--make-king-table pass 1/1: 150528 variants complete.
--make-king-table pass 1/1: 152064 variants complete.
--make-king-table pass 1/1: 153600 variants complete.
--make-king-table pass 1/1: 155136 variants complete.
--make-king-table pass 1/1: 156672 variants complete.
--make-king-table pass 1/1: 158208 variants complete.
--make-king-table pass 1/1: 159744 variants complete.
--make-king-table pass 1/1: 161280 variants complete.
--make-king-table pass 1/1: 162816 variants complete.
--make-king-table pass 1/1: 164352 variants complete.
--make-king-table pass 1/1: 165888 variants complete.
--make-king-table pass 1/1: 167424 variants complete.
--make-king-table pass 1/1: 168960 variants complete.
--make-king-table pass 1/1: 170496 variants complete.
--make-king-table pass 1/1: 172032 variants complete.
--make-king-table pass 1/1: 173568 variants complete.
--make-king-table pass 1/1: 175104 variants complete.
--make-king-table pass 1/1: 176640 variants complete.
--make-king-table pass 1/1: 178176 variants complete.
--make-king-table pass 1/1: 179712 variants complete.
--make-king-table pass 1/1: 181248 variants complete.
--make-king-table pass 1/1: 182784 variants complete.
--make-king-table pass 1/1: 184320 variants complete.
--make-king-table pass 1/1: 185856 variants complete.
--make-king-table pass 1/1: 187392 variants complete.
--make-king-table pass 1/1: 188928 variants complete.
--make-king-table pass 1/1: 190464 variants complete.
--make-king-table pass 1/1: 192000 variants complete.
--make-king-table pass 1/1: 193536 variants complete.
--make-king-table pass 1/1: 195072 variants complete.
--make-king-table pass 1/1: 196608 variants complete.
--make-king-table pass 1/1: 198144 variants complete.
--make-king-table pass 1/1: 199680 variants complete.
--make-king-table pass 1/1: 201216 variants complete.
--make-king-table pass 1/1: 202752 variants complete.
--make-king-table pass 1/1: 204288 variants complete.
--make-king-table pass 1/1: 205824 variants complete.
--make-king-table pass 1/1: 207360 variants complete.
--make-king-table pass 1/1: 208896 variants complete.
--make-king-table pass 1/1: 210432 variants complete.
--make-king-table pass 1/1: 211968 variants complete.
--make-king-table pass 1/1: 213504 variants complete.
--make-king-table pass 1/1: 215040 variants complete.
--make-king-table pass 1/1: 216576 variants complete.
--make-king-table pass 1/1: 218112 variants complete.
--make-king-table pass 1/1: 219648 variants complete.
--make-king-table pass 1/1: 221184 variants complete.
--make-king-table pass 1/1: 222720 variants complete.
--make-king-table pass 1/1: 224256 variants complete.
--make-king-table pass 1/1: 225792 variants complete.
--make-king-table pass 1/1: 227328 variants complete.
--make-king-table pass 1/1: 228864 variants complete.
--make-king-table pass 1/1: 230400 variants complete.
--make-king-table pass 1/1: 231936 variants complete.
--make-king-table pass 1/1: 233472 variants complete.
--make-king-table pass 1/1: 235008 variants complete.
--make-king-table pass 1/1: 236544 variants complete.
--make-king-table pass 1/1: 238080 variants complete.
--make-king-table pass 1/1: 239616 variants complete.
--make-king-table pass 1/1: 241152 variants complete.
--make-king-table pass 1/1: 242688 variants complete.
--make-king-table pass 1/1: 244224 variants complete.
--make-king-table pass 1/1: 245760 variants complete.
--make-king-table pass 1/1: 247296 variants complete.
--make-king-table pass 1/1: 248832 variants complete.
--make-king-table pass 1/1: 250368 variants complete.
--make-king-table pass 1/1: 251904 variants complete.
--make-king-table pass 1/1: 253440 variants complete.
--make-king-table pass 1/1: 254976 variants complete.
--make-king-table pass 1/1: 256512 variants complete.
--make-king-table pass 1/1: 258048 variants complete.
--make-king-table pass 1/1: 259584 variants complete.
--make-king-table pass 1/1: 261120 variants complete.
--make-king-table pass 1/1: 262656 variants complete.
--make-king-table pass 1/1: 264192 variants complete.
--make-king-table pass 1/1: 265728 variants complete.
--make-king-table pass 1/1: 267264 variants complete.
--make-king-table pass 1/1: 268800 variants complete.
--make-king-table pass 1/1: 270336 variants complete.
--make-king-table pass 1/1: Writing...                    done.
--make-king-table: 271301 variants processed.
Results written to
./11_remove_related_samples/king_analyses/king_table_after_dups.kin0 .
--king-table-filter: 5 relationships reported (1001815 filtered out).
End time: Fri Dec 20 21:40:28 2024
total 237136
-rw-rw-r-- 1 dftortosa dftortosa 142084096 Dec 20 21:40 ibd_report.genome
-rw-rw-r-- 1 dftortosa dftortosa      1158 Dec 20 21:40 ibd_report.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 ibd_report.nosex
-rw-rw-r-- 1 dftortosa dftortosa  21264041 Dec 20 21:40 ibd_report_awk_processed.genome.tsv.gz
drwxrwxr-x 2 dftortosa dftortosa      4096 Dec 20 21:40 king_analyses
-rw-rw-r-- 1 dftortosa dftortosa      1227 Dec 20 21:40 ldpruned_snplist.log
-rw-rw-r-- 1 dftortosa dftortosa   1102610 Dec 20 21:40 ldpruned_snplist.prune.in
-rw-rw-r-- 1 dftortosa dftortosa   2126515 Dec 20 21:40 ldpruned_snplist.prune.out
-rw-rw-r-- 1 dftortosa dftortosa  35793839 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.bed
-rw-rw-r-- 1 dftortosa dftortosa   2849592 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.bim
-rw-rw-r-- 1 dftortosa dftortosa     56394 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.fam
-rw-rw-r-- 1 dftortosa dftortosa    185662 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.hh
-rw-rw-r-- 1 dftortosa dftortosa      1804 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.nosex
-rw-rw-r-- 1 dftortosa dftortosa  34477245 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.bed
-rw-rw-r-- 1 dftortosa dftortosa   2742773 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.bim
-rw-rw-r-- 1 dftortosa dftortosa     56394 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.fam
-rw-rw-r-- 1 dftortosa dftortosa      1388 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.nosex
-rw-rw-r-- 1 dftortosa dftortosa     16404 Dec 20 21:40 pairs_relatdness_before_filtering.png
-rw-rw-r-- 1 dftortosa dftortosa     10391 Dec 20 21:40 pi_hat_hist.png

                  #FID1      IID1  ...      IBS0   KINSHIP
0  combat_ILGSA24-17873  7201JDAS  ...  0.026301  0.146409
1  combat_ILGSA24-17873  7493BVNO  ...  0.016356  0.243733
2  combat_ILGSA24-17873  7496STFO  ...  0.020045  0.231122
3  combat_ILGSA24-17873  8244JHMJ  ...  0.014719  0.258806
4  combat_ILGSA24-17873  9101JBJM  ...  0.016883  0.230080

[5 rows x 8 columns]

# Remove samples with first and second-degree relationship using --king-cutoff #
PLINK v2.00a4.2LM 64-bit Intel (31 May 2023)   www.cog-genomics.org/plink/2.0/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.log.
Options in effect:
  --bfile ./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates
  --king-cutoff 0.088
  --make-bed
  --out ./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related

Start time: Fri Dec 20 21:40:28 2024
63997 MiB RAM detected, ~56340 available; reserving 31998 MiB for main
workspace.
Using up to 32 threads (change this with --threads).
1416 samples (190 females, 1184 males, 42 ambiguous; 1416 founders) loaded from
./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates.fam.
289148 variants loaded from
./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates.bim.
Note: No phenotype data present.
Excluding 17847 variants on non-autosomes from KING-robust calculation.
--king-cutoff pass 1/1: Scanning for rare variants... 0%24%48%72%96%done.
0 variants handled by initial scan (271301 remaining).

--king-cutoff pass 1/1: 0 variants complete.
--king-cutoff pass 1/1: 1536 variants complete.
--king-cutoff pass 1/1: 3072 variants complete.
--king-cutoff pass 1/1: 4608 variants complete.
--king-cutoff pass 1/1: 6144 variants complete.
--king-cutoff pass 1/1: 7680 variants complete.
--king-cutoff pass 1/1: 9216 variants complete.
--king-cutoff pass 1/1: 10752 variants complete.
--king-cutoff pass 1/1: 12288 variants complete.
--king-cutoff pass 1/1: 13824 variants complete.
--king-cutoff pass 1/1: 15360 variants complete.
--king-cutoff pass 1/1: 16896 variants complete.
--king-cutoff pass 1/1: 18432 variants complete.
--king-cutoff pass 1/1: 19968 variants complete.
--king-cutoff pass 1/1: 21504 variants complete.
--king-cutoff pass 1/1: 23040 variants complete.
--king-cutoff pass 1/1: 24576 variants complete.
--king-cutoff pass 1/1: 26112 variants complete.
--king-cutoff pass 1/1: 27648 variants complete.
--king-cutoff pass 1/1: 29184 variants complete.
--king-cutoff pass 1/1: 30720 variants complete.
--king-cutoff pass 1/1: 32256 variants complete.
--king-cutoff pass 1/1: 33792 variants complete.
--king-cutoff pass 1/1: 35328 variants complete.
--king-cutoff pass 1/1: 36864 variants complete.
--king-cutoff pass 1/1: 38400 variants complete.
--king-cutoff pass 1/1: 39936 variants complete.
--king-cutoff pass 1/1: 41472 variants complete.
--king-cutoff pass 1/1: 43008 variants complete.
--king-cutoff pass 1/1: 44544 variants complete.
--king-cutoff pass 1/1: 46080 variants complete.
--king-cutoff pass 1/1: 47616 variants complete.
--king-cutoff pass 1/1: 49152 variants complete.
--king-cutoff pass 1/1: 50688 variants complete.
--king-cutoff pass 1/1: 52224 variants complete.
--king-cutoff pass 1/1: 53760 variants complete.
--king-cutoff pass 1/1: 55296 variants complete.
--king-cutoff pass 1/1: 56832 variants complete.
--king-cutoff pass 1/1: 58368 variants complete.
--king-cutoff pass 1/1: 59904 variants complete.
--king-cutoff pass 1/1: 61440 variants complete.
--king-cutoff pass 1/1: 62976 variants complete.
--king-cutoff pass 1/1: 64512 variants complete.
--king-cutoff pass 1/1: 66048 variants complete.
--king-cutoff pass 1/1: 67584 variants complete.
--king-cutoff pass 1/1: 69120 variants complete.
--king-cutoff pass 1/1: 70656 variants complete.
--king-cutoff pass 1/1: 72192 variants complete.
--king-cutoff pass 1/1: 73728 variants complete.
--king-cutoff pass 1/1: 75264 variants complete.
--king-cutoff pass 1/1: 76800 variants complete.
--king-cutoff pass 1/1: 78336 variants complete.
--king-cutoff pass 1/1: 79872 variants complete.
--king-cutoff pass 1/1: 81408 variants complete.
--king-cutoff pass 1/1: 82944 variants complete.
--king-cutoff pass 1/1: 84480 variants complete.
--king-cutoff pass 1/1: 86016 variants complete.
--king-cutoff pass 1/1: 87552 variants complete.
--king-cutoff pass 1/1: 89088 variants complete.
--king-cutoff pass 1/1: 90624 variants complete.
--king-cutoff pass 1/1: 92160 variants complete.
--king-cutoff pass 1/1: 93696 variants complete.
--king-cutoff pass 1/1: 95232 variants complete.
--king-cutoff pass 1/1: 96768 variants complete.
--king-cutoff pass 1/1: 98304 variants complete.
--king-cutoff pass 1/1: 99840 variants complete.
--king-cutoff pass 1/1: 101376 variants complete.
--king-cutoff pass 1/1: 102912 variants complete.
--king-cutoff pass 1/1: 104448 variants complete.
--king-cutoff pass 1/1: 105984 variants complete.
--king-cutoff pass 1/1: 107520 variants complete.
--king-cutoff pass 1/1: 109056 variants complete.
--king-cutoff pass 1/1: 110592 variants complete.
--king-cutoff pass 1/1: 112128 variants complete.
--king-cutoff pass 1/1: 113664 variants complete.
--king-cutoff pass 1/1: 115200 variants complete.
--king-cutoff pass 1/1: 116736 variants complete.
--king-cutoff pass 1/1: 118272 variants complete.
--king-cutoff pass 1/1: 119808 variants complete.
--king-cutoff pass 1/1: 121344 variants complete.
--king-cutoff pass 1/1: 122880 variants complete.
--king-cutoff pass 1/1: 124416 variants complete.
--king-cutoff pass 1/1: 125952 variants complete.
--king-cutoff pass 1/1: 127488 variants complete.
--king-cutoff pass 1/1: 129024 variants complete.
--king-cutoff pass 1/1: 130560 variants complete.
--king-cutoff pass 1/1: 132096 variants complete.
--king-cutoff pass 1/1: 133632 variants complete.
--king-cutoff pass 1/1: 135168 variants complete.
--king-cutoff pass 1/1: 136704 variants complete.
--king-cutoff pass 1/1: 138240 variants complete.
--king-cutoff pass 1/1: 139776 variants complete.
--king-cutoff pass 1/1: 141312 variants complete.
--king-cutoff pass 1/1: 142848 variants complete.
--king-cutoff pass 1/1: 144384 variants complete.
--king-cutoff pass 1/1: 145920 variants complete.
--king-cutoff pass 1/1: 147456 variants complete.
--king-cutoff pass 1/1: 148992 variants complete.
--king-cutoff pass 1/1: 150528 variants complete.
--king-cutoff pass 1/1: 152064 variants complete.
--king-cutoff pass 1/1: 153600 variants complete.
--king-cutoff pass 1/1: 155136 variants complete.
--king-cutoff pass 1/1: 156672 variants complete.
--king-cutoff pass 1/1: 158208 variants complete.
--king-cutoff pass 1/1: 159744 variants complete.
--king-cutoff pass 1/1: 161280 variants complete.
--king-cutoff pass 1/1: 162816 variants complete.
--king-cutoff pass 1/1: 164352 variants complete.
--king-cutoff pass 1/1: 165888 variants complete.
--king-cutoff pass 1/1: 167424 variants complete.
--king-cutoff pass 1/1: 168960 variants complete.
--king-cutoff pass 1/1: 170496 variants complete.
--king-cutoff pass 1/1: 172032 variants complete.
--king-cutoff pass 1/1: 173568 variants complete.
--king-cutoff pass 1/1: 175104 variants complete.
--king-cutoff pass 1/1: 176640 variants complete.
--king-cutoff pass 1/1: 178176 variants complete.
--king-cutoff pass 1/1: 179712 variants complete.
--king-cutoff pass 1/1: 181248 variants complete.
--king-cutoff pass 1/1: 182784 variants complete.
--king-cutoff pass 1/1: 184320 variants complete.
--king-cutoff pass 1/1: 185856 variants complete.
--king-cutoff pass 1/1: 187392 variants complete.
--king-cutoff pass 1/1: 188928 variants complete.
--king-cutoff pass 1/1: 190464 variants complete.
--king-cutoff pass 1/1: 192000 variants complete.
--king-cutoff pass 1/1: 193536 variants complete.
--king-cutoff pass 1/1: 195072 variants complete.
--king-cutoff pass 1/1: 196608 variants complete.
--king-cutoff pass 1/1: 198144 variants complete.
--king-cutoff pass 1/1: 199680 variants complete.
--king-cutoff pass 1/1: 201216 variants complete.
--king-cutoff pass 1/1: 202752 variants complete.
--king-cutoff pass 1/1: 204288 variants complete.
--king-cutoff pass 1/1: 205824 variants complete.
--king-cutoff pass 1/1: 207360 variants complete.
--king-cutoff pass 1/1: 208896 variants complete.
--king-cutoff pass 1/1: 210432 variants complete.
--king-cutoff pass 1/1: 211968 variants complete.
--king-cutoff pass 1/1: 213504 variants complete.
--king-cutoff pass 1/1: 215040 variants complete.
--king-cutoff pass 1/1: 216576 variants complete.
--king-cutoff pass 1/1: 218112 variants complete.
--king-cutoff pass 1/1: 219648 variants complete.
--king-cutoff pass 1/1: 221184 variants complete.
--king-cutoff pass 1/1: 222720 variants complete.
--king-cutoff pass 1/1: 224256 variants complete.
--king-cutoff pass 1/1: 225792 variants complete.
--king-cutoff pass 1/1: 227328 variants complete.
--king-cutoff pass 1/1: 228864 variants complete.
--king-cutoff pass 1/1: 230400 variants complete.
--king-cutoff pass 1/1: 231936 variants complete.
--king-cutoff pass 1/1: 233472 variants complete.
--king-cutoff pass 1/1: 235008 variants complete.
--king-cutoff pass 1/1: 236544 variants complete.
--king-cutoff pass 1/1: 238080 variants complete.
--king-cutoff pass 1/1: 239616 variants complete.
--king-cutoff pass 1/1: 241152 variants complete.
--king-cutoff pass 1/1: 242688 variants complete.
--king-cutoff pass 1/1: 244224 variants complete.
--king-cutoff pass 1/1: 245760 variants complete.
--king-cutoff pass 1/1: 247296 variants complete.
--king-cutoff pass 1/1: 248832 variants complete.
--king-cutoff pass 1/1: 250368 variants complete.
--king-cutoff pass 1/1: 251904 variants complete.
--king-cutoff pass 1/1: 253440 variants complete.
--king-cutoff pass 1/1: 254976 variants complete.
--king-cutoff pass 1/1: 256512 variants complete.
--king-cutoff pass 1/1: 258048 variants complete.
--king-cutoff pass 1/1: 259584 variants complete.
--king-cutoff pass 1/1: 261120 variants complete.
--king-cutoff pass 1/1: 262656 variants complete.
--king-cutoff pass 1/1: 264192 variants complete.
--king-cutoff pass 1/1: 265728 variants complete.
--king-cutoff pass 1/1: 267264 variants complete.
--king-cutoff pass 1/1: 268800 variants complete.
--king-cutoff pass 1/1: 270336 variants complete.
--king-cutoff pass 1/1: Condensing...                 done.
--king-cutoff: 271301 variants processed.
--king-cutoff: Excluded sample IDs written to
./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.king.cutoff.out.id
, and 1411 remaining sample IDs written to
./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.king.cutoff.in.id
.
Writing
./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.fam
... done.
Writing
./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.bim
... done.
Writing
./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.bed
... 0%22%45%67%90%done.
End time: Fri Dec 20 21:40:29 2024
total 216876
-rw-rw-r-- 1 dftortosa dftortosa       900 Dec 20 21:40 id_samples_duplicates.txt
-rw-rw-r-- 1 dftortosa dftortosa      1770 Dec 20 21:40 king_table.kin0
-rw-rw-r-- 1 dftortosa dftortosa      1388 Dec 20 21:40 king_table.log
-rw-rw-r-- 1 dftortosa dftortosa       519 Dec 20 21:40 king_table_after_dups.kin0
-rw-rw-r-- 1 dftortosa dftortosa      1493 Dec 20 21:40 king_table_after_dups.log
-rw-rw-r-- 1 dftortosa dftortosa 102358395 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates.bed
-rw-rw-r-- 1 dftortosa dftortosa   8340840 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates.bim
-rw-rw-r-- 1 dftortosa dftortosa     55224 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates.fam
-rw-rw-r-- 1 dftortosa dftortosa    785187 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates.hh
-rw-rw-r-- 1 dftortosa dftortosa      1920 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates.nosex
-rw-rw-r-- 1 dftortosa dftortosa 102069247 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.bed
-rw-rw-r-- 1 dftortosa dftortosa   8323031 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.bim
-rw-rw-r-- 1 dftortosa dftortosa     55029 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.fam
-rw-rw-r-- 1 dftortosa dftortosa     42339 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.king.cutoff.in.id
-rw-rw-r-- 1 dftortosa dftortosa       159 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.king.cutoff.out.id
-rw-rw-r-- 1 dftortosa dftortosa      2072 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.log

see the samples removed in the last filter
                   #FID       IID
0  combat_ILGSA24-17873  7201JDAS
1  combat_ILGSA24-17873  7493BVNO
2  combat_ILGSA24-17873  7496STFO
3  combat_ILGSA24-17873  8244JHMJ
4  combat_ILGSA24-17873  9101JBJM

# compare the number of removed samples with the total number of problematic samples #
The number of samples filtered out due to relatedness is: 35

###### apply again the MAF and missing filters ######

## create a folder to save plink data after new filters ##
total 52
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 00_snp_duplicates
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 01_chromosome_filtering
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 02_remove_non_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 03_remove_pos_dups
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 04_remove_low_maf_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 05_remove_missing_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 06_first_hwe_filter
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 07_par_problem_cleanup
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 08_remove_low_call_samples
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 09_remove_high_LogRDev_samples
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 10_remove_low_maf_snps
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 11_remove_related_samples
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 12_loop_maf_missing


## create missing and freq reports ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./12_loop_maf_missing/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.log.
Options in effect:
  --bfile ./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related
  --freq
  --missing
  --out ./12_loop_maf_missing/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related

63997 MB RAM detected; reserving 31998 MB for main workspace.
289148 variants loaded from .bim file.
1411 people (1179 males, 190 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./12_loop_maf_missing/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.nosex
.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1411 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.99953.
--freq: Allele frequencies (founders only) written to
./12_loop_maf_missing/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.frq
.
--missing: Sample missing data report written to
./12_loop_maf_missing/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.imiss,
and variant-based missing data report written to
./12_loop_maf_missing/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.lmiss.
total 52
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 00_snp_duplicates
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 01_chromosome_filtering
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 02_remove_non_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 03_remove_pos_dups
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 04_remove_low_maf_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 05_remove_missing_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 06_first_hwe_filter
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 07_par_problem_cleanup
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 08_remove_low_call_samples
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 09_remove_high_LogRDev_samples
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 10_remove_low_maf_snps
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 11_remove_related_samples
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 12_loop_maf_missing

Warning: 19349 het. haploid genotypes present (see
./12_loop_maf_missing/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.hh
); many commands treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


## check if we have SNPs below the MAF threshold after removing samples ##
764

We have 764 SNPs below the MAF threshold after the first round of filters

## check if we have SNPs below the missing threshold after removing samples ##


We have 0 SNPs above the missing threshold after the first round of filters

## repeat the filters if these snps exists ##

# apply MAF and missing SNP filters #
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./12_loop_maf_missing/loop_maf_missing_1.log.
Options in effect:
  --bfile ./11_remove_related_samples/king_analyses/merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related
  --geno 0.01
  --maf 0.05
  --make-bed
  --out ./12_loop_maf_missing/loop_maf_missing_1

63997 MB RAM detected; reserving 31998 MB for main workspace.
289148 variants loaded from .bim file.
1411 people (1179 males, 190 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to ./12_loop_maf_missing/loop_maf_missing_1.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1411 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.99953.
0 variants removed due to missing genotype data (--geno).
764 variants removed due to minor allele threshold(s)
(--maf/--max-maf/--mac/--max-mac).
288384 variants and 1411 people pass filters and QC.
Note: No phenotypes present.
--make-bed to ./12_loop_maf_missing/loop_maf_missing_1.bed +
./12_loop_maf_missing/loop_maf_missing_1.bim +
./12_loop_maf_missing/loop_maf_missing_1.fam ... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
total 146292
-rw-rw-r-- 1 dftortosa dftortosa 101799555 Dec 20 21:40 loop_maf_missing_1.bed
-rw-rw-r-- 1 dftortosa dftortosa   8317213 Dec 20 21:40 loop_maf_missing_1.bim
-rw-rw-r-- 1 dftortosa dftortosa     55029 Dec 20 21:40 loop_maf_missing_1.fam
-rw-rw-r-- 1 dftortosa dftortosa    784692 Dec 20 21:40 loop_maf_missing_1.hh
-rw-rw-r-- 1 dftortosa dftortosa      1660 Dec 20 21:40 loop_maf_missing_1.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 loop_maf_missing_1.nosex
-rw-r--r-- 1 dftortosa dftortosa  19662132 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.frq
-rw-rw-r-- 1 dftortosa dftortosa    784692 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.hh
-rw-r--r-- 1 dftortosa dftortosa    102855 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.imiss
-rw-r--r-- 1 dftortosa dftortosa  18262729 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.lmiss
-rw-rw-r-- 1 dftortosa dftortosa      1808 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.nosex

Warning: 19349 het. haploid genotypes present (see
./12_loop_maf_missing/loop_maf_missing_1.hh ); many commands treat these as
missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


# apply missing sample filters #
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./12_loop_maf_missing/loop_maf_missing_2.log.
Options in effect:
  --bfile ./12_loop_maf_missing/loop_maf_missing_1
  --make-bed
  --mind 0.01
  --out ./12_loop_maf_missing/loop_maf_missing_2

63997 MB RAM detected; reserving 31998 MB for main workspace.
288384 variants loaded from .bim file.
1411 people (1179 males, 190 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to ./12_loop_maf_missing/loop_maf_missing_2.nosex .
0 people removed due to missing genotype data (--mind).
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1411 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.99953.
288384 variants and 1411 people pass filters and QC.
Note: No phenotypes present.
--make-bed to ./12_loop_maf_missing/loop_maf_missing_2.bed +
./12_loop_maf_missing/loop_maf_missing_2.bim +
./12_loop_maf_missing/loop_maf_missing_2.fam ... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
total 254664
-rw-rw-r-- 1 dftortosa dftortosa 101799555 Dec 20 21:40 loop_maf_missing_1.bed
-rw-rw-r-- 1 dftortosa dftortosa   8317213 Dec 20 21:40 loop_maf_missing_1.bim
-rw-rw-r-- 1 dftortosa dftortosa     55029 Dec 20 21:40 loop_maf_missing_1.fam
-rw-rw-r-- 1 dftortosa dftortosa    784692 Dec 20 21:40 loop_maf_missing_1.hh
-rw-rw-r-- 1 dftortosa dftortosa      1660 Dec 20 21:40 loop_maf_missing_1.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 loop_maf_missing_1.nosex
-rw-rw-r-- 1 dftortosa dftortosa 101799555 Dec 20 21:40 loop_maf_missing_2.bed
-rw-rw-r-- 1 dftortosa dftortosa   8317213 Dec 20 21:40 loop_maf_missing_2.bim
-rw-rw-r-- 1 dftortosa dftortosa     55029 Dec 20 21:40 loop_maf_missing_2.fam
-rw-rw-r-- 1 dftortosa dftortosa    784285 Dec 20 21:40 loop_maf_missing_2.hh
-rw-rw-r-- 1 dftortosa dftortosa      1492 Dec 20 21:40 loop_maf_missing_2.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 loop_maf_missing_2.nosex
-rw-r--r-- 1 dftortosa dftortosa  19662132 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.frq
-rw-rw-r-- 1 dftortosa dftortosa    784692 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.hh
-rw-r--r-- 1 dftortosa dftortosa    102855 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.imiss
-rw-r--r-- 1 dftortosa dftortosa  18262729 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.lmiss
-rw-rw-r-- 1 dftortosa dftortosa      1808 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.nosex

Warning: 19339 het. haploid genotypes present (see
./12_loop_maf_missing/loop_maf_missing_2.hh ); many commands treat these as
missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


# create MAF and missing reports #
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to loop_maf_missing_2_reports.log.
Options in effect:
  --bfile loop_maf_missing_2
  --freq
  --missing
  --out loop_maf_missing_2_reports

63997 MB RAM detected; reserving 31998 MB for main workspace.
288384 variants loaded from .bim file.
1411 people (1179 males, 190 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to loop_maf_missing_2_reports.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1411 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.99953.
--freq: Allele frequencies (founders only) written to
loop_maf_missing_2_reports.frq .
--missing: Sample missing data report written to
loop_maf_missing_2_reports.imiss, and variant-based missing data report written
to loop_maf_missing_2_reports.lmiss.
total 292484
-rw-rw-r-- 1 dftortosa dftortosa 101799555 Dec 20 21:40 loop_maf_missing_1.bed
-rw-rw-r-- 1 dftortosa dftortosa   8317213 Dec 20 21:40 loop_maf_missing_1.bim
-rw-rw-r-- 1 dftortosa dftortosa     55029 Dec 20 21:40 loop_maf_missing_1.fam
-rw-rw-r-- 1 dftortosa dftortosa    784692 Dec 20 21:40 loop_maf_missing_1.hh
-rw-rw-r-- 1 dftortosa dftortosa      1660 Dec 20 21:40 loop_maf_missing_1.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 loop_maf_missing_1.nosex
-rw-rw-r-- 1 dftortosa dftortosa 101799555 Dec 20 21:40 loop_maf_missing_2.bed
-rw-rw-r-- 1 dftortosa dftortosa   8317213 Dec 20 21:40 loop_maf_missing_2.bim
-rw-rw-r-- 1 dftortosa dftortosa     55029 Dec 20 21:40 loop_maf_missing_2.fam
-rw-rw-r-- 1 dftortosa dftortosa    784285 Dec 20 21:40 loop_maf_missing_2.hh
-rw-rw-r-- 1 dftortosa dftortosa      1492 Dec 20 21:40 loop_maf_missing_2.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 loop_maf_missing_2.nosex
-rw-r--r-- 1 dftortosa dftortosa  19610180 Dec 20 21:40 loop_maf_missing_2_reports.frq
-rw-rw-r-- 1 dftortosa dftortosa    784285 Dec 20 21:40 loop_maf_missing_2_reports.hh
-rw-r--r-- 1 dftortosa dftortosa    102842 Dec 20 21:40 loop_maf_missing_2_reports.imiss
-rw-r--r-- 1 dftortosa dftortosa  18214499 Dec 20 21:40 loop_maf_missing_2_reports.lmiss
-rw-rw-r-- 1 dftortosa dftortosa      1394 Dec 20 21:40 loop_maf_missing_2_reports.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 loop_maf_missing_2_reports.nosex
-rw-r--r-- 1 dftortosa dftortosa  19662132 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.frq
-rw-rw-r-- 1 dftortosa dftortosa    784692 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.hh
-rw-r--r-- 1 dftortosa dftortosa    102855 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.imiss
-rw-r--r-- 1 dftortosa dftortosa  18262729 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.lmiss
-rw-rw-r-- 1 dftortosa dftortosa      1808 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_duplicates_related.nosex

Warning: 19339 het. haploid genotypes present (see
loop_maf_missing_2_reports.hh ); many commands treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


# check reports again #


We have 0 SNPs below the MAF threshold after the second round of filters


We have 0 SNPs above the missing threshold after the second round of filters


We have 0 Samples above the missing threshold after the second round of filters

# stop if we still have SNPs/samples not meeting the filters #

## just copy plink files if no filter is required ##
Step not required.

###### visualize heterozygosity ######

## create folder for this step ##
total 56
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 00_snp_duplicates
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 01_chromosome_filtering
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 02_remove_non_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 03_remove_pos_dups
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 04_remove_low_maf_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 05_remove_missing_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 06_first_hwe_filter
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 07_par_problem_cleanup
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 08_remove_low_call_samples
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 09_remove_high_LogRDev_samples
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 10_remove_low_maf_snps
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 11_remove_related_samples
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 12_loop_maf_missing
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 13_visual_hetero


## calculate heterozygosity and missing reports per sample ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./13_visual_hetero/loop_maf_missing_2_hetero.log.
Options in effect:
  --bfile ./12_loop_maf_missing/loop_maf_missing_2
  --het
  --missing
  --out ./13_visual_hetero/loop_maf_missing_2_hetero

63997 MB RAM detected; reserving 31998 MB for main workspace.
288384 variants loaded from .bim file.
1411 people (1179 males, 190 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to ./13_visual_hetero/loop_maf_missing_2_hetero.nosex
.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1411 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.99953.
--missing: Sample missing data report written to
./13_visual_hetero/loop_maf_missing_2_hetero.imiss, and variant-based missing
data report written to ./13_visual_hetero/loop_maf_missing_2_hetero.lmiss.
288384 variants and 1411 people pass filters and QC.
Note: No phenotypes present.
--het: 270565 variants scanned, report written to
./13_visual_hetero/loop_maf_missing_2_hetero.het .

Warning: 19339 het. haploid genotypes present (see
./13_visual_hetero/loop_maf_missing_2_hetero.hh ); many commands treat these as
missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


## process the missing report ##

                       FID       IID MISS_PHENO  N_MISS  N_GENO    F_MISS
0     combat_ILGSA24-17303  0200ADMM          Y      73  288384  0.000253
1     combat_ILGSA24-17303  0200ASJM          Y      84  287973  0.000292
2     combat_ILGSA24-17303  0200BHNM          Y     115  287973  0.000399
3     combat_ILGSA24-17303  0200CBOM          Y     370  288384  0.001283
4     combat_ILGSA24-17303  0200CDFM          Y      66  287973  0.000229
...                    ...       ...        ...     ...     ...       ...
1406  combat_ILGSA24-17873  9693JMNM          Y      54  288384  0.000187
1407  combat_ILGSA24-17873  9696DWFM          Y      63  288384  0.000218
1408  combat_ILGSA24-17873  9697STJM          Y      80  288384  0.000277
1409  combat_ILGSA24-17873  9699DNOM          Y      58  288384  0.000201
1410  combat_ILGSA24-17873  9699ISMM          Y     109  288384  0.000378

[1411 rows x 6 columns]

## process the heterozygosity report ##

                       FID       IID  O(HOM)    E(HOM)   N(NM)         F
0     combat_ILGSA24-17303  0200ADMM  181836  180300.0  270506  0.017300
1     combat_ILGSA24-17303  0200ASJM  179926  180300.0  270493 -0.003758
2     combat_ILGSA24-17303  0200BHNM  181006  180200.0  270460  0.008454
3     combat_ILGSA24-17303  0200CBOM  182296  180100.0  270275  0.024260
4     combat_ILGSA24-17303  0200CDFM  182030  180300.0  270511  0.019430
...                    ...       ...     ...       ...     ...       ...
1406  combat_ILGSA24-17873  9693JMNM  181126  180300.0  270518  0.009346
1407  combat_ILGSA24-17873  9696DWFM  180251  180300.0  270507 -0.000270
1408  combat_ILGSA24-17873  9697STJM  181000  180300.0  270494  0.008129
1409  combat_ILGSA24-17873  9699DNOM  180767  180300.0  270518  0.005368
1410  combat_ILGSA24-17873  9699ISMM  182058  180200.0  270469  0.020040

[1411 rows x 6 columns]

## merge both datasets ##
                       FID       IID MISS_PHENO  ...    E(HOM)   N(NM)         F
0     combat_ILGSA24-17303  0200ADMM          Y  ...  180300.0  270506  0.017300
1     combat_ILGSA24-17303  0200ASJM          Y  ...  180300.0  270493 -0.003758
2     combat_ILGSA24-17303  0200BHNM          Y  ...  180200.0  270460  0.008454
3     combat_ILGSA24-17303  0200CBOM          Y  ...  180100.0  270275  0.024260
4     combat_ILGSA24-17303  0200CDFM          Y  ...  180300.0  270511  0.019430
...                    ...       ...        ...  ...       ...     ...       ...
1406  combat_ILGSA24-17873  9693JMNM          Y  ...  180300.0  270518  0.009346
1407  combat_ILGSA24-17873  9696DWFM          Y  ...  180300.0  270507 -0.000270
1408  combat_ILGSA24-17873  9697STJM          Y  ...  180300.0  270494  0.008129
1409  combat_ILGSA24-17873  9699DNOM          Y  ...  180300.0  270518  0.005368
1410  combat_ILGSA24-17873  9699ISMM          Y  ...  180200.0  270469  0.020040

[1411 rows x 10 columns]

## calculate heterozygosity rate ##

## plot missingness against heterozygosity rate like in page 6 of Ritchies review ##

## see the number of samples above the mean heterozigosity +- 3 standard deviations ##
                       FID       IID MISS_PHENO  ...   N(NM)        F  hetero_rate
60    combat_ILGSA24-17303  2398BCJA          Y  ...  270479 -0.06429     0.355007
131   combat_ILGSA24-17303  6798CJOS          Y  ...  270469 -0.06685     0.355863
433   combat_ILGSA24-17873  2298JVJJ          Y  ...  270465 -0.06323     0.354652
663   combat_ILGSA24-17873  4400JWSA          Y  ...  270490 -0.06336     0.354708
670   combat_ILGSA24-17873  4498WVJA          Y  ...  270474 -0.06750     0.356086
817   combat_ILGSA24-17873  6400NWAA          Y  ...  270365 -0.09058     0.363801
835   combat_ILGSA24-17873  6498KMAA          Y  ...  270489 -0.06741     0.356048
855   combat_ILGSA24-17873  6596WDDA          Y  ...  270437 -0.06615     0.355636
896   combat_ILGSA24-17873  6701ESJS          Y  ...  270409 -0.06344     0.354726
941   combat_ILGSA24-17873  7000CSAS          Y  ...  270496 -0.06379     0.354844
1026  combat_ILGSA24-17873  7299JDJS          Y  ...  270493 -0.06298     0.354575
1087  combat_ILGSA24-17873  7499HLJO          Y  ...  270494 -0.06671     0.355816
1110  combat_ILGSA24-17873  7596JGOO          Y  ...  270465 -0.09124     0.363992

[13 rows x 11 columns]
13
the 97.5% percentile of the heterozigosity for samples above the heterozygosity upper limit correspond with the following percentage with respect to that limit
2.7097175003310383

## see the number of samples below the mean heterozigosity +- 3 standard deviations ##
                       FID       IID MISS_PHENO  ...   N(NM)        F  hetero_rate
18    combat_ILGSA24-17303  0290JKSM          Y  ...  270512  0.11170     0.296297
84    combat_ILGSA24-17303  3496GPOJ          Y  ...  270476  0.16690     0.277899
101   combat_ILGSA24-17303  4494JLJA          Y  ...  270498  0.09820     0.300808
152   combat_ILGSA24-17303  7600HPDO          Y  ...  270483  0.09096     0.303232
224   combat_ILGSA24-17873  0197AMDM          Y  ...  270425  0.11560     0.295006
250   combat_ILGSA24-17873  0300JVSJ          Y  ...  270491  0.13370     0.288963
315   combat_ILGSA24-17873  1270VNJM          Y  ...  270341  0.10460     0.298697
343   combat_ILGSA24-17873  1301JMMM          Y  ...  270469  0.10810     0.297491
399   combat_ILGSA24-17873  2197GAMJ          Y  ...  270317  0.08943     0.303747
424   combat_ILGSA24-17873  2286SIFJ          Y  ...  270482  0.11790     0.294241
442   combat_ILGSA24-17873  2300EBJA          Y  ...  270428  0.13190     0.289563
443   combat_ILGSA24-17873  2300EKNA          Y  ...  270100  0.15170     0.282991
482   combat_ILGSA24-17873  2499BLAA          Y  ...  270478  0.11500     0.295211
486   combat_ILGSA24-17873  2499MLAA          Y  ...  270439  0.08942     0.303747
493   combat_ILGSA24-17873  3300JKAM          Y  ...  270467  0.08401     0.305546
516   combat_ILGSA24-17873  3399DAAM          Y  ...  270463  0.11070     0.296628
596   combat_ILGSA24-17873  3584JLSM          Y  ...  270512  0.11940     0.293739
639   combat_ILGSA24-17873  4178GFSA          Y  ...  270473  0.12760     0.290994
646   combat_ILGSA24-17873  4193DTNJ          Y  ...  270494  0.09904     0.300532
678   combat_ILGSA24-17873  4580YZMA          Y  ...  270476  0.10490     0.298592
697   combat_ILGSA24-17873  5900JKAJ          Y  ...  270437  0.11230     0.296095
822   combat_ILGSA24-17873  6401FHMJ          Y  ...  270519  0.20260     0.265978
826   combat_ILGSA24-17873  6488JTSA          Y  ...  270383  0.08693     0.304572
847   combat_ILGSA24-17873  6580JCFA          Y  ...  270510  0.09311     0.302503
900   combat_ILGSA24-17873  6791JGFS          Y  ...  270358  0.09864     0.300657
934   combat_ILGSA24-17873  6995RCFS          Y  ...  270454  0.10800     0.297552
953   combat_ILGSA24-17873  7094PPDS          Y  ...  270387  0.08531     0.305118
978   combat_ILGSA24-17873  7184DXMS          Y  ...  270400  0.10720     0.297814
979   combat_ILGSA24-17873  7185SNJS          Y  ...  270158  0.11810     0.294209
1006  combat_ILGSA24-17873  7282JTFS          Y  ...  270442  0.10940     0.297073
1029  combat_ILGSA24-17873  7300EHFO          Y  ...  270199  0.09518     0.301844
1058  combat_ILGSA24-17873  7400AGAJ          Y  ...  270208  0.15770     0.280987
1071  combat_ILGSA24-17873  7485PNOO          Y  ...  270242  0.09394     0.302255
1077  combat_ILGSA24-17873  7495SYNO          Y  ...  270449  0.11620     0.294813
1082  combat_ILGSA24-17873  7497SSFJ          Y  ...  270300  0.14130     0.286448
1086  combat_ILGSA24-17873  7498YQOO          Y  ...  270485  0.10410     0.298845
1095  combat_ILGSA24-17873  7501KBFO          Y  ...  269965  0.11190     0.296253
1242  combat_ILGSA24-17873  8145TNJJ          Y  ...  270301  0.09402     0.302208
1257  combat_ILGSA24-17873  8244TCOJ          Y  ...  270460  0.11120     0.296491
1258  combat_ILGSA24-17873  8244VCMJ          Y  ...  270502  0.11580     0.294937
1334  combat_ILGSA24-17873  8698WTFJ          Y  ...  270434  0.08958     0.303675
1354  combat_ILGSA24-17873  8778DAAF          Y  ...  270480  0.10210     0.299497

[42 rows x 11 columns]
42
the 2.5% percentile of the heterozigosity for samples below the heterozygosity lower limit correspond with the following percentage with respect to that limit
9.04120953066138

###### start pop stratificaction analyses to detect individuals that are outliers ######

## start with pca ##

# open folder #
total 60
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 00_snp_duplicates
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 01_chromosome_filtering
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 02_remove_non_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 03_remove_pos_dups
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 04_remove_low_maf_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 05_remove_missing_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 06_first_hwe_filter
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 07_par_problem_cleanup
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 08_remove_low_call_samples
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 09_remove_high_LogRDev_samples
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 10_remove_low_maf_snps
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 11_remove_related_samples
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 12_loop_maf_missing
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 13_visual_hetero
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 14_pop_strat


# Filter out snps for the PCA #
PLINK v2.00a4.2LM 64-bit Intel (31 May 2023)   www.cog-genomics.org/plink/2.0/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./14_pop_strat/01_pca/ldpruned_pca.log.
Options in effect:
  --bfile ./12_loop_maf_missing/loop_maf_missing_2
  --indep-pairwise 500kb 1 0.2
  --out ./14_pop_strat/01_pca/ldpruned_pca

Start time: Fri Dec 20 21:40:30 2024
63997 MiB RAM detected, ~56335 available; reserving 31998 MiB for main
workspace.
Using up to 32 threads (change this with --threads).
1411 samples (190 females, 1179 males, 42 ambiguous; 1411 founders) loaded from
./12_loop_maf_missing/loop_maf_missing_2.fam.
288384 variants loaded from ./12_loop_maf_missing/loop_maf_missing_2.bim.
Note: No phenotype data present.
Calculating allele frequencies... 0%22%45%68%90%done.
--indep-pairwise (26 compute threads): 0%50%189906/288384 variants removed.
Writing...
Variant lists written to ./14_pop_strat/01_pca/ldpruned_pca.prune.in and
./14_pop_strat/01_pca/ldpruned_pca.prune.out .
End time: Fri Dec 20 21:40:31 2024
total 3152
-rw-rw-r-- 1 dftortosa dftortosa    1113 Dec 20 21:40 ldpruned_pca.log
-rw-rw-r-- 1 dftortosa dftortosa 1097193 Dec 20 21:40 ldpruned_pca.prune.in
-rw-rw-r-- 1 dftortosa dftortosa 2121787 Dec 20 21:40 ldpruned_pca.prune.out

PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./14_pop_strat/01_pca/loop_maf_missing_2_ldprunned_autosome_pca.log.
Options in effect:
  --autosome
  --bfile ./12_loop_maf_missing/loop_maf_missing_2
  --extract ./14_pop_strat/01_pca/ldpruned_pca.prune.in
  --make-bed
  --out ./14_pop_strat/01_pca/loop_maf_missing_2_ldprunned_autosome_pca

63997 MB RAM detected; reserving 31998 MB for main workspace.
270054 out of 288384 variants loaded from .bim file.
1411 people (1179 males, 190 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./14_pop_strat/01_pca/loop_maf_missing_2_ldprunned_autosome_pca.nosex .
--extract: 94854 variants remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1411 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.999576.
94854 variants and 1411 people pass filters and QC.
Note: No phenotypes present.
--make-bed to
./14_pop_strat/01_pca/loop_maf_missing_2_ldprunned_autosome_pca.bed +
./14_pop_strat/01_pca/loop_maf_missing_2_ldprunned_autosome_pca.bim +
./14_pop_strat/01_pca/loop_maf_missing_2_ldprunned_autosome_pca.fam ... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
total 237140
-rw-rw-r-- 1 dftortosa dftortosa 142084096 Dec 20 21:40 ibd_report.genome
-rw-rw-r-- 1 dftortosa dftortosa      1158 Dec 20 21:40 ibd_report.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 ibd_report.nosex
-rw-rw-r-- 1 dftortosa dftortosa  21264041 Dec 20 21:40 ibd_report_awk_processed.genome.tsv.gz
drwxrwxr-x 2 dftortosa dftortosa      4096 Dec 20 21:40 king_analyses
-rw-rw-r-- 1 dftortosa dftortosa      1227 Dec 20 21:40 ldpruned_snplist.log
-rw-rw-r-- 1 dftortosa dftortosa   1102610 Dec 20 21:40 ldpruned_snplist.prune.in
-rw-rw-r-- 1 dftortosa dftortosa   2126515 Dec 20 21:40 ldpruned_snplist.prune.out
-rw-rw-r-- 1 dftortosa dftortosa  35793839 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.bed
-rw-rw-r-- 1 dftortosa dftortosa   2849592 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.bim
-rw-rw-r-- 1 dftortosa dftortosa     56394 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.fam
-rw-rw-r-- 1 dftortosa dftortosa    185662 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.hh
-rw-rw-r-- 1 dftortosa dftortosa      1804 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned.nosex
-rw-rw-r-- 1 dftortosa dftortosa  34477245 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.bed
-rw-rw-r-- 1 dftortosa dftortosa   2742773 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.bim
-rw-rw-r-- 1 dftortosa dftortosa     56394 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.fam
-rw-rw-r-- 1 dftortosa dftortosa      1388 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.log
-rw-rw-r-- 1 dftortosa dftortosa      1260 Dec 20 21:40 merged_batches_hwe_par_callrate_LogRDev_maf_ld_prunned_autosomals.nosex
-rw-rw-r-- 1 dftortosa dftortosa     16404 Dec 20 21:40 pairs_relatdness_before_filtering.png
-rw-rw-r-- 1 dftortosa dftortosa     10391 Dec 20 21:40 pi_hat_hist.png


# checks after filtering #
The number of included autosomal SNPs in linkage equilibrium is 94854
Is this number greater than 93K?
TRUE

All non-autosomals SNPs have been removed from the LD pruned dataset?
TRUE


## run PCA to detect clusters of samples ##

# make the run #
PLINK v2.00a4.2LM 64-bit Intel (31 May 2023)   www.cog-genomics.org/plink/2.0/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./pca_results.log.
Options in effect:
  --bfile ./loop_maf_missing_2_ldprunned_autosome_pca
  --out ./pca_results
  --pca 20

Start time: Fri Dec 20 21:40:31 2024
63997 MiB RAM detected, ~56321 available; reserving 31998 MiB for main
workspace.
Using up to 32 threads (change this with --threads).
1411 samples (190 females, 1179 males, 42 ambiguous; 1411 founders) loaded from
./loop_maf_missing_2_ldprunned_autosome_pca.fam.
94854 variants loaded from ./loop_maf_missing_2_ldprunned_autosome_pca.bim.
Note: No phenotype data present.
Calculating allele frequencies... 0%69%done.
Constructing GRM: 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
Correcting for missingness... 0%0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
Extracting eigenvalues and eigenvectors... done.
--pca: Eigenvectors written to ./pca_results.eigenvec , and eigenvalues written
to ./pca_results.eigenval .
End time: Fri Dec 20 21:40:34 2024


# load the eigenvec file generated #

# batch effects #
plot the PCA values between batches
check the distribution of the PCs between batches as it should be similar (MannWhitney U test assumption)
make MannWhitney U test for the difference of PC values between batches
      PC  U_statistic         P
0    PC1     130563.5  0.362201
1    PC2     126555.0  0.861941
2    PC3     130229.5  0.395466
3    PC4     129132.0  0.517058
4    PC5     131177.0  0.305826
5    PC6     129374.0  0.488688
6    PC7     125763.0  0.977476
7    PC8     123163.0  0.652858
8    PC9     131388.0  0.287860
9   PC10     123217.0  0.660036
10  PC11     127491.0  0.729297
11  PC12     125745.0  0.980117
12  PC13     124268.5  0.805323
13  PC14     119314.0  0.246972
14  PC15     120860.0  0.382455
15  PC16     124505.0  0.839163
16  PC17     125422.0  0.972636
17  PC18     126777.5  0.829901
18  PC19     121799.0  0.483507
19  PC20     120211.0  0.320831
The wilcoxon test for all the PCs between batches are non-significant. Therefore, we accept the null hypothesis: for randomly selected PC values X and Y from two batches, the probability of X being greater than Y is equal to the probability of Y being greater than X (see code for details)

# select PCs based on explianed variance #
load eigenvalues
            0
P1   28.38150
P2    4.66385
P3    3.77269
P4    2.62852
P5    1.77456
P6    1.72521
P7    1.48682
P8    1.41978
P9    1.34738
P10   1.32275
P11   1.31634
P12   1.30826
P13   1.29845
P14   1.29706
P15   1.29431
P16   1.29357
P17   1.29223
P18   1.28955
P19   1.28896
P20   1.28764
calculate the proportion of explained variance
make de scree plot
see the first PC where cumulative explianed variability reaches 80% of the total
The first PC where cumulative explianed variability reaches 76% of the total is P9 with 0.77 of the total

# PCA with smartpca #
prepare fam file for smartpca

decide the number of axes to output
smartpca parameter file

run smartpca

see significant axes

        #N  eigenvalue  difference   twstat        p-value    effect.
0        1    1.736592         NaN  299.687   0.000000e+00  62622.856
1        2    1.434235   -0.302357   95.522  2.259090e-272  63859.799
2        3    1.309386   -0.124849    9.637   1.745890e-10  64218.030
3        4    1.301056   -0.008330    4.351   1.018080e-04  64342.445
4        5    1.299520   -0.001536    3.786   3.482450e-04  64455.381
...    ...         ...         ...      ...            ...        ...
1234  1235    0.753018   -0.001094      NaN            NaN        NaN
1235  1236    0.750886   -0.002132      NaN            NaN        NaN
1236  1237    0.749245   -0.001641      NaN            NaN        NaN
1237  1238    0.747905   -0.001340      NaN            NaN        NaN
1238  1239    0.746556   -0.001349      NaN            NaN        NaN

[1239 rows x 6 columns]
   #N  eigenvalue  difference   twstat        p-value    effect.
0   1    1.736592         NaN  299.687   0.000000e+00  62622.856
1   2    1.434235   -0.302357   95.522  2.259090e-272  63859.799
2   3    1.309386   -0.124849    9.637   1.745890e-10  64218.030
3   4    1.301056   -0.008330    4.351   1.018080e-04  64342.445
4   5    1.299520   -0.001536    3.786   3.482450e-04  64455.381
5   6    1.295997   -0.003523    1.821   1.398100e-02  64567.361
We have 6 significant axes
plot smartpca eigenvectors

                                 0       1       2   ...      18      19      20
0     combat_ILGSA24-17303:0200ADMM  0.0040 -0.0114  ... -0.0074  0.0085 -0.0052
1     combat_ILGSA24-17303:0200ASJM -0.0704 -0.0905  ... -0.0111 -0.0227  0.0105
2     combat_ILGSA24-17303:0200BHNM  0.0181 -0.0021  ...  0.0259 -0.0016  0.0347
3     combat_ILGSA24-17303:0200CBOM  0.0188  0.0180  ... -0.0042 -0.0221  0.0230
4     combat_ILGSA24-17303:0200CDFM -0.0192  0.0154  ... -0.0293  0.0134 -0.0019
...                             ...     ...     ...  ...     ...     ...     ...
1235  combat_ILGSA24-17873:9693JMNM  0.0047 -0.0226  ...  0.0191  0.0222  0.0011
1236  combat_ILGSA24-17873:9696DWFM  0.0117  0.0112  ...  0.0108 -0.0180 -0.0549
1237  combat_ILGSA24-17873:9697STJM  0.0218 -0.0033  ...  0.0227  0.0008 -0.0030
1238  combat_ILGSA24-17873:9699DNOM -0.0612  0.0506  ... -0.0042 -0.0549 -0.0219
1239  combat_ILGSA24-17873:9699ISMM  0.0043  0.0168  ... -0.0126  0.0074 -0.0130

[1240 rows x 21 columns]
plot the explained variance using eigenvalues
             0
0     1.736592
1     1.434235
2     1.309386
3     1.301056
4     1.299520
...        ...
1235  0.750886
1236  0.749245
1237  0.747905
1238  0.746556
1239  0.000000

[1240 rows x 1 columns]
      eigenvalue  prop_variance
0       1.736592       0.001402
1       1.434235       0.001158
2       1.309386       0.001057
3       1.301056       0.001050
4       1.299520       0.001049
...          ...            ...
1235    0.750886       0.000606
1236    0.749245       0.000605
1237    0.747905       0.000604
1238    0.746556       0.000603
1239    0.000000       0.000000

[1240 rows x 2 columns]
    eigenvalue  prop_variance
0     1.736592       0.001402
1     1.434235       0.001158
2     1.309386       0.001057
3     1.301056       0.001050
4     1.299520       0.001049
5     1.295997       0.001046
6     1.292581       0.001043
7     1.290302       0.001041
8     1.289566       0.001041
9     1.288336       0.001040
10    1.285712       0.001038
11    1.284820       0.001037
12    1.282916       0.001035
13    1.281467       0.001034
14    1.280954       0.001034
15    1.279859       0.001033
16    1.277845       0.001031
17    1.277278       0.001031
18    1.275699       0.001030
19    1.273906       0.001028
plot SNP weights

             rs_number  chr       pos  pca_1  ...  pca_17  pca_18  pca_19  pca_20
0            rs3131972    1    817341 -0.062  ...   0.206   0.565   0.808  -0.165
1           rs12127425    1    858952  0.530  ...  -2.062  -0.103  -0.301  -0.036
2           rs13302982    1    926428 -3.509  ...  -1.325   1.754   1.298  -0.459
3            rs2880024    1    931513 -0.505  ...   0.551   1.017   1.253  -1.298
4           exm2264981    1    959193 -0.548  ...  -0.965  -0.567   0.816  -0.116
...                ...  ...       ...    ...  ...     ...     ...     ...     ...
94849  GSA-rs142356721   22  50707318  1.442  ...   0.999   0.399   0.748   0.629
94850    GSA-rs6010063   22  50718505  0.720  ...   0.581  -1.508   0.818   0.226
94851       exm2268446   22  50743331 -1.188  ...   1.168  -1.662  -0.527   0.343
94852    GSA-rs8135434   22  50747848 -1.453  ...   0.478  -1.261  -1.244  -0.850
94853      rs113391741   22  50749012  0.270  ...   0.677  -0.900   1.391   0.425

[94854 rows x 23 columns]
               rs_number  chr       pos pca_axis  snp_weight
0              rs3131972    1    817341    pca_1      -0.062
1             rs12127425    1    858952    pca_1       0.530
2             rs13302982    1    926428    pca_1      -3.509
3              rs2880024    1    931513    pca_1      -0.505
4             exm2264981    1    959193    pca_1      -0.548
...                  ...  ...       ...      ...         ...
1897075  GSA-rs142356721   22  50707318   pca_20       0.629
1897076    GSA-rs6010063   22  50718505   pca_20       0.226
1897077       exm2268446   22  50743331   pca_20       0.343
1897078    GSA-rs8135434   22  50747848   pca_20      -0.850
1897079      rs113391741   22  50749012   pca_20       0.425

[1897080 rows x 5 columns]
Remove outliers
          0        1                              2   ...      8     9        10
0    REMOVED  outlier  combat_ILGSA24-17303:0202ABAM  ...  -6.978  pop:  Control
1    REMOVED  outlier  combat_ILGSA24-17303:3486DWMJ  ...  -7.206  pop:  Control
2    REMOVED  outlier  combat_ILGSA24-17303:3496GPOJ  ... -10.031  pop:  Control
3    REMOVED  outlier  combat_ILGSA24-17303:4486MKDA  ...  -6.229  pop:  Control
4    REMOVED  outlier  combat_ILGSA24-17303:7783JNMO  ... -12.719  pop:  Control
..       ...      ...                            ...  ...     ...   ...      ...
166  REMOVED  outlier  combat_ILGSA24-17873:8097KWNN  ...  -6.234  pop:  Control
167  REMOVED  outlier  combat_ILGSA24-17873:0398JCMJ  ...  -6.775  pop:  Control
168  REMOVED  outlier  combat_ILGSA24-17873:8692HROJ  ...  -6.758  pop:  Control
169  REMOVED  outlier  combat_ILGSA24-17303:0299JCJM  ...  -6.067  pop:  Control
170  REMOVED  outlier  combat_ILGSA24-17873:8244JGSJ  ...   6.404  pop:  Control

[171 rows x 11 columns]
We have removed 171 samples because they were PCA outliers
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./loop_maf_missing_2_ldprunned_autosome_pca_not_outliers.log.
Options in effect:
  --bfile ./loop_maf_missing_2_ldprunned_autosome_pca
  --make-bed
  --out ./loop_maf_missing_2_ldprunned_autosome_pca_not_outliers
  --remove ./eigen_out/smartpca_outliers.txt

63997 MB RAM detected; reserving 31998 MB for main workspace.
94854 variants loaded from .bim file.
1411 people (1179 males, 190 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./loop_maf_missing_2_ldprunned_autosome_pca_not_outliers.nosex .
--remove: 1240 people remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1240 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate in remaining samples is 0.999591.
94854 variants and 1240 people pass filters and QC.
Note: No phenotypes present.
--make-bed to ./loop_maf_missing_2_ldprunned_autosome_pca_not_outliers.bed +
./loop_maf_missing_2_ldprunned_autosome_pca_not_outliers.bim +
./loop_maf_missing_2_ldprunned_autosome_pca_not_outliers.fam ... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.

PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./14_pop_strat/03_ancestry_cleaned_plink/loop_maf_missing_2_pca_not_outliers.log.
Options in effect:
  --bfile ./12_loop_maf_missing/loop_maf_missing_2
  --make-bed
  --out ./14_pop_strat/03_ancestry_cleaned_plink/loop_maf_missing_2_pca_not_outliers
  --remove ./14_pop_strat/01_pca/eigen_out/smartpca_outliers.txt

63997 MB RAM detected; reserving 31998 MB for main workspace.
288384 variants loaded from .bim file.
1411 people (1179 males, 190 females, 42 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./14_pop_strat/03_ancestry_cleaned_plink/loop_maf_missing_2_pca_not_outliers.nosex
.
--remove: 1240 people remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1240 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate in remaining samples is 0.999546.
288384 variants and 1240 people pass filters and QC.
Note: No phenotypes present.
--make-bed to
./14_pop_strat/03_ancestry_cleaned_plink/loop_maf_missing_2_pca_not_outliers.bed
+
./14_pop_strat/03_ancestry_cleaned_plink/loop_maf_missing_2_pca_not_outliers.bim
+
./14_pop_strat/03_ancestry_cleaned_plink/loop_maf_missing_2_pca_not_outliers.fam
... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.

Warning: 19236 het. haploid genotypes present (see
./14_pop_strat/03_ancestry_cleaned_plink/loop_maf_missing_2_pca_not_outliers.hh
); many commands treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


# Ancestry analysis following Admixture tutorial #
general info
run admixture

****                   ADMIXTURE Version 1.3.0                  ****
****                    Copyright 2008-2015                     ****
****           David Alexander, Suyash Shringarpure,            ****
****                John  Novembre, Ken Lange                   ****
****                                                            ****
****                 Please cite our paper!                     ****
****   Information at www.genetics.ucla.edu/software/admixture  ****

Cross-validation will be performed.  Folds=5.
Parallel execution requested.  Will use 28 threads.
Random seed: 854534
Point estimation method: Block relaxation algorithm
Convergence acceleration algorithm: QuasiNewton, 3 secant conditions
Point estimation will terminate when objective function delta < 0.0001
Estimation of standard errors disabled; will compute point estimates only.
Size of G: 1240x94854
Performing five EM steps to prime main algorithm
1 (EM) 	Elapsed: 0.663	Loglikelihood: -1.17734e+08	(delta): 1.17653e+08
2 (EM) 	Elapsed: 0.667	Loglikelihood: -1.17734e+08	(delta): -4.47035e-08
3 (EM) 	Elapsed: 0.673	Loglikelihood: -1.17734e+08	(delta): 2.98023e-08
4 (EM) 	Elapsed: 0.679	Loglikelihood: -1.17734e+08	(delta): 2.98023e-08
5 (EM) 	Elapsed: 0.666	Loglikelihood: -1.17734e+08	(delta): -2.98023e-08
Initial loglikelihood: -1.17734e+08
Starting main algorithm
1 (QN/Block) 	Elapsed: 4.262	Loglikelihood: -1.17734e+08	(delta): 1.49012e-08
Summary: 
Converged in 1 iterations (8.041 sec)
Loglikelihood: -117734169.686136
CV error (K=1): 0.54222
Writing output files.
****                   ADMIXTURE Version 1.3.0                  ****
****                    Copyright 2008-2015                     ****
****           David Alexander, Suyash Shringarpure,            ****
****                John  Novembre, Ken Lange                   ****
****                                                            ****
****                 Please cite our paper!                     ****
****   Information at www.genetics.ucla.edu/software/admixture  ****

Cross-validation will be performed.  Folds=5.
Parallel execution requested.  Will use 28 threads.
Random seed: 854534
Point estimation method: Block relaxation algorithm
Convergence acceleration algorithm: QuasiNewton, 3 secant conditions
Point estimation will terminate when objective function delta < 0.0001
Estimation of standard errors disabled; will compute point estimates only.
Size of G: 1240x94854
Performing five EM steps to prime main algorithm
1 (EM) 	Elapsed: 2.862	Loglikelihood: -1.22761e+08	(delta): 7.81824e+07
2 (EM) 	Elapsed: 2.851	Loglikelihood: -1.19564e+08	(delta): 3.19738e+06
3 (EM) 	Elapsed: 2.97	Loglikelihood: -1.18653e+08	(delta): 911307
4 (EM) 	Elapsed: 3.038	Loglikelihood: -1.18201e+08	(delta): 452051
5 (EM) 	Elapsed: 3.008	Loglikelihood: -1.1796e+08	(delta): 240957
Initial loglikelihood: -1.1796e+08
Starting main algorithm
1 (QN/Block) 	Elapsed: 12.645	Loglikelihood: -1.17683e+08	(delta): 276572
2 (QN/Block) 	Elapsed: 12.371	Loglikelihood: -1.17678e+08	(delta): 4990.9
3 (QN/Block) 	Elapsed: 12.91	Loglikelihood: -1.17672e+08	(delta): 5953.9
4 (QN/Block) 	Elapsed: 13.011	Loglikelihood: -1.17664e+08	(delta): 7906.13
5 (QN/Block) 	Elapsed: 12.786	Loglikelihood: -1.17659e+08	(delta): 4892.16
6 (QN/Block) 	Elapsed: 12.356	Loglikelihood: -1.17655e+08	(delta): 4012.01
7 (QN/Block) 	Elapsed: 12.449	Loglikelihood: -1.17655e+08	(delta): 858.325
8 (QN/Block) 	Elapsed: 12.789	Loglikelihood: -1.17654e+08	(delta): 138.945
9 (QN/Block) 	Elapsed: 13.047	Loglikelihood: -1.17654e+08	(delta): 99.2994
10 (QN/Block) 	Elapsed: 12.86	Loglikelihood: -1.17654e+08	(delta): 16.0481
11 (QN/Block) 	Elapsed: 12.858	Loglikelihood: -1.17654e+08	(delta): 7.2604
12 (QN/Block) 	Elapsed: 13.106	Loglikelihood: -1.17654e+08	(delta): 26.5194
13 (QN/Block) 	Elapsed: 13.017	Loglikelihood: -1.17654e+08	(delta): 3.3819
14 (QN/Block) 	Elapsed: 12.75	Loglikelihood: -1.17654e+08	(delta): 5.55303
15 (QN/Block) 	Elapsed: 12.623	Loglikelihood: -1.17654e+08	(delta): 21.0728
16 (QN/Block) 	Elapsed: 12.414	Loglikelihood: -1.17654e+08	(delta): 22.654
17 (QN/Block) 	Elapsed: 12.717	Loglikelihood: -1.17654e+08	(delta): 8.46272
18 (QN/Block) 	Elapsed: 12.807	Loglikelihood: -1.17654e+08	(delta): 2.39005
19 (QN/Block) 	Elapsed: 12.601	Loglikelihood: -1.17654e+08	(delta): 17.7488
20 (QN/Block) 	Elapsed: 12.845	Loglikelihood: -1.17654e+08	(delta): 1.76693
21 (QN/Block) 	Elapsed: 12.7	Loglikelihood: -1.17654e+08	(delta): 24.979
22 (QN/Block) 	Elapsed: 12.607	Loglikelihood: -1.17654e+08	(delta): 6.99327
23 (QN/Block) 	Elapsed: 12.913	Loglikelihood: -1.17654e+08	(delta): 1.90519
24 (QN/Block) 	Elapsed: 12.681	Loglikelihood: -1.17654e+08	(delta): 0.936305
25 (QN/Block) 	Elapsed: 13.209	Loglikelihood: -1.17654e+08	(delta): 6.01528
26 (QN/Block) 	Elapsed: 13.101	Loglikelihood: -1.17654e+08	(delta): 8.47386
27 (QN/Block) 	Elapsed: 12.71	Loglikelihood: -1.17654e+08	(delta): 2.95618
28 (QN/Block) 	Elapsed: 12.774	Loglikelihood: -1.17654e+08	(delta): 1.17135
29 (QN/Block) 	Elapsed: 12.096	Loglikelihood: -1.17654e+08	(delta): 1.87179
30 (QN/Block) 	Elapsed: 12.803	Loglikelihood: -1.17654e+08	(delta): 1.06456
31 (QN/Block) 	Elapsed: 12.422	Loglikelihood: -1.17654e+08	(delta): 0.957428
32 (QN/Block) 	Elapsed: 12.751	Loglikelihood: -1.17654e+08	(delta): 1.97668
33 (QN/Block) 	Elapsed: 12.971	Loglikelihood: -1.17654e+08	(delta): 0.847554
34 (QN/Block) 	Elapsed: 12.28	Loglikelihood: -1.17654e+08	(delta): 0.59937
35 (QN/Block) 	Elapsed: 12.691	Loglikelihood: -1.17654e+08	(delta): 0.575743
36 (QN/Block) 	Elapsed: 12.38	Loglikelihood: -1.17654e+08	(delta): 2.08628
37 (QN/Block) 	Elapsed: 12.374	Loglikelihood: -1.17654e+08	(delta): 1.57544
38 (QN/Block) 	Elapsed: 13.05	Loglikelihood: -1.17654e+08	(delta): 0.499395
39 (QN/Block) 	Elapsed: 13.179	Loglikelihood: -1.17654e+08	(delta): 0.570526
40 (QN/Block) 	Elapsed: 13.306	Loglikelihood: -1.17654e+08	(delta): 0.986123
41 (QN/Block) 	Elapsed: 12.63	Loglikelihood: -1.17654e+08	(delta): 7.03416
42 (QN/Block) 	Elapsed: 13.115	Loglikelihood: -1.17654e+08	(delta): 2.23771
43 (QN/Block) 	Elapsed: 12.7	Loglikelihood: -1.17654e+08	(delta): 0.395588
44 (QN/Block) 	Elapsed: 12.665	Loglikelihood: -1.17654e+08	(delta): 0.218482
45 (QN/Block) 	Elapsed: 13.136	Loglikelihood: -1.17654e+08	(delta): 0.502994
46 (QN/Block) 	Elapsed: 12.716	Loglikelihood: -1.17654e+08	(delta): 0.282591
47 (QN/Block) 	Elapsed: 13.232	Loglikelihood: -1.17654e+08	(delta): 0.235275
48 (QN/Block) 	Elapsed: 12.867	Loglikelihood: -1.17654e+08	(delta): 0.148392
49 (QN/Block) 	Elapsed: 12.406	Loglikelihood: -1.17654e+08	(delta): 0.683213
50 (QN/Block) 	Elapsed: 12.479	Loglikelihood: -1.17654e+08	(delta): 0.310636
51 (QN/Block) 	Elapsed: 12.776	Loglikelihood: -1.17654e+08	(delta): 1.08027
52 (QN/Block) 	Elapsed: 13.186	Loglikelihood: -1.17654e+08	(delta): 0.121596
53 (QN/Block) 	Elapsed: 12.609	Loglikelihood: -1.17654e+08	(delta): 0.194595
54 (QN/Block) 	Elapsed: 12.744	Loglikelihood: -1.17654e+08	(delta): 0.197456
55 (QN/Block) 	Elapsed: 12.817	Loglikelihood: -1.17654e+08	(delta): 2.26101
56 (QN/Block) 	Elapsed: 12.73	Loglikelihood: -1.17654e+08	(delta): 0.386088
57 (QN/Block) 	Elapsed: 12.258	Loglikelihood: -1.17654e+08	(delta): 0.0610358
58 (QN/Block) 	Elapsed: 13.119	Loglikelihood: -1.17654e+08	(delta): 0.0327248
59 (QN/Block) 	Elapsed: 12.504	Loglikelihood: -1.17654e+08	(delta): 0.436362
60 (QN/Block) 	Elapsed: 12.733	Loglikelihood: -1.17654e+08	(delta): 0.0307638
61 (QN/Block) 	Elapsed: 12.857	Loglikelihood: -1.17654e+08	(delta): 0.152451
62 (QN/Block) 	Elapsed: 13.198	Loglikelihood: -1.17654e+08	(delta): 0.042282
63 (QN/Block) 	Elapsed: 12.907	Loglikelihood: -1.17654e+08	(delta): 0.102363
64 (QN/Block) 	Elapsed: 12.607	Loglikelihood: -1.17654e+08	(delta): 0.112534
65 (QN/Block) 	Elapsed: 12.538	Loglikelihood: -1.17654e+08	(delta): 0.0973367
66 (QN/Block) 	Elapsed: 13.03	Loglikelihood: -1.17654e+08	(delta): 0.0316627
67 (QN/Block) 	Elapsed: 12.935	Loglikelihood: -1.17654e+08	(delta): 0.0652506
68 (QN/Block) 	Elapsed: 12.733	Loglikelihood: -1.17654e+08	(delta): 0.313548
69 (QN/Block) 	Elapsed: 12.935	Loglikelihood: -1.17654e+08	(delta): 0.177242
70 (QN/Block) 	Elapsed: 12.761	Loglikelihood: -1.17654e+08	(delta): 0.0273452
71 (QN/Block) 	Elapsed: 12.366	Loglikelihood: -1.17654e+08	(delta): 0.0323546
72 (QN/Block) 	Elapsed: 12.55	Loglikelihood: -1.17654e+08	(delta): 0.160642
73 (QN/Block) 	Elapsed: 12.981	Loglikelihood: -1.17654e+08	(delta): 0.235272
74 (QN/Block) 	Elapsed: 12.388	Loglikelihood: -1.17654e+08	(delta): 0.0312501
75 (QN/Block) 	Elapsed: 13.147	Loglikelihood: -1.17654e+08	(delta): 0.0165736
76 (QN/Block) 	Elapsed: 12.647	Loglikelihood: -1.17654e+08	(delta): 0.133654
77 (QN/Block) 	Elapsed: 12.428	Loglikelihood: -1.17654e+08	(delta): 0.753111
78 (QN/Block) 	Elapsed: 12.662	Loglikelihood: -1.17654e+08	(delta): 0.256723
79 (QN/Block) 	Elapsed: 12.702	Loglikelihood: -1.17654e+08	(delta): 0.0431
80 (QN/Block) 	Elapsed: 12.649	Loglikelihood: -1.17654e+08	(delta): 0.0232431
81 (QN/Block) 	Elapsed: 12.66	Loglikelihood: -1.17654e+08	(delta): 0.057874
82 (QN/Block) 	Elapsed: 13.161	Loglikelihood: -1.17654e+08	(delta): 0.00700808
83 (QN/Block) 	Elapsed: 12.731	Loglikelihood: -1.17654e+08	(delta): 0.016964
84 (QN/Block) 	Elapsed: 13.056	Loglikelihood: -1.17654e+08	(delta): 0.00658792
85 (QN/Block) 	Elapsed: 12.883	Loglikelihood: -1.17654e+08	(delta): 0.0363365
86 (QN/Block) 	Elapsed: 13.024	Loglikelihood: -1.17654e+08	(delta): 0.034282
87 (QN/Block) 	Elapsed: 12.79	Loglikelihood: -1.17654e+08	(delta): 0.00745405
88 (QN/Block) 	Elapsed: 12.895	Loglikelihood: -1.17654e+08	(delta): 0.0440299
89 (QN/Block) 	Elapsed: 13.004	Loglikelihood: -1.17654e+08	(delta): 0.0210696
90 (QN/Block) 	Elapsed: 12.957	Loglikelihood: -1.17654e+08	(delta): 0.00470297
91 (QN/Block) 	Elapsed: 13.025	Loglikelihood: -1.17654e+08	(delta): 0.00578566
92 (QN/Block) 	Elapsed: 12.873	Loglikelihood: -1.17654e+08	(delta): 0.0431222
93 (QN/Block) 	Elapsed: 12.734	Loglikelihood: -1.17654e+08	(delta): 0.0492708
94 (QN/Block) 	Elapsed: 12.756	Loglikelihood: -1.17654e+08	(delta): 0.00591964
95 (QN/Block) 	Elapsed: 12.647	Loglikelihood: -1.17654e+08	(delta): 0.00394098
96 (QN/Block) 	Elapsed: 12.71	Loglikelihood: -1.17654e+08	(delta): 0.0264297
97 (QN/Block) 	Elapsed: 12.379	Loglikelihood: -1.17654e+08	(delta): 0.0331479
98 (QN/Block) 	Elapsed: 12.397	Loglikelihood: -1.17654e+08	(delta): 0.00392483
99 (QN/Block) 	Elapsed: 12.687	Loglikelihood: -1.17654e+08	(delta): 0.00385608
100 (QN/Block) 	Elapsed: 12.556	Loglikelihood: -1.17654e+08	(delta): 0.0152575
101 (QN/Block) 	Elapsed: 12.856	Loglikelihood: -1.17654e+08	(delta): 0.0213964
102 (QN/Block) 	Elapsed: 12.918	Loglikelihood: -1.17654e+08	(delta): 0.00611694
103 (QN/Block) 	Elapsed: 12.509	Loglikelihood: -1.17654e+08	(delta): 0.00774744
104 (QN/Block) 	Elapsed: 12.567	Loglikelihood: -1.17654e+08	(delta): 0.0103104
105 (QN/Block) 	Elapsed: 12.646	Loglikelihood: -1.17654e+08	(delta): 0.00282019
106 (QN/Block) 	Elapsed: 12.785	Loglikelihood: -1.17654e+08	(delta): 0.00455779
107 (QN/Block) 	Elapsed: 12.764	Loglikelihood: -1.17654e+08	(delta): 0.00636145
108 (QN/Block) 	Elapsed: 12.662	Loglikelihood: -1.17654e+08	(delta): 0.00832781
109 (QN/Block) 	Elapsed: 12.748	Loglikelihood: -1.17654e+08	(delta): 0.00243956
110 (QN/Block) 	Elapsed: 12.406	Loglikelihood: -1.17654e+08	(delta): 0.00355206
111 (QN/Block) 	Elapsed: 12.671	Loglikelihood: -1.17654e+08	(delta): 0.00526327
112 (QN/Block) 	Elapsed: 12.979	Loglikelihood: -1.17654e+08	(delta): 0.00703512
113 (QN/Block) 	Elapsed: 12.737	Loglikelihood: -1.17654e+08	(delta): 0.00221992
114 (QN/Block) 	Elapsed: 12.516	Loglikelihood: -1.17654e+08	(delta): 0.00299713
115 (QN/Block) 	Elapsed: 12.657	Loglikelihood: -1.17654e+08	(delta): 0.00453757
116 (QN/Block) 	Elapsed: 12.77	Loglikelihood: -1.17654e+08	(delta): 0.00616451
117 (QN/Block) 	Elapsed: 12.467	Loglikelihood: -1.17654e+08	(delta): 0.00202431
118 (QN/Block) 	Elapsed: 12.421	Loglikelihood: -1.17654e+08	(delta): 0.00256142
119 (QN/Block) 	Elapsed: 12.312	Loglikelihood: -1.17654e+08	(delta): 0.00390963
120 (QN/Block) 	Elapsed: 12.548	Loglikelihood: -1.17654e+08	(delta): 0.00549507
121 (QN/Block) 	Elapsed: 12.59	Loglikelihood: -1.17654e+08	(delta): 0.00181305
122 (QN/Block) 	Elapsed: 12.382	Loglikelihood: -1.17654e+08	(delta): 0.00220487
123 (QN/Block) 	Elapsed: 12.879	Loglikelihood: -1.17654e+08	(delta): 0.00335455
124 (QN/Block) 	Elapsed: 12.83	Loglikelihood: -1.17654e+08	(delta): 0.00490847
125 (QN/Block) 	Elapsed: 12.634	Loglikelihood: -1.17654e+08	(delta): 0.001615
126 (QN/Block) 	Elapsed: 13.163	Loglikelihood: -1.17654e+08	(delta): 0.00190203
127 (QN/Block) 	Elapsed: 12.634	Loglikelihood: -1.17654e+08	(delta): 0.00289083
128 (QN/Block) 	Elapsed: 12.978	Loglikelihood: -1.17654e+08	(delta): 0.00436915
129 (QN/Block) 	Elapsed: 12.972	Loglikelihood: -1.17654e+08	(delta): 0.00143811
130 (QN/Block) 	Elapsed: 12.574	Loglikelihood: -1.17654e+08	(delta): 0.00164606
131 (QN/Block) 	Elapsed: 12.499	Loglikelihood: -1.17654e+08	(delta): 0.00248279
132 (QN/Block) 	Elapsed: 12.814	Loglikelihood: -1.17654e+08	(delta): 0.0039022
133 (QN/Block) 	Elapsed: 12.623	Loglikelihood: -1.17654e+08	(delta): 0.00127409
134 (QN/Block) 	Elapsed: 12.613	Loglikelihood: -1.17654e+08	(delta): 0.00143248
135 (QN/Block) 	Elapsed: 12.322	Loglikelihood: -1.17654e+08	(delta): 0.00211476
136 (QN/Block) 	Elapsed: 12.493	Loglikelihood: -1.17654e+08	(delta): 0.00349712
137 (QN/Block) 	Elapsed: 12.707	Loglikelihood: -1.17654e+08	(delta): 0.00112288
138 (QN/Block) 	Elapsed: 12.613	Loglikelihood: -1.17654e+08	(delta): 0.00124574
139 (QN/Block) 	Elapsed: 12.3	Loglikelihood: -1.17654e+08	(delta): 0.00179739
140 (QN/Block) 	Elapsed: 12.855	Loglikelihood: -1.17654e+08	(delta): 0.00312519
141 (QN/Block) 	Elapsed: 12.551	Loglikelihood: -1.17654e+08	(delta): 0.000989527
142 (QN/Block) 	Elapsed: 13.146	Loglikelihood: -1.17654e+08	(delta): 0.0010767
143 (QN/Block) 	Elapsed: 12.241	Loglikelihood: -1.17654e+08	(delta): 0.00153238
144 (QN/Block) 	Elapsed: 12.558	Loglikelihood: -1.17654e+08	(delta): 0.00277612
145 (QN/Block) 	Elapsed: 12.572	Loglikelihood: -1.17654e+08	(delta): 0.000874013
146 (QN/Block) 	Elapsed: 12.771	Loglikelihood: -1.17654e+08	(delta): 0.000925407
147 (QN/Block) 	Elapsed: 12.664	Loglikelihood: -1.17654e+08	(delta): 0.00131333
148 (QN/Block) 	Elapsed: 12.951	Loglikelihood: -1.17654e+08	(delta): 0.00244945
149 (QN/Block) 	Elapsed: 12.708	Loglikelihood: -1.17654e+08	(delta): 0.000773653
150 (QN/Block) 	Elapsed: 12.728	Loglikelihood: -1.17654e+08	(delta): 0.00079231
151 (QN/Block) 	Elapsed: 13.003	Loglikelihood: -1.17654e+08	(delta): 0.00113055
152 (QN/Block) 	Elapsed: 12.605	Loglikelihood: -1.17654e+08	(delta): 0.00214912
153 (QN/Block) 	Elapsed: 12.597	Loglikelihood: -1.17654e+08	(delta): 0.000685841
154 (QN/Block) 	Elapsed: 12.575	Loglikelihood: -1.17654e+08	(delta): 0.000677541
155 (QN/Block) 	Elapsed: 12.448	Loglikelihood: -1.17654e+08	(delta): 0.000975534
156 (QN/Block) 	Elapsed: 12.863	Loglikelihood: -1.17654e+08	(delta): 0.00188045
157 (QN/Block) 	Elapsed: 12.337	Loglikelihood: -1.17654e+08	(delta): 0.000607625
158 (QN/Block) 	Elapsed: 12.642	Loglikelihood: -1.17654e+08	(delta): 0.000579923
159 (QN/Block) 	Elapsed: 12.6	Loglikelihood: -1.17654e+08	(delta): 0.000840813
160 (QN/Block) 	Elapsed: 12.493	Loglikelihood: -1.17654e+08	(delta): 0.00164583
161 (QN/Block) 	Elapsed: 12.753	Loglikelihood: -1.17654e+08	(delta): 0.000536814
162 (QN/Block) 	Elapsed: 12.384	Loglikelihood: -1.17654e+08	(delta): 0.000498846
163 (QN/Block) 	Elapsed: 12.862	Loglikelihood: -1.17654e+08	(delta): 0.000721261
164 (QN/Block) 	Elapsed: 12.738	Loglikelihood: -1.17654e+08	(delta): 0.00144345
165 (QN/Block) 	Elapsed: 12.448	Loglikelihood: -1.17654e+08	(delta): 0.000472173
166 (QN/Block) 	Elapsed: 12.436	Loglikelihood: -1.17654e+08	(delta): 0.00043118
167 (QN/Block) 	Elapsed: 12.351	Loglikelihood: -1.17654e+08	(delta): 0.000615939
168 (QN/Block) 	Elapsed: 12.754	Loglikelihood: -1.17654e+08	(delta): 0.00126772
169 (QN/Block) 	Elapsed: 12.552	Loglikelihood: -1.17654e+08	(delta): 0.000414044
170 (QN/Block) 	Elapsed: 12.948	Loglikelihood: -1.17654e+08	(delta): 0.000373587
171 (QN/Block) 	Elapsed: 13.091	Loglikelihood: -1.17654e+08	(delta): 0.000524089
172 (QN/Block) 	Elapsed: 12.592	Loglikelihood: -1.17654e+08	(delta): 0.00111331
173 (QN/Block) 	Elapsed: 12.684	Loglikelihood: -1.17654e+08	(delta): 0.00036256
174 (QN/Block) 	Elapsed: 12.578	Loglikelihood: -1.17654e+08	(delta): 0.000323817
175 (QN/Block) 	Elapsed: 12.529	Loglikelihood: -1.17654e+08	(delta): 0.000445917
176 (QN/Block) 	Elapsed: 12.969	Loglikelihood: -1.17654e+08	(delta): 0.000975505
177 (QN/Block) 	Elapsed: 13.028	Loglikelihood: -1.17654e+08	(delta): 0.000317439
178 (QN/Block) 	Elapsed: 13.036	Loglikelihood: -1.17654e+08	(delta): 0.000280529
179 (QN/Block) 	Elapsed: 13.17	Loglikelihood: -1.17654e+08	(delta): 0.000379667
180 (QN/Block) 	Elapsed: 12.502	Loglikelihood: -1.17654e+08	(delta): 0.000852481
181 (QN/Block) 	Elapsed: 13.014	Loglikelihood: -1.17654e+08	(delta): 0.000277892
182 (QN/Block) 	Elapsed: 12.903	Loglikelihood: -1.17654e+08	(delta): 0.000242889
183 (QN/Block) 	Elapsed: 12.778	Loglikelihood: -1.17654e+08	(delta): 0.000323266
184 (QN/Block) 	Elapsed: 12.925	Loglikelihood: -1.17654e+08	(delta): 0.000742957
185 (QN/Block) 	Elapsed: 12.687	Loglikelihood: -1.17654e+08	(delta): 0.00024347
186 (QN/Block) 	Elapsed: 12.454	Loglikelihood: -1.17654e+08	(delta): 0.000209719
187 (QN/Block) 	Elapsed: 12.613	Loglikelihood: -1.17654e+08	(delta): 0.000276133
188 (QN/Block) 	Elapsed: 12.731	Loglikelihood: -1.17654e+08	(delta): 0.000645548
189 (QN/Block) 	Elapsed: 12.704	Loglikelihood: -1.17654e+08	(delta): 0.000212997
190 (QN/Block) 	Elapsed: 12.7	Loglikelihood: -1.17654e+08	(delta): 0.00018084
191 (QN/Block) 	Elapsed: 12.53	Loglikelihood: -1.17654e+08	(delta): 0.000236452
192 (QN/Block) 	Elapsed: 12.603	Loglikelihood: -1.17654e+08	(delta): 0.000559241
193 (QN/Block) 	Elapsed: 12.827	Loglikelihood: -1.17654e+08	(delta): 0.000186861
194 (QN/Block) 	Elapsed: 12.509	Loglikelihood: -1.17654e+08	(delta): 0.000155658
195 (QN/Block) 	Elapsed: 12.518	Loglikelihood: -1.17654e+08	(delta): 0.000202671
196 (QN/Block) 	Elapsed: 12.796	Loglikelihood: -1.17654e+08	(delta): 0.000483871
197 (QN/Block) 	Elapsed: 12.767	Loglikelihood: -1.17654e+08	(delta): 0.000163749
198 (QN/Block) 	Elapsed: 12.535	Loglikelihood: -1.17654e+08	(delta): 0.000133917
199 (QN/Block) 	Elapsed: 12.925	Loglikelihood: -1.17654e+08	(delta): 0.000173882
200 (QN/Block) 	Elapsed: 12.73	Loglikelihood: -1.17654e+08	(delta): 0.000418454
201 (QN/Block) 	Elapsed: 12.336	Loglikelihood: -1.17654e+08	(delta): 0.000143424
202 (QN/Block) 	Elapsed: 12.403	Loglikelihood: -1.17654e+08	(delta): 0.00011535
203 (QN/Block) 	Elapsed: 13.034	Loglikelihood: -1.17654e+08	(delta): 0.000149071
204 (QN/Block) 	Elapsed: 12.782	Loglikelihood: -1.17654e+08	(delta): 0.000361875
205 (QN/Block) 	Elapsed: 12.515	Loglikelihood: -1.17654e+08	(delta): 0.000125617
206 (QN/Block) 	Elapsed: 12.595	Loglikelihood: -1.17654e+08	(delta): 9.94056e-05
Summary: 
Converged in 206 iterations (2647.81 sec)
Loglikelihood: -117654087.153217
Fst divergences between estimated populations: 
	Pop0	
Pop0	
Pop1	0.012	
CV error (K=2): 0.54254
Writing output files.
****                   ADMIXTURE Version 1.3.0                  ****
****                    Copyright 2008-2015                     ****
****           David Alexander, Suyash Shringarpure,            ****
****                John  Novembre, Ken Lange                   ****
****                                                            ****
****                 Please cite our paper!                     ****
****   Information at www.genetics.ucla.edu/software/admixture  ****

Cross-validation will be performed.  Folds=5.
Parallel execution requested.  Will use 28 threads.
Random seed: 854534
Point estimation method: Block relaxation algorithm
Convergence acceleration algorithm: QuasiNewton, 3 secant conditions
Point estimation will terminate when objective function delta < 0.0001
Estimation of standard errors disabled; will compute point estimates only.
Size of G: 1240x94854
Performing five EM steps to prime main algorithm
1 (EM) 	Elapsed: 4.087	Loglikelihood: -1.23788e+08	(delta): 6.47047e+07
2 (EM) 	Elapsed: 4.081	Loglikelihood: -1.20398e+08	(delta): 3.39e+06
3 (EM) 	Elapsed: 4.211	Loglikelihood: -1.19398e+08	(delta): 1.00064e+06
4 (EM) 	Elapsed: 4.258	Loglikelihood: -1.18834e+08	(delta): 564184
5 (EM) 	Elapsed: 4.235	Loglikelihood: -1.18466e+08	(delta): 367466
Initial loglikelihood: -1.18466e+08
Starting main algorithm
1 (QN/Block) 	Elapsed: 17.514	Loglikelihood: -1.17634e+08	(delta): 832376
2 (QN/Block) 	Elapsed: 17.449	Loglikelihood: -1.17626e+08	(delta): 7285.39
3 (QN/Block) 	Elapsed: 18.112	Loglikelihood: -1.17614e+08	(delta): 12053.1
4 (QN/Block) 	Elapsed: 17.618	Loglikelihood: -1.17604e+08	(delta): 9960.68
5 (QN/Block) 	Elapsed: 17.926	Loglikelihood: -1.17599e+08	(delta): 5093.89
6 (QN/Block) 	Elapsed: 17.361	Loglikelihood: -1.17597e+08	(delta): 2098.07
7 (QN/Block) 	Elapsed: 17.425	Loglikelihood: -1.17595e+08	(delta): 1865.7
8 (QN/Block) 	Elapsed: 17.699	Loglikelihood: -1.17595e+08	(delta): 293.205
9 (QN/Block) 	Elapsed: 17.437	Loglikelihood: -1.17594e+08	(delta): 767.475
10 (QN/Block) 	Elapsed: 17.415	Loglikelihood: -1.17594e+08	(delta): 344.143
11 (QN/Block) 	Elapsed: 17.775	Loglikelihood: -1.17593e+08	(delta): 601.378
12 (QN/Block) 	Elapsed: 17.447	Loglikelihood: -1.17593e+08	(delta): 472.724
13 (QN/Block) 	Elapsed: 17.816	Loglikelihood: -1.17592e+08	(delta): 418.808
14 (QN/Block) 	Elapsed: 18.026	Loglikelihood: -1.17592e+08	(delta): 764.339
15 (QN/Block) 	Elapsed: 17.921	Loglikelihood: -1.17591e+08	(delta): 599.587
16 (QN/Block) 	Elapsed: 17.634	Loglikelihood: -1.17591e+08	(delta): 449.59
17 (QN/Block) 	Elapsed: 17.696	Loglikelihood: -1.1759e+08	(delta): 558.665
18 (QN/Block) 	Elapsed: 18.077	Loglikelihood: -1.17589e+08	(delta): 641.285
19 (QN/Block) 	Elapsed: 17.284	Loglikelihood: -1.17589e+08	(delta): 464.069
20 (QN/Block) 	Elapsed: 18.044	Loglikelihood: -1.17589e+08	(delta): 253.384
21 (QN/Block) 	Elapsed: 17.465	Loglikelihood: -1.17588e+08	(delta): 270.598
22 (QN/Block) 	Elapsed: 17.594	Loglikelihood: -1.17588e+08	(delta): 185.058
23 (QN/Block) 	Elapsed: 17.741	Loglikelihood: -1.17588e+08	(delta): 119.776
24 (QN/Block) 	Elapsed: 17.625	Loglikelihood: -1.17588e+08	(delta): 119.117
25 (QN/Block) 	Elapsed: 17.792	Loglikelihood: -1.17588e+08	(delta): 103.242
26 (QN/Block) 	Elapsed: 17.73	Loglikelihood: -1.17588e+08	(delta): 42.0446
27 (QN/Block) 	Elapsed: 17.883	Loglikelihood: -1.17588e+08	(delta): 31.7451
28 (QN/Block) 	Elapsed: 17.401	Loglikelihood: -1.17588e+08	(delta): 59.4184
29 (QN/Block) 	Elapsed: 17.54	Loglikelihood: -1.17588e+08	(delta): 30.0397
30 (QN/Block) 	Elapsed: 17.696	Loglikelihood: -1.17588e+08	(delta): 26.3203
31 (QN/Block) 	Elapsed: 17.95	Loglikelihood: -1.17588e+08	(delta): 11.6383
32 (QN/Block) 	Elapsed: 17.749	Loglikelihood: -1.17588e+08	(delta): 56.4046
33 (QN/Block) 	Elapsed: 17.685	Loglikelihood: -1.17588e+08	(delta): 110.174
34 (QN/Block) 	Elapsed: 17.564	Loglikelihood: -1.17588e+08	(delta): 51.9673
35 (QN/Block) 	Elapsed: 17.452	Loglikelihood: -1.17588e+08	(delta): 18.1071
36 (QN/Block) 	Elapsed: 17.733	Loglikelihood: -1.17588e+08	(delta): 13.595
37 (QN/Block) 	Elapsed: 17.643	Loglikelihood: -1.17587e+08	(delta): 40.7404
38 (QN/Block) 	Elapsed: 17.902	Loglikelihood: -1.17587e+08	(delta): 22.3886
39 (QN/Block) 	Elapsed: 17.756	Loglikelihood: -1.17587e+08	(delta): 30.5756
40 (QN/Block) 	Elapsed: 17.804	Loglikelihood: -1.17587e+08	(delta): 6.08494
41 (QN/Block) 	Elapsed: 17.864	Loglikelihood: -1.17587e+08	(delta): 15.6973
42 (QN/Block) 	Elapsed: 17.713	Loglikelihood: -1.17587e+08	(delta): 6.93468
43 (QN/Block) 	Elapsed: 17.724	Loglikelihood: -1.17587e+08	(delta): 45.9736
44 (QN/Block) 	Elapsed: 17.804	Loglikelihood: -1.17587e+08	(delta): 15.6535
45 (QN/Block) 	Elapsed: 17.566	Loglikelihood: -1.17587e+08	(delta): 8.88239
46 (QN/Block) 	Elapsed: 17.744	Loglikelihood: -1.17587e+08	(delta): 1.96121
47 (QN/Block) 	Elapsed: 17.556	Loglikelihood: -1.17587e+08	(delta): 3.53637
48 (QN/Block) 	Elapsed: 17.592	Loglikelihood: -1.17587e+08	(delta): 5.83446
49 (QN/Block) 	Elapsed: 17.518	Loglikelihood: -1.17587e+08	(delta): 7.43466
50 (QN/Block) 	Elapsed: 17.416	Loglikelihood: -1.17587e+08	(delta): 2.52979
51 (QN/Block) 	Elapsed: 17.756	Loglikelihood: -1.17587e+08	(delta): 1.13671
52 (QN/Block) 	Elapsed: 17.789	Loglikelihood: -1.17587e+08	(delta): 3.30932
53 (QN/Block) 	Elapsed: 17.731	Loglikelihood: -1.17587e+08	(delta): 5.31477
54 (QN/Block) 	Elapsed: 18.101	Loglikelihood: -1.17587e+08	(delta): 2.49831
55 (QN/Block) 	Elapsed: 17.568	Loglikelihood: -1.17587e+08	(delta): 0.641827
56 (QN/Block) 	Elapsed: 17.701	Loglikelihood: -1.17587e+08	(delta): 0.865389
57 (QN/Block) 	Elapsed: 17.696	Loglikelihood: -1.17587e+08	(delta): 1.4788
58 (QN/Block) 	Elapsed: 17.696	Loglikelihood: -1.17587e+08	(delta): 4.95181
59 (QN/Block) 	Elapsed: 17.698	Loglikelihood: -1.17587e+08	(delta): 4.21828
60 (QN/Block) 	Elapsed: 17.383	Loglikelihood: -1.17587e+08	(delta): 0.699754
61 (QN/Block) 	Elapsed: 17.728	Loglikelihood: -1.17587e+08	(delta): 0.571706
62 (QN/Block) 	Elapsed: 17.456	Loglikelihood: -1.17587e+08	(delta): 0.978711
63 (QN/Block) 	Elapsed: 17.386	Loglikelihood: -1.17587e+08	(delta): 4.97995
64 (QN/Block) 	Elapsed: 17.975	Loglikelihood: -1.17587e+08	(delta): 0.439576
65 (QN/Block) 	Elapsed: 17.764	Loglikelihood: -1.17587e+08	(delta): 1.10516
66 (QN/Block) 	Elapsed: 17.626	Loglikelihood: -1.17587e+08	(delta): 0.524567
67 (QN/Block) 	Elapsed: 17.731	Loglikelihood: -1.17587e+08	(delta): 0.793258
68 (QN/Block) 	Elapsed: 17.566	Loglikelihood: -1.17587e+08	(delta): 1.94598
69 (QN/Block) 	Elapsed: 17.468	Loglikelihood: -1.17587e+08	(delta): 2.712
70 (QN/Block) 	Elapsed: 17.569	Loglikelihood: -1.17587e+08	(delta): 0.413968
71 (QN/Block) 	Elapsed: 17.957	Loglikelihood: -1.17587e+08	(delta): 0.542548
72 (QN/Block) 	Elapsed: 17.818	Loglikelihood: -1.17587e+08	(delta): 0.397163
73 (QN/Block) 	Elapsed: 18.094	Loglikelihood: -1.17587e+08	(delta): 2.55516
74 (QN/Block) 	Elapsed: 17.864	Loglikelihood: -1.17587e+08	(delta): 0.382084
75 (QN/Block) 	Elapsed: 17.669	Loglikelihood: -1.17587e+08	(delta): 0.805196
76 (QN/Block) 	Elapsed: 18.139	Loglikelihood: -1.17587e+08	(delta): 0.23582
77 (QN/Block) 	Elapsed: 17.751	Loglikelihood: -1.17587e+08	(delta): 0.719113
78 (QN/Block) 	Elapsed: 17.785	Loglikelihood: -1.17587e+08	(delta): 0.205575
79 (QN/Block) 	Elapsed: 17.885	Loglikelihood: -1.17587e+08	(delta): 1.12351
80 (QN/Block) 	Elapsed: 17.792	Loglikelihood: -1.17587e+08	(delta): 0.220845
81 (QN/Block) 	Elapsed: 17.744	Loglikelihood: -1.17587e+08	(delta): 0.472443
82 (QN/Block) 	Elapsed: 17.913	Loglikelihood: -1.17587e+08	(delta): 0.689388
83 (QN/Block) 	Elapsed: 17.907	Loglikelihood: -1.17587e+08	(delta): 0.363765
84 (QN/Block) 	Elapsed: 17.949	Loglikelihood: -1.17587e+08	(delta): 0.236953
85 (QN/Block) 	Elapsed: 17.835	Loglikelihood: -1.17587e+08	(delta): 0.177251
86 (QN/Block) 	Elapsed: 17.299	Loglikelihood: -1.17587e+08	(delta): 0.359638
87 (QN/Block) 	Elapsed: 17.589	Loglikelihood: -1.17587e+08	(delta): 0.285388
88 (QN/Block) 	Elapsed: 17.63	Loglikelihood: -1.17587e+08	(delta): 0.0984922
89 (QN/Block) 	Elapsed: 17.565	Loglikelihood: -1.17587e+08	(delta): 0.130973
90 (QN/Block) 	Elapsed: 17.394	Loglikelihood: -1.17587e+08	(delta): 1.29399
91 (QN/Block) 	Elapsed: 17.466	Loglikelihood: -1.17587e+08	(delta): 0.740022
92 (QN/Block) 	Elapsed: 17.755	Loglikelihood: -1.17587e+08	(delta): 0.0924527
93 (QN/Block) 	Elapsed: 17.368	Loglikelihood: -1.17587e+08	(delta): 0.0386974
94 (QN/Block) 	Elapsed: 17.554	Loglikelihood: -1.17587e+08	(delta): 0.248684
95 (QN/Block) 	Elapsed: 17.782	Loglikelihood: -1.17587e+08	(delta): 0.0168181
96 (QN/Block) 	Elapsed: 17.62	Loglikelihood: -1.17587e+08	(delta): 0.159759
97 (QN/Block) 	Elapsed: 17.524	Loglikelihood: -1.17587e+08	(delta): 0.121375
98 (QN/Block) 	Elapsed: 17.361	Loglikelihood: -1.17587e+08	(delta): 0.195774
99 (QN/Block) 	Elapsed: 17.238	Loglikelihood: -1.17587e+08	(delta): 0.0637976
100 (QN/Block) 	Elapsed: 17.64	Loglikelihood: -1.17587e+08	(delta): 0.0996606
101 (QN/Block) 	Elapsed: 17.387	Loglikelihood: -1.17587e+08	(delta): 0.0575505
102 (QN/Block) 	Elapsed: 17.415	Loglikelihood: -1.17587e+08	(delta): 0.141536
103 (QN/Block) 	Elapsed: 17.259	Loglikelihood: -1.17587e+08	(delta): 0.0310884
104 (QN/Block) 	Elapsed: 17.672	Loglikelihood: -1.17587e+08	(delta): 0.0630147
105 (QN/Block) 	Elapsed: 17.529	Loglikelihood: -1.17587e+08	(delta): 0.0453373
106 (QN/Block) 	Elapsed: 17.128	Loglikelihood: -1.17587e+08	(delta): 0.0545537
107 (QN/Block) 	Elapsed: 17.288	Loglikelihood: -1.17587e+08	(delta): 0.080606
108 (QN/Block) 	Elapsed: 17.382	Loglikelihood: -1.17587e+08	(delta): 0.176162
109 (QN/Block) 	Elapsed: 17.385	Loglikelihood: -1.17587e+08	(delta): 0.0399613
110 (QN/Block) 	Elapsed: 17.715	Loglikelihood: -1.17587e+08	(delta): 0.0154281
111 (QN/Block) 	Elapsed: 17.957	Loglikelihood: -1.17587e+08	(delta): 0.0357563
112 (QN/Block) 	Elapsed: 17.215	Loglikelihood: -1.17587e+08	(delta): 0.149088
113 (QN/Block) 	Elapsed: 17.448	Loglikelihood: -1.17587e+08	(delta): 0.0346867
114 (QN/Block) 	Elapsed: 17.369	Loglikelihood: -1.17587e+08	(delta): 0.00881846
115 (QN/Block) 	Elapsed: 17.9	Loglikelihood: -1.17587e+08	(delta): 0.0162125
116 (QN/Block) 	Elapsed: 17.661	Loglikelihood: -1.17587e+08	(delta): 0.106377
117 (QN/Block) 	Elapsed: 17.949	Loglikelihood: -1.17587e+08	(delta): 0.0265091
118 (QN/Block) 	Elapsed: 17.491	Loglikelihood: -1.17587e+08	(delta): 0.00485173
119 (QN/Block) 	Elapsed: 17.878	Loglikelihood: -1.17587e+08	(delta): 0.00768495
120 (QN/Block) 	Elapsed: 17.619	Loglikelihood: -1.17587e+08	(delta): 0.037583
121 (QN/Block) 	Elapsed: 17.807	Loglikelihood: -1.17587e+08	(delta): 0.00874345
122 (QN/Block) 	Elapsed: 17.708	Loglikelihood: -1.17587e+08	(delta): 0.00914468
123 (QN/Block) 	Elapsed: 17.522	Loglikelihood: -1.17587e+08	(delta): 0.00415075
124 (QN/Block) 	Elapsed: 17.717	Loglikelihood: -1.17587e+08	(delta): 0.00428981
125 (QN/Block) 	Elapsed: 17.439	Loglikelihood: -1.17587e+08	(delta): 0.0241047
126 (QN/Block) 	Elapsed: 17.353	Loglikelihood: -1.17587e+08	(delta): 0.0253874
127 (QN/Block) 	Elapsed: 17.324	Loglikelihood: -1.17587e+08	(delta): 0.00233266
128 (QN/Block) 	Elapsed: 17.7	Loglikelihood: -1.17587e+08	(delta): 0.00178313
129 (QN/Block) 	Elapsed: 17.814	Loglikelihood: -1.17587e+08	(delta): 0.00195637
130 (QN/Block) 	Elapsed: 17.41	Loglikelihood: -1.17587e+08	(delta): 0.00533208
131 (QN/Block) 	Elapsed: 17.599	Loglikelihood: -1.17587e+08	(delta): 0.00275627
132 (QN/Block) 	Elapsed: 17.702	Loglikelihood: -1.17587e+08	(delta): 0.00153901
133 (QN/Block) 	Elapsed: 17.576	Loglikelihood: -1.17587e+08	(delta): 0.00110891
134 (QN/Block) 	Elapsed: 17.509	Loglikelihood: -1.17587e+08	(delta): 0.00265016
135 (QN/Block) 	Elapsed: 17.603	Loglikelihood: -1.17587e+08	(delta): 0.00211523
136 (QN/Block) 	Elapsed: 17.097	Loglikelihood: -1.17587e+08	(delta): 0.00120693
137 (QN/Block) 	Elapsed: 17.289	Loglikelihood: -1.17587e+08	(delta): 0.000740409
138 (QN/Block) 	Elapsed: 17.449	Loglikelihood: -1.17587e+08	(delta): 0.00173147
139 (QN/Block) 	Elapsed: 17.359	Loglikelihood: -1.17587e+08	(delta): 0.00145832
140 (QN/Block) 	Elapsed: 17.663	Loglikelihood: -1.17587e+08	(delta): 0.000919119
141 (QN/Block) 	Elapsed: 17.324	Loglikelihood: -1.17587e+08	(delta): 0.000541195
142 (QN/Block) 	Elapsed: 17.235	Loglikelihood: -1.17587e+08	(delta): 0.00112925
143 (QN/Block) 	Elapsed: 17.279	Loglikelihood: -1.17587e+08	(delta): 0.00110264
144 (QN/Block) 	Elapsed: 17.361	Loglikelihood: -1.17587e+08	(delta): 0.000667453
145 (QN/Block) 	Elapsed: 17.302	Loglikelihood: -1.17587e+08	(delta): 0.000409946
146 (QN/Block) 	Elapsed: 17.547	Loglikelihood: -1.17587e+08	(delta): 0.000742182
147 (QN/Block) 	Elapsed: 17.328	Loglikelihood: -1.17587e+08	(delta): 0.000830159
148 (QN/Block) 	Elapsed: 17.754	Loglikelihood: -1.17587e+08	(delta): 0.000499308
149 (QN/Block) 	Elapsed: 17.368	Loglikelihood: -1.17587e+08	(delta): 0.000301242
150 (QN/Block) 	Elapsed: 17.598	Loglikelihood: -1.17587e+08	(delta): 0.000525206
151 (QN/Block) 	Elapsed: 17.576	Loglikelihood: -1.17587e+08	(delta): 0.00060223
152 (QN/Block) 	Elapsed: 17.584	Loglikelihood: -1.17587e+08	(delta): 0.000382811
153 (QN/Block) 	Elapsed: 17.43	Loglikelihood: -1.17587e+08	(delta): 0.000219837
154 (QN/Block) 	Elapsed: 17.85	Loglikelihood: -1.17587e+08	(delta): 0.000380456
155 (QN/Block) 	Elapsed: 17.47	Loglikelihood: -1.17587e+08	(delta): 0.000438571
156 (QN/Block) 	Elapsed: 17.585	Loglikelihood: -1.17587e+08	(delta): 0.000288844
157 (QN/Block) 	Elapsed: 17.88	Loglikelihood: -1.17587e+08	(delta): 0.000163019
158 (QN/Block) 	Elapsed: 17.866	Loglikelihood: -1.17587e+08	(delta): 0.000272438
159 (QN/Block) 	Elapsed: 17.609	Loglikelihood: -1.17587e+08	(delta): 0.000326157
160 (QN/Block) 	Elapsed: 17.503	Loglikelihood: -1.17587e+08	(delta): 0.000215709
161 (QN/Block) 	Elapsed: 17.65	Loglikelihood: -1.17587e+08	(delta): 0.000121146
162 (QN/Block) 	Elapsed: 17.779	Loglikelihood: -1.17587e+08	(delta): 0.000195056
163 (QN/Block) 	Elapsed: 17.704	Loglikelihood: -1.17587e+08	(delta): 0.000242874
164 (QN/Block) 	Elapsed: 17.782	Loglikelihood: -1.17587e+08	(delta): 0.000163078
165 (QN/Block) 	Elapsed: 17.959	Loglikelihood: -1.17587e+08	(delta): 8.94517e-05
Summary: 
Converged in 165 iterations (2940.97 sec)
Loglikelihood: -117587241.094172
Fst divergences between estimated populations: 
	Pop0	Pop1	
Pop0	
Pop1	0.017	
Pop2	0.027	0.023	
CV error (K=3): 0.54319
Writing output files.
****                   ADMIXTURE Version 1.3.0                  ****
****                    Copyright 2008-2015                     ****
****           David Alexander, Suyash Shringarpure,            ****
****                John  Novembre, Ken Lange                   ****
****                                                            ****
****                 Please cite our paper!                     ****
****   Information at www.genetics.ucla.edu/software/admixture  ****

Cross-validation will be performed.  Folds=5.
Parallel execution requested.  Will use 28 threads.
Random seed: 854534
Point estimation method: Block relaxation algorithm
Convergence acceleration algorithm: QuasiNewton, 3 secant conditions
Point estimation will terminate when objective function delta < 0.0001
Estimation of standard errors disabled; will compute point estimates only.
Size of G: 1240x94854
Performing five EM steps to prime main algorithm
1 (EM) 	Elapsed: 5.144	Loglikelihood: -1.2387e+08	(delta): 5.84073e+07
2 (EM) 	Elapsed: 5.185	Loglikelihood: -1.20544e+08	(delta): 3.32586e+06
3 (EM) 	Elapsed: 5.483	Loglikelihood: -1.19624e+08	(delta): 920556
4 (EM) 	Elapsed: 5.482	Loglikelihood: -1.19091e+08	(delta): 532440
5 (EM) 	Elapsed: 5.473	Loglikelihood: -1.18725e+08	(delta): 366918
Initial loglikelihood: -1.18725e+08
Starting main algorithm
1 (QN/Block) 	Elapsed: 20.346	Loglikelihood: -1.17584e+08	(delta): 1.14066e+06
2 (QN/Block) 	Elapsed: 20.769	Loglikelihood: -1.17573e+08	(delta): 10726.7
3 (QN/Block) 	Elapsed: 20.52	Loglikelihood: -1.17559e+08	(delta): 14024.7
4 (QN/Block) 	Elapsed: 20.917	Loglikelihood: -1.17547e+08	(delta): 12476.6
5 (QN/Block) 	Elapsed: 20.504	Loglikelihood: -1.1754e+08	(delta): 6240.04
6 (QN/Block) 	Elapsed: 20.97	Loglikelihood: -1.17537e+08	(delta): 3810.02
7 (QN/Block) 	Elapsed: 20.659	Loglikelihood: -1.17535e+08	(delta): 2078.12
8 (QN/Block) 	Elapsed: 20.717	Loglikelihood: -1.17533e+08	(delta): 2025.93
9 (QN/Block) 	Elapsed: 21.223	Loglikelihood: -1.17531e+08	(delta): 1767.87
10 (QN/Block) 	Elapsed: 20.609	Loglikelihood: -1.1753e+08	(delta): 665.731
11 (QN/Block) 	Elapsed: 20.157	Loglikelihood: -1.1753e+08	(delta): 580.467
12 (QN/Block) 	Elapsed: 20.306	Loglikelihood: -1.17528e+08	(delta): 1146.21
13 (QN/Block) 	Elapsed: 20.538	Loglikelihood: -1.17528e+08	(delta): 238.366
14 (QN/Block) 	Elapsed: 20.911	Loglikelihood: -1.17528e+08	(delta): 169.683
15 (QN/Block) 	Elapsed: 20.639	Loglikelihood: -1.17528e+08	(delta): 196.393
16 (QN/Block) 	Elapsed: 20.747	Loglikelihood: -1.17528e+08	(delta): 152.052
17 (QN/Block) 	Elapsed: 20.606	Loglikelihood: -1.17527e+08	(delta): 122.976
18 (QN/Block) 	Elapsed: 20.635	Loglikelihood: -1.17527e+08	(delta): 67.5465
19 (QN/Block) 	Elapsed: 20.887	Loglikelihood: -1.17527e+08	(delta): 185.846
20 (QN/Block) 	Elapsed: 20.839	Loglikelihood: -1.17527e+08	(delta): 333.427
21 (QN/Block) 	Elapsed: 21.081	Loglikelihood: -1.17527e+08	(delta): 117.764
22 (QN/Block) 	Elapsed: 20.726	Loglikelihood: -1.17527e+08	(delta): 80.1798
23 (QN/Block) 	Elapsed: 20.647	Loglikelihood: -1.17527e+08	(delta): 92.8614
24 (QN/Block) 	Elapsed: 20.263	Loglikelihood: -1.17527e+08	(delta): 48.6243
25 (QN/Block) 	Elapsed: 20.824	Loglikelihood: -1.17526e+08	(delta): 132.428
26 (QN/Block) 	Elapsed: 20.375	Loglikelihood: -1.17526e+08	(delta): 84.8058
27 (QN/Block) 	Elapsed: 20.592	Loglikelihood: -1.17526e+08	(delta): 77.5666
28 (QN/Block) 	Elapsed: 20.328	Loglikelihood: -1.17526e+08	(delta): 42.8572
29 (QN/Block) 	Elapsed: 20.866	Loglikelihood: -1.17526e+08	(delta): 57.7032
30 (QN/Block) 	Elapsed: 20.354	Loglikelihood: -1.17526e+08	(delta): 58.3529
31 (QN/Block) 	Elapsed: 20.517	Loglikelihood: -1.17526e+08	(delta): 43.5884
32 (QN/Block) 	Elapsed: 20.606	Loglikelihood: -1.17526e+08	(delta): 40.699
33 (QN/Block) 	Elapsed: 21.069	Loglikelihood: -1.17526e+08	(delta): 68.382
34 (QN/Block) 	Elapsed: 20.439	Loglikelihood: -1.17526e+08	(delta): 44.7842
35 (QN/Block) 	Elapsed: 20.903	Loglikelihood: -1.17526e+08	(delta): 34.861
36 (QN/Block) 	Elapsed: 20.388	Loglikelihood: -1.17526e+08	(delta): 51.8782
37 (QN/Block) 	Elapsed: 20.645	Loglikelihood: -1.17526e+08	(delta): 36.1067
38 (QN/Block) 	Elapsed: 20.169	Loglikelihood: -1.17526e+08	(delta): 27.345
39 (QN/Block) 	Elapsed: 20.672	Loglikelihood: -1.17526e+08	(delta): 24.5083
40 (QN/Block) 	Elapsed: 20.758	Loglikelihood: -1.17526e+08	(delta): 22.581
41 (QN/Block) 	Elapsed: 20.729	Loglikelihood: -1.17526e+08	(delta): 44.7387
42 (QN/Block) 	Elapsed: 20.995	Loglikelihood: -1.17526e+08	(delta): 28.5664
43 (QN/Block) 	Elapsed: 21.009	Loglikelihood: -1.17526e+08	(delta): 24.4799
44 (QN/Block) 	Elapsed: 21.024	Loglikelihood: -1.17526e+08	(delta): 17.5922
45 (QN/Block) 	Elapsed: 21.141	Loglikelihood: -1.17526e+08	(delta): 55.3219
46 (QN/Block) 	Elapsed: 21.046	Loglikelihood: -1.17525e+08	(delta): 46.5259
47 (QN/Block) 	Elapsed: 21.172	Loglikelihood: -1.17525e+08	(delta): 51.4139
48 (QN/Block) 	Elapsed: 20.573	Loglikelihood: -1.17525e+08	(delta): 40.5571
49 (QN/Block) 	Elapsed: 20.273	Loglikelihood: -1.17525e+08	(delta): 59.5285
50 (QN/Block) 	Elapsed: 20.698	Loglikelihood: -1.17525e+08	(delta): 32.6589
51 (QN/Block) 	Elapsed: 20.568	Loglikelihood: -1.17525e+08	(delta): 41.7712
52 (QN/Block) 	Elapsed: 20.262	Loglikelihood: -1.17525e+08	(delta): 39.6978
53 (QN/Block) 	Elapsed: 20.344	Loglikelihood: -1.17525e+08	(delta): 13.5564
54 (QN/Block) 	Elapsed: 20.88	Loglikelihood: -1.17525e+08	(delta): 19.3094
55 (QN/Block) 	Elapsed: 20.634	Loglikelihood: -1.17525e+08	(delta): 19.8266
56 (QN/Block) 	Elapsed: 20.755	Loglikelihood: -1.17525e+08	(delta): 26.1829
57 (QN/Block) 	Elapsed: 20.001	Loglikelihood: -1.17525e+08	(delta): 9.43897
58 (QN/Block) 	Elapsed: 20.681	Loglikelihood: -1.17525e+08	(delta): 4.29558
59 (QN/Block) 	Elapsed: 20.645	Loglikelihood: -1.17525e+08	(delta): 11.2259
60 (QN/Block) 	Elapsed: 21.028	Loglikelihood: -1.17525e+08	(delta): 11.0043
61 (QN/Block) 	Elapsed: 20.793	Loglikelihood: -1.17525e+08	(delta): 8.5237
62 (QN/Block) 	Elapsed: 20.516	Loglikelihood: -1.17525e+08	(delta): 3.37481
63 (QN/Block) 	Elapsed: 21.039	Loglikelihood: -1.17525e+08	(delta): 5.99333
64 (QN/Block) 	Elapsed: 21.016	Loglikelihood: -1.17525e+08	(delta): 5.32046
65 (QN/Block) 	Elapsed: 21.102	Loglikelihood: -1.17525e+08	(delta): 1.90459
66 (QN/Block) 	Elapsed: 20.356	Loglikelihood: -1.17525e+08	(delta): 10.6481
67 (QN/Block) 	Elapsed: 20.8	Loglikelihood: -1.17525e+08	(delta): 2.70529
68 (QN/Block) 	Elapsed: 20.777	Loglikelihood: -1.17525e+08	(delta): 1.46527
69 (QN/Block) 	Elapsed: 20.962	Loglikelihood: -1.17525e+08	(delta): 7.38083
70 (QN/Block) 	Elapsed: 21.207	Loglikelihood: -1.17525e+08	(delta): 4.61072
71 (QN/Block) 	Elapsed: 20.709	Loglikelihood: -1.17525e+08	(delta): 6.32829
72 (QN/Block) 	Elapsed: 20.542	Loglikelihood: -1.17525e+08	(delta): 3.0631
73 (QN/Block) 	Elapsed: 21.142	Loglikelihood: -1.17525e+08	(delta): 1.95633
74 (QN/Block) 	Elapsed: 21.337	Loglikelihood: -1.17525e+08	(delta): 2.04833
75 (QN/Block) 	Elapsed: 21.526	Loglikelihood: -1.17525e+08	(delta): 2.073
76 (QN/Block) 	Elapsed: 21.114	Loglikelihood: -1.17525e+08	(delta): 0.384156
77 (QN/Block) 	Elapsed: 20.657	Loglikelihood: -1.17525e+08	(delta): 0.472104
78 (QN/Block) 	Elapsed: 21.161	Loglikelihood: -1.17525e+08	(delta): 0.272495
79 (QN/Block) 	Elapsed: 20.062	Loglikelihood: -1.17525e+08	(delta): 2.60839
80 (QN/Block) 	Elapsed: 20.367	Loglikelihood: -1.17525e+08	(delta): 0.6455
81 (QN/Block) 	Elapsed: 20.398	Loglikelihood: -1.17525e+08	(delta): 0.487328
82 (QN/Block) 	Elapsed: 20.487	Loglikelihood: -1.17525e+08	(delta): 0.219647
83 (QN/Block) 	Elapsed: 20.338	Loglikelihood: -1.17525e+08	(delta): 0.472088
84 (QN/Block) 	Elapsed: 20.522	Loglikelihood: -1.17525e+08	(delta): 0.156111
85 (QN/Block) 	Elapsed: 20.311	Loglikelihood: -1.17525e+08	(delta): 0.198031
86 (QN/Block) 	Elapsed: 20.109	Loglikelihood: -1.17525e+08	(delta): 0.100316
87 (QN/Block) 	Elapsed: 20.549	Loglikelihood: -1.17525e+08	(delta): 0.433209
88 (QN/Block) 	Elapsed: 20.444	Loglikelihood: -1.17525e+08	(delta): 0.141624
89 (QN/Block) 	Elapsed: 20.442	Loglikelihood: -1.17525e+08	(delta): 0.303531
90 (QN/Block) 	Elapsed: 20.535	Loglikelihood: -1.17525e+08	(delta): 0.175158
91 (QN/Block) 	Elapsed: 20.185	Loglikelihood: -1.17525e+08	(delta): 0.14362
92 (QN/Block) 	Elapsed: 20.57	Loglikelihood: -1.17525e+08	(delta): 0.0584395
93 (QN/Block) 	Elapsed: 20.703	Loglikelihood: -1.17525e+08	(delta): 0.15739
94 (QN/Block) 	Elapsed: 20.328	Loglikelihood: -1.17525e+08	(delta): 0.051211
95 (QN/Block) 	Elapsed: 20.733	Loglikelihood: -1.17525e+08	(delta): 0.150124
96 (QN/Block) 	Elapsed: 20.496	Loglikelihood: -1.17525e+08	(delta): 0.0810323
97 (QN/Block) 	Elapsed: 20.544	Loglikelihood: -1.17525e+08	(delta): 0.183163
98 (QN/Block) 	Elapsed: 21.135	Loglikelihood: -1.17525e+08	(delta): 0.0267006
99 (QN/Block) 	Elapsed: 20.136	Loglikelihood: -1.17525e+08	(delta): 0.0676087
100 (QN/Block) 	Elapsed: 20.065	Loglikelihood: -1.17525e+08	(delta): 0.0523454
101 (QN/Block) 	Elapsed: 20.25	Loglikelihood: -1.17525e+08	(delta): 0.15561
102 (QN/Block) 	Elapsed: 20.704	Loglikelihood: -1.17525e+08	(delta): 0.0157657
103 (QN/Block) 	Elapsed: 20.617	Loglikelihood: -1.17525e+08	(delta): 0.0284122
104 (QN/Block) 	Elapsed: 20.633	Loglikelihood: -1.17525e+08	(delta): 0.0282955
105 (QN/Block) 	Elapsed: 20.563	Loglikelihood: -1.17525e+08	(delta): 0.101932
106 (QN/Block) 	Elapsed: 20.637	Loglikelihood: -1.17525e+08	(delta): 0.0070897
107 (QN/Block) 	Elapsed: 20.385	Loglikelihood: -1.17525e+08	(delta): 0.00987656
108 (QN/Block) 	Elapsed: 20.591	Loglikelihood: -1.17525e+08	(delta): 0.0102317
109 (QN/Block) 	Elapsed: 20.796	Loglikelihood: -1.17525e+08	(delta): 0.0390763
110 (QN/Block) 	Elapsed: 20.43	Loglikelihood: -1.17525e+08	(delta): 0.00568326
111 (QN/Block) 	Elapsed: 20.386	Loglikelihood: -1.17525e+08	(delta): 0.00404653
112 (QN/Block) 	Elapsed: 20.667	Loglikelihood: -1.17525e+08	(delta): 0.00479636
113 (QN/Block) 	Elapsed: 20.374	Loglikelihood: -1.17525e+08	(delta): 0.0120847
114 (QN/Block) 	Elapsed: 20.293	Loglikelihood: -1.17525e+08	(delta): 0.0265874
115 (QN/Block) 	Elapsed: 20.809	Loglikelihood: -1.17525e+08	(delta): 0.00242379
116 (QN/Block) 	Elapsed: 20.152	Loglikelihood: -1.17525e+08	(delta): 0.00142755
117 (QN/Block) 	Elapsed: 20.978	Loglikelihood: -1.17525e+08	(delta): 0.00176328
118 (QN/Block) 	Elapsed: 20.65	Loglikelihood: -1.17525e+08	(delta): 0.00652309
119 (QN/Block) 	Elapsed: 20.328	Loglikelihood: -1.17525e+08	(delta): 0.00144139
120 (QN/Block) 	Elapsed: 20.339	Loglikelihood: -1.17525e+08	(delta): 0.00100555
121 (QN/Block) 	Elapsed: 20.808	Loglikelihood: -1.17525e+08	(delta): 0.000852808
122 (QN/Block) 	Elapsed: 20.707	Loglikelihood: -1.17525e+08	(delta): 0.00102223
123 (QN/Block) 	Elapsed: 20.386	Loglikelihood: -1.17525e+08	(delta): 0.000921011
124 (QN/Block) 	Elapsed: 20.404	Loglikelihood: -1.17525e+08	(delta): 0.000644237
125 (QN/Block) 	Elapsed: 20.573	Loglikelihood: -1.17525e+08	(delta): 0.000550374
126 (QN/Block) 	Elapsed: 20.551	Loglikelihood: -1.17525e+08	(delta): 0.000558451
127 (QN/Block) 	Elapsed: 20.865	Loglikelihood: -1.17525e+08	(delta): 0.000629604
128 (QN/Block) 	Elapsed: 20.426	Loglikelihood: -1.17525e+08	(delta): 0.000425085
129 (QN/Block) 	Elapsed: 20.477	Loglikelihood: -1.17525e+08	(delta): 0.000377491
130 (QN/Block) 	Elapsed: 20.966	Loglikelihood: -1.17525e+08	(delta): 0.000365645
131 (QN/Block) 	Elapsed: 20.539	Loglikelihood: -1.17525e+08	(delta): 0.000408292
132 (QN/Block) 	Elapsed: 20.171	Loglikelihood: -1.17525e+08	(delta): 0.000305265
133 (QN/Block) 	Elapsed: 20.304	Loglikelihood: -1.17525e+08	(delta): 0.000255316
134 (QN/Block) 	Elapsed: 20.455	Loglikelihood: -1.17525e+08	(delta): 0.000249535
135 (QN/Block) 	Elapsed: 20.428	Loglikelihood: -1.17525e+08	(delta): 0.000261948
136 (QN/Block) 	Elapsed: 20.081	Loglikelihood: -1.17525e+08	(delta): 0.000224173
137 (QN/Block) 	Elapsed: 20.472	Loglikelihood: -1.17525e+08	(delta): 0.000176042
138 (QN/Block) 	Elapsed: 20.555	Loglikelihood: -1.17525e+08	(delta): 0.000177309
139 (QN/Block) 	Elapsed: 20.933	Loglikelihood: -1.17525e+08	(delta): 0.000172138
140 (QN/Block) 	Elapsed: 20.855	Loglikelihood: -1.17525e+08	(delta): 0.000157684
141 (QN/Block) 	Elapsed: 20.257	Loglikelihood: -1.17525e+08	(delta): 0.000122279
142 (QN/Block) 	Elapsed: 20.551	Loglikelihood: -1.17525e+08	(delta): 0.000124782
143 (QN/Block) 	Elapsed: 20.321	Loglikelihood: -1.17525e+08	(delta): 0.000118494
144 (QN/Block) 	Elapsed: 20.607	Loglikelihood: -1.17525e+08	(delta): 0.000109464
145 (QN/Block) 	Elapsed: 20.532	Loglikelihood: -1.17525e+08	(delta): 8.54135e-05
Summary: 
Converged in 145 iterations (3028.11 sec)
Loglikelihood: -117525041.294247
Fst divergences between estimated populations: 
	Pop0	Pop1	Pop2	
Pop0	
Pop1	0.027	
Pop2	0.030	0.022	
Pop3	0.029	0.024	0.025	
CV error (K=4): 0.54379
Writing output files.
****                   ADMIXTURE Version 1.3.0                  ****
****                    Copyright 2008-2015                     ****
****           David Alexander, Suyash Shringarpure,            ****
****                John  Novembre, Ken Lange                   ****
****                                                            ****
****                 Please cite our paper!                     ****
****   Information at www.genetics.ucla.edu/software/admixture  ****

Cross-validation will be performed.  Folds=5.
Parallel execution requested.  Will use 28 threads.
Random seed: 854534
Point estimation method: Block relaxation algorithm
Convergence acceleration algorithm: QuasiNewton, 3 secant conditions
Point estimation will terminate when objective function delta < 0.0001
Estimation of standard errors disabled; will compute point estimates only.
Size of G: 1240x94854
Performing five EM steps to prime main algorithm
1 (EM) 	Elapsed: 5.973	Loglikelihood: -1.23731e+08	(delta): 5.46349e+07
2 (EM) 	Elapsed: 6.142	Loglikelihood: -1.20503e+08	(delta): 3.22828e+06
3 (EM) 	Elapsed: 6.297	Loglikelihood: -1.19677e+08	(delta): 826213
4 (EM) 	Elapsed: 6.27	Loglikelihood: -1.19193e+08	(delta): 483444
5 (EM) 	Elapsed: 6.276	Loglikelihood: -1.1885e+08	(delta): 343694
Initial loglikelihood: -1.1885e+08
Starting main algorithm
1 (QN/Block) 	Elapsed: 25.341	Loglikelihood: -1.17534e+08	(delta): 1.31534e+06
2 (QN/Block) 	Elapsed: 25.393	Loglikelihood: -1.17522e+08	(delta): 12756.7
3 (QN/Block) 	Elapsed: 25.561	Loglikelihood: -1.17504e+08	(delta): 17585.4
4 (QN/Block) 	Elapsed: 25.526	Loglikelihood: -1.1749e+08	(delta): 13967.2
5 (QN/Block) 	Elapsed: 25.611	Loglikelihood: -1.17482e+08	(delta): 7948.09
6 (QN/Block) 	Elapsed: 25.374	Loglikelihood: -1.17477e+08	(delta): 5496.3
7 (QN/Block) 	Elapsed: 25.444	Loglikelihood: -1.17472e+08	(delta): 4421.25
8 (QN/Block) 	Elapsed: 25.56	Loglikelihood: -1.17471e+08	(delta): 1463.77
9 (QN/Block) 	Elapsed: 25.625	Loglikelihood: -1.17469e+08	(delta): 1798.6
10 (QN/Block) 	Elapsed: 25.889	Loglikelihood: -1.17468e+08	(delta): 867.47
11 (QN/Block) 	Elapsed: 26.045	Loglikelihood: -1.17468e+08	(delta): 302.056
12 (QN/Block) 	Elapsed: 25.737	Loglikelihood: -1.17467e+08	(delta): 500.261
13 (QN/Block) 	Elapsed: 25.673	Loglikelihood: -1.17467e+08	(delta): 277.358
14 (QN/Block) 	Elapsed: 25.616	Loglikelihood: -1.17467e+08	(delta): 189.75
15 (QN/Block) 	Elapsed: 25.59	Loglikelihood: -1.17466e+08	(delta): 385.305
16 (QN/Block) 	Elapsed: 25.467	Loglikelihood: -1.17466e+08	(delta): 230.091
17 (QN/Block) 	Elapsed: 25.833	Loglikelihood: -1.17466e+08	(delta): 196.249
18 (QN/Block) 	Elapsed: 25.585	Loglikelihood: -1.17466e+08	(delta): 138.792
19 (QN/Block) 	Elapsed: 25.552	Loglikelihood: -1.17465e+08	(delta): 338.678
20 (QN/Block) 	Elapsed: 25.619	Loglikelihood: -1.17465e+08	(delta): 231.322
21 (QN/Block) 	Elapsed: 25.475	Loglikelihood: -1.17465e+08	(delta): 159.356
22 (QN/Block) 	Elapsed: 25.403	Loglikelihood: -1.17465e+08	(delta): 219.657
23 (QN/Block) 	Elapsed: 25.553	Loglikelihood: -1.17465e+08	(delta): 118.571
24 (QN/Block) 	Elapsed: 25.46	Loglikelihood: -1.17465e+08	(delta): 89.7475
25 (QN/Block) 	Elapsed: 25.47	Loglikelihood: -1.17464e+08	(delta): 161.536
26 (QN/Block) 	Elapsed: 25.521	Loglikelihood: -1.17464e+08	(delta): 90.9013
27 (QN/Block) 	Elapsed: 25.466	Loglikelihood: -1.17464e+08	(delta): 73.3708
28 (QN/Block) 	Elapsed: 25.447	Loglikelihood: -1.17464e+08	(delta): 53.7231
29 (QN/Block) 	Elapsed: 25.345	Loglikelihood: -1.17464e+08	(delta): 80.5262
30 (QN/Block) 	Elapsed: 25.285	Loglikelihood: -1.17464e+08	(delta): 52.8984
31 (QN/Block) 	Elapsed: 25.48	Loglikelihood: -1.17464e+08	(delta): 35.4402
32 (QN/Block) 	Elapsed: 25.362	Loglikelihood: -1.17464e+08	(delta): 61.3278
33 (QN/Block) 	Elapsed: 25.452	Loglikelihood: -1.17464e+08	(delta): 24.9377
34 (QN/Block) 	Elapsed: 25.401	Loglikelihood: -1.17464e+08	(delta): 12.6502
35 (QN/Block) 	Elapsed: 25.465	Loglikelihood: -1.17464e+08	(delta): 20.2174
36 (QN/Block) 	Elapsed: 25.79	Loglikelihood: -1.17464e+08	(delta): 83.2389
37 (QN/Block) 	Elapsed: 25.894	Loglikelihood: -1.17464e+08	(delta): 11.7779
38 (QN/Block) 	Elapsed: 25.638	Loglikelihood: -1.17464e+08	(delta): 8.24082
39 (QN/Block) 	Elapsed: 25.613	Loglikelihood: -1.17464e+08	(delta): 18.0884
40 (QN/Block) 	Elapsed: 25.725	Loglikelihood: -1.17464e+08	(delta): 11.7204
41 (QN/Block) 	Elapsed: 25.492	Loglikelihood: -1.17464e+08	(delta): 16.5014
42 (QN/Block) 	Elapsed: 25.695	Loglikelihood: -1.17464e+08	(delta): 12.3701
43 (QN/Block) 	Elapsed: 25.472	Loglikelihood: -1.17464e+08	(delta): 5.83127
44 (QN/Block) 	Elapsed: 25.375	Loglikelihood: -1.17464e+08	(delta): 20.4211
45 (QN/Block) 	Elapsed: 25.473	Loglikelihood: -1.17464e+08	(delta): 16.1687
46 (QN/Block) 	Elapsed: 25.37	Loglikelihood: -1.17464e+08	(delta): 8.21265
47 (QN/Block) 	Elapsed: 25.402	Loglikelihood: -1.17464e+08	(delta): 5.97053
48 (QN/Block) 	Elapsed: 25.237	Loglikelihood: -1.17464e+08	(delta): 9.907
49 (QN/Block) 	Elapsed: 25.51	Loglikelihood: -1.17464e+08	(delta): 6.18029
50 (QN/Block) 	Elapsed: 25.354	Loglikelihood: -1.17464e+08	(delta): 7.15112
51 (QN/Block) 	Elapsed: 25.252	Loglikelihood: -1.17464e+08	(delta): 4.93984
52 (QN/Block) 	Elapsed: 25.186	Loglikelihood: -1.17464e+08	(delta): 7.09972
53 (QN/Block) 	Elapsed: 25.259	Loglikelihood: -1.17464e+08	(delta): 3.41392
54 (QN/Block) 	Elapsed: 25.48	Loglikelihood: -1.17464e+08	(delta): 11.7416
55 (QN/Block) 	Elapsed: 25.527	Loglikelihood: -1.17464e+08	(delta): 5.19144
56 (QN/Block) 	Elapsed: 25.538	Loglikelihood: -1.17464e+08	(delta): 5.82417
57 (QN/Block) 	Elapsed: 25.581	Loglikelihood: -1.17464e+08	(delta): 4.82294
58 (QN/Block) 	Elapsed: 25.404	Loglikelihood: -1.17464e+08	(delta): 6.78197
59 (QN/Block) 	Elapsed: 25.499	Loglikelihood: -1.17464e+08	(delta): 2.74173
60 (QN/Block) 	Elapsed: 25.492	Loglikelihood: -1.17464e+08	(delta): 6.11239
61 (QN/Block) 	Elapsed: 25.414	Loglikelihood: -1.17464e+08	(delta): 7.13218
62 (QN/Block) 	Elapsed: 25.342	Loglikelihood: -1.17464e+08	(delta): 4.05925
63 (QN/Block) 	Elapsed: 25.314	Loglikelihood: -1.17464e+08	(delta): 2.11176
64 (QN/Block) 	Elapsed: 25.379	Loglikelihood: -1.17464e+08	(delta): 3.21192
65 (QN/Block) 	Elapsed: 25.259	Loglikelihood: -1.17464e+08	(delta): 3.02803
66 (QN/Block) 	Elapsed: 25.448	Loglikelihood: -1.17464e+08	(delta): 3.60882
67 (QN/Block) 	Elapsed: 25.324	Loglikelihood: -1.17464e+08	(delta): 1.29641
68 (QN/Block) 	Elapsed: 25.677	Loglikelihood: -1.17464e+08	(delta): 8.76767
69 (QN/Block) 	Elapsed: 25.449	Loglikelihood: -1.17464e+08	(delta): 8.93249
70 (QN/Block) 	Elapsed: 25.25	Loglikelihood: -1.17464e+08	(delta): 4.23291
71 (QN/Block) 	Elapsed: 25.413	Loglikelihood: -1.17464e+08	(delta): 2.30992
72 (QN/Block) 	Elapsed: 25.631	Loglikelihood: -1.17464e+08	(delta): 4.61889
73 (QN/Block) 	Elapsed: 25.766	Loglikelihood: -1.17464e+08	(delta): 3.55811
74 (QN/Block) 	Elapsed: 25.72	Loglikelihood: -1.17464e+08	(delta): 5.60409
75 (QN/Block) 	Elapsed: 25.467	Loglikelihood: -1.17464e+08	(delta): 5.28488
76 (QN/Block) 	Elapsed: 25.474	Loglikelihood: -1.17464e+08	(delta): 4.82276
77 (QN/Block) 	Elapsed: 25.493	Loglikelihood: -1.17464e+08	(delta): 1.92256
78 (QN/Block) 	Elapsed: 25.356	Loglikelihood: -1.17464e+08	(delta): 8.41203
79 (QN/Block) 	Elapsed: 25.202	Loglikelihood: -1.17464e+08	(delta): 10.8693
80 (QN/Block) 	Elapsed: 25.458	Loglikelihood: -1.17464e+08	(delta): 5.32322
81 (QN/Block) 	Elapsed: 25.321	Loglikelihood: -1.17464e+08	(delta): 7.88858
82 (QN/Block) 	Elapsed: 25.399	Loglikelihood: -1.17464e+08	(delta): 7.29496
83 (QN/Block) 	Elapsed: 25.302	Loglikelihood: -1.17464e+08	(delta): 5.6887
84 (QN/Block) 	Elapsed: 25.291	Loglikelihood: -1.17464e+08	(delta): 6.57336
85 (QN/Block) 	Elapsed: 25.332	Loglikelihood: -1.17464e+08	(delta): 4.21563
86 (QN/Block) 	Elapsed: 25.459	Loglikelihood: -1.17464e+08	(delta): 1.90216
87 (QN/Block) 	Elapsed: 25.439	Loglikelihood: -1.17464e+08	(delta): 1.97444
88 (QN/Block) 	Elapsed: 25.518	Loglikelihood: -1.17464e+08	(delta): 2.11949
89 (QN/Block) 	Elapsed: 25.608	Loglikelihood: -1.17464e+08	(delta): 2.30832
90 (QN/Block) 	Elapsed: 25.511	Loglikelihood: -1.17464e+08	(delta): 2.41619
91 (QN/Block) 	Elapsed: 25.431	Loglikelihood: -1.17464e+08	(delta): 2.4974
92 (QN/Block) 	Elapsed: 25.589	Loglikelihood: -1.17464e+08	(delta): 2.65727
93 (QN/Block) 	Elapsed: 25.765	Loglikelihood: -1.17464e+08	(delta): 2.24245
94 (QN/Block) 	Elapsed: 25.678	Loglikelihood: -1.17464e+08	(delta): 7.64277
95 (QN/Block) 	Elapsed: 25.617	Loglikelihood: -1.17463e+08	(delta): 13.9325
96 (QN/Block) 	Elapsed: 25.39	Loglikelihood: -1.17463e+08	(delta): 14.4167
97 (QN/Block) 	Elapsed: 25.636	Loglikelihood: -1.17463e+08	(delta): 7.16972
98 (QN/Block) 	Elapsed: 25.498	Loglikelihood: -1.17463e+08	(delta): 3.06465
99 (QN/Block) 	Elapsed: 25.409	Loglikelihood: -1.17463e+08	(delta): 7.8469
100 (QN/Block) 	Elapsed: 25.782	Loglikelihood: -1.17463e+08	(delta): 4.5127
101 (QN/Block) 	Elapsed: 25.517	Loglikelihood: -1.17463e+08	(delta): 5.09719
102 (QN/Block) 	Elapsed: 25.533	Loglikelihood: -1.17463e+08	(delta): 13.7219
103 (QN/Block) 	Elapsed: 25.256	Loglikelihood: -1.17463e+08	(delta): 10.6388
104 (QN/Block) 	Elapsed: 25.441	Loglikelihood: -1.17463e+08	(delta): 8.05486
105 (QN/Block) 	Elapsed: 25.284	Loglikelihood: -1.17463e+08	(delta): 5.15569
106 (QN/Block) 	Elapsed: 25.155	Loglikelihood: -1.17463e+08	(delta): 3.08818
107 (QN/Block) 	Elapsed: 25.324	Loglikelihood: -1.17463e+08	(delta): 8.57416
108 (QN/Block) 	Elapsed: 25.4	Loglikelihood: -1.17463e+08	(delta): 4.20862
109 (QN/Block) 	Elapsed: 25.412	Loglikelihood: -1.17463e+08	(delta): 1.95016
110 (QN/Block) 	Elapsed: 25.387	Loglikelihood: -1.17463e+08	(delta): 3.2632
111 (QN/Block) 	Elapsed: 25.25	Loglikelihood: -1.17463e+08	(delta): 1.90461
112 (QN/Block) 	Elapsed: 25.233	Loglikelihood: -1.17463e+08	(delta): 1.56483
113 (QN/Block) 	Elapsed: 25.664	Loglikelihood: -1.17463e+08	(delta): 1.449
114 (QN/Block) 	Elapsed: 25.556	Loglikelihood: -1.17463e+08	(delta): 1.09895
115 (QN/Block) 	Elapsed: 25.421	Loglikelihood: -1.17463e+08	(delta): 2.17559
116 (QN/Block) 	Elapsed: 25.286	Loglikelihood: -1.17463e+08	(delta): 0.8854
117 (QN/Block) 	Elapsed: 25.36	Loglikelihood: -1.17463e+08	(delta): 1.95306
118 (QN/Block) 	Elapsed: 25.319	Loglikelihood: -1.17463e+08	(delta): 0.408894
119 (QN/Block) 	Elapsed: 25.327	Loglikelihood: -1.17463e+08	(delta): 1.70778
120 (QN/Block) 	Elapsed: 25.521	Loglikelihood: -1.17463e+08	(delta): 0.270425
121 (QN/Block) 	Elapsed: 25.515	Loglikelihood: -1.17463e+08	(delta): 1.27566
122 (QN/Block) 	Elapsed: 25.464	Loglikelihood: -1.17463e+08	(delta): 0.193626
123 (QN/Block) 	Elapsed: 25.381	Loglikelihood: -1.17463e+08	(delta): 0.645377
124 (QN/Block) 	Elapsed: 25.332	Loglikelihood: -1.17463e+08	(delta): 0.115345
125 (QN/Block) 	Elapsed: 25.332	Loglikelihood: -1.17463e+08	(delta): 0.535005
126 (QN/Block) 	Elapsed: 25.418	Loglikelihood: -1.17463e+08	(delta): 0.106447
127 (QN/Block) 	Elapsed: 25.43	Loglikelihood: -1.17463e+08	(delta): 0.179438
128 (QN/Block) 	Elapsed: 25.304	Loglikelihood: -1.17463e+08	(delta): 0.0652676
129 (QN/Block) 	Elapsed: 25.475	Loglikelihood: -1.17463e+08	(delta): 0.133962
130 (QN/Block) 	Elapsed: 25.448	Loglikelihood: -1.17463e+08	(delta): 0.0739689
131 (QN/Block) 	Elapsed: 25.522	Loglikelihood: -1.17463e+08	(delta): 0.147119
132 (QN/Block) 	Elapsed: 25.708	Loglikelihood: -1.17463e+08	(delta): 0.0370985
133 (QN/Block) 	Elapsed: 25.392	Loglikelihood: -1.17463e+08	(delta): 0.0667747
134 (QN/Block) 	Elapsed: 25.589	Loglikelihood: -1.17463e+08	(delta): 0.0411172
135 (QN/Block) 	Elapsed: 25.561	Loglikelihood: -1.17463e+08	(delta): 0.116429
136 (QN/Block) 	Elapsed: 25.327	Loglikelihood: -1.17463e+08	(delta): 0.0148586
137 (QN/Block) 	Elapsed: 25.471	Loglikelihood: -1.17463e+08	(delta): 0.0218402
138 (QN/Block) 	Elapsed: 25.652	Loglikelihood: -1.17463e+08	(delta): 0.0131009
139 (QN/Block) 	Elapsed: 25.466	Loglikelihood: -1.17463e+08	(delta): 0.0229082
140 (QN/Block) 	Elapsed: 25.428	Loglikelihood: -1.17463e+08	(delta): 0.0262814
141 (QN/Block) 	Elapsed: 25.309	Loglikelihood: -1.17463e+08	(delta): 0.0483894
142 (QN/Block) 	Elapsed: 25.467	Loglikelihood: -1.17463e+08	(delta): 0.0102566
143 (QN/Block) 	Elapsed: 25.236	Loglikelihood: -1.17463e+08	(delta): 0.00539684
144 (QN/Block) 	Elapsed: 25.35	Loglikelihood: -1.17463e+08	(delta): 0.00934327
145 (QN/Block) 	Elapsed: 25.259	Loglikelihood: -1.17463e+08	(delta): 0.0516405
146 (QN/Block) 	Elapsed: 25.203	Loglikelihood: -1.17463e+08	(delta): 0.0147057
147 (QN/Block) 	Elapsed: 25.122	Loglikelihood: -1.17463e+08	(delta): 0.00757782
148 (QN/Block) 	Elapsed: 25.218	Loglikelihood: -1.17463e+08	(delta): 0.00227918
149 (QN/Block) 	Elapsed: 25.483	Loglikelihood: -1.17463e+08	(delta): 0.00323234
150 (QN/Block) 	Elapsed: 25.464	Loglikelihood: -1.17463e+08	(delta): 0.00629559
151 (QN/Block) 	Elapsed: 25.747	Loglikelihood: -1.17463e+08	(delta): 0.00627643
152 (QN/Block) 	Elapsed: 25.667	Loglikelihood: -1.17463e+08	(delta): 0.00221483
153 (QN/Block) 	Elapsed: 25.496	Loglikelihood: -1.17463e+08	(delta): 0.00222218
154 (QN/Block) 	Elapsed: 25.543	Loglikelihood: -1.17463e+08	(delta): 0.00426647
155 (QN/Block) 	Elapsed: 25.427	Loglikelihood: -1.17463e+08	(delta): 0.0106958
156 (QN/Block) 	Elapsed: 25.497	Loglikelihood: -1.17463e+08	(delta): 0.00312538
157 (QN/Block) 	Elapsed: 25.416	Loglikelihood: -1.17463e+08	(delta): 0.00235027
158 (QN/Block) 	Elapsed: 25.202	Loglikelihood: -1.17463e+08	(delta): 0.00181353
159 (QN/Block) 	Elapsed: 25.321	Loglikelihood: -1.17463e+08	(delta): 0.00451846
160 (QN/Block) 	Elapsed: 25.474	Loglikelihood: -1.17463e+08	(delta): 0.00306031
161 (QN/Block) 	Elapsed: 25.494	Loglikelihood: -1.17463e+08	(delta): 0.00295031
162 (QN/Block) 	Elapsed: 25.348	Loglikelihood: -1.17463e+08	(delta): 0.00158612
163 (QN/Block) 	Elapsed: 25.5	Loglikelihood: -1.17463e+08	(delta): 0.00219391
164 (QN/Block) 	Elapsed: 25.235	Loglikelihood: -1.17463e+08	(delta): 0.00250642
165 (QN/Block) 	Elapsed: 25.362	Loglikelihood: -1.17463e+08	(delta): 0.00246148
166 (QN/Block) 	Elapsed: 25.192	Loglikelihood: -1.17463e+08	(delta): 0.00153472
167 (QN/Block) 	Elapsed: 25.284	Loglikelihood: -1.17463e+08	(delta): 0.00168747
168 (QN/Block) 	Elapsed: 25.304	Loglikelihood: -1.17463e+08	(delta): 0.00227563
169 (QN/Block) 	Elapsed: 25.364	Loglikelihood: -1.17463e+08	(delta): 0.00223586
170 (QN/Block) 	Elapsed: 25.594	Loglikelihood: -1.17463e+08	(delta): 0.00150932
171 (QN/Block) 	Elapsed: 25.734	Loglikelihood: -1.17463e+08	(delta): 0.00149165
172 (QN/Block) 	Elapsed: 25.673	Loglikelihood: -1.17463e+08	(delta): 0.00201078
173 (QN/Block) 	Elapsed: 25.618	Loglikelihood: -1.17463e+08	(delta): 0.00214341
174 (QN/Block) 	Elapsed: 25.484	Loglikelihood: -1.17463e+08	(delta): 0.00145386
175 (QN/Block) 	Elapsed: 25.3	Loglikelihood: -1.17463e+08	(delta): 0.0014272
176 (QN/Block) 	Elapsed: 25.685	Loglikelihood: -1.17463e+08	(delta): 0.00183892
177 (QN/Block) 	Elapsed: 25.596	Loglikelihood: -1.17463e+08	(delta): 0.00208467
178 (QN/Block) 	Elapsed: 25.438	Loglikelihood: -1.17463e+08	(delta): 0.00144033
179 (QN/Block) 	Elapsed: 25.334	Loglikelihood: -1.17463e+08	(delta): 0.00139464
180 (QN/Block) 	Elapsed: 25.41	Loglikelihood: -1.17463e+08	(delta): 0.00172597
181 (QN/Block) 	Elapsed: 25.565	Loglikelihood: -1.17463e+08	(delta): 0.00202683
182 (QN/Block) 	Elapsed: 25.444	Loglikelihood: -1.17463e+08	(delta): 0.00143026
183 (QN/Block) 	Elapsed: 25.343	Loglikelihood: -1.17463e+08	(delta): 0.00137207
184 (QN/Block) 	Elapsed: 25.48	Loglikelihood: -1.17463e+08	(delta): 0.00166292
185 (QN/Block) 	Elapsed: 25.503	Loglikelihood: -1.17463e+08	(delta): 0.0019798
186 (QN/Block) 	Elapsed: 25.574	Loglikelihood: -1.17463e+08	(delta): 0.00142266
187 (QN/Block) 	Elapsed: 25.492	Loglikelihood: -1.17463e+08	(delta): 0.00135407
188 (QN/Block) 	Elapsed: 25.611	Loglikelihood: -1.17463e+08	(delta): 0.00161792
189 (QN/Block) 	Elapsed: 25.523	Loglikelihood: -1.17463e+08	(delta): 0.00196369
190 (QN/Block) 	Elapsed: 25.431	Loglikelihood: -1.17463e+08	(delta): 0.00140382
191 (QN/Block) 	Elapsed: 25.466	Loglikelihood: -1.17463e+08	(delta): 0.00134879
192 (QN/Block) 	Elapsed: 25.679	Loglikelihood: -1.17463e+08	(delta): 0.00156185
193 (QN/Block) 	Elapsed: 25.473	Loglikelihood: -1.17463e+08	(delta): 0.00197224
194 (QN/Block) 	Elapsed: 25.625	Loglikelihood: -1.17463e+08	(delta): 0.0014015
195 (QN/Block) 	Elapsed: 25.695	Loglikelihood: -1.17463e+08	(delta): 0.00134653
196 (QN/Block) 	Elapsed: 25.703	Loglikelihood: -1.17463e+08	(delta): 0.00151719
197 (QN/Block) 	Elapsed: 25.561	Loglikelihood: -1.17463e+08	(delta): 0.00196569
198 (QN/Block) 	Elapsed: 25.792	Loglikelihood: -1.17463e+08	(delta): 0.00139922
199 (QN/Block) 	Elapsed: 25.507	Loglikelihood: -1.17463e+08	(delta): 0.00133879
200 (QN/Block) 	Elapsed: 25.487	Loglikelihood: -1.17463e+08	(delta): 0.00151001
201 (QN/Block) 	Elapsed: 25.396	Loglikelihood: -1.17463e+08	(delta): 0.00195436
202 (QN/Block) 	Elapsed: 25.479	Loglikelihood: -1.17463e+08	(delta): 0.00141092
203 (QN/Block) 	Elapsed: 25.556	Loglikelihood: -1.17463e+08	(delta): 0.00131638
204 (QN/Block) 	Elapsed: 25.535	Loglikelihood: -1.17463e+08	(delta): 0.00149363
205 (QN/Block) 	Elapsed: 25.731	Loglikelihood: -1.17463e+08	(delta): 0.00190279
206 (QN/Block) 	Elapsed: 25.527	Loglikelihood: -1.17463e+08	(delta): 0.00143459
207 (QN/Block) 	Elapsed: 25.373	Loglikelihood: -1.17463e+08	(delta): 0.00131035
208 (QN/Block) 	Elapsed: 25.507	Loglikelihood: -1.17463e+08	(delta): 0.00148384
209 (QN/Block) 	Elapsed: 25.668	Loglikelihood: -1.17463e+08	(delta): 0.00187893
210 (QN/Block) 	Elapsed: 25.722	Loglikelihood: -1.17463e+08	(delta): 0.00144766
211 (QN/Block) 	Elapsed: 25.757	Loglikelihood: -1.17463e+08	(delta): 0.00129427
212 (QN/Block) 	Elapsed: 25.816	Loglikelihood: -1.17463e+08	(delta): 0.00147259
213 (QN/Block) 	Elapsed: 25.672	Loglikelihood: -1.17463e+08	(delta): 0.00190136
214 (QN/Block) 	Elapsed: 25.645	Loglikelihood: -1.17463e+08	(delta): 0.00146529
215 (QN/Block) 	Elapsed: 25.512	Loglikelihood: -1.17463e+08	(delta): 0.00129163
216 (QN/Block) 	Elapsed: 25.408	Loglikelihood: -1.17463e+08	(delta): 0.0014545
217 (QN/Block) 	Elapsed: 25.34	Loglikelihood: -1.17463e+08	(delta): 0.00191337
218 (QN/Block) 	Elapsed: 25.357	Loglikelihood: -1.17463e+08	(delta): 0.00148141
219 (QN/Block) 	Elapsed: 25.585	Loglikelihood: -1.17463e+08	(delta): 0.00130276
220 (QN/Block) 	Elapsed: 25.592	Loglikelihood: -1.17463e+08	(delta): 0.00144391
221 (QN/Block) 	Elapsed: 25.392	Loglikelihood: -1.17463e+08	(delta): 0.00194682
222 (QN/Block) 	Elapsed: 25.569	Loglikelihood: -1.17463e+08	(delta): 0.00150473
223 (QN/Block) 	Elapsed: 25.415	Loglikelihood: -1.17463e+08	(delta): 0.00132555
224 (QN/Block) 	Elapsed: 25.404	Loglikelihood: -1.17463e+08	(delta): 0.00146824
225 (QN/Block) 	Elapsed: 25.551	Loglikelihood: -1.17463e+08	(delta): 0.00204551
226 (QN/Block) 	Elapsed: 25.641	Loglikelihood: -1.17463e+08	(delta): 0.00133575
227 (QN/Block) 	Elapsed: 25.809	Loglikelihood: -1.17463e+08	(delta): 0.000927716
228 (QN/Block) 	Elapsed: 25.558	Loglikelihood: -1.17463e+08	(delta): 0.00102644
229 (QN/Block) 	Elapsed: 25.564	Loglikelihood: -1.17463e+08	(delta): 0.00743255
230 (QN/Block) 	Elapsed: 25.62	Loglikelihood: -1.17463e+08	(delta): 0.0166895
231 (QN/Block) 	Elapsed: 25.757	Loglikelihood: -1.17463e+08	(delta): 0.00306313
232 (QN/Block) 	Elapsed: 25.456	Loglikelihood: -1.17463e+08	(delta): 0.00151506
233 (QN/Block) 	Elapsed: 25.511	Loglikelihood: -1.17463e+08	(delta): 0.00182062
234 (QN/Block) 	Elapsed: 25.376	Loglikelihood: -1.17463e+08	(delta): 0.00685976
235 (QN/Block) 	Elapsed: 25.458	Loglikelihood: -1.17463e+08	(delta): 0.00100277
236 (QN/Block) 	Elapsed: 25.392	Loglikelihood: -1.17463e+08	(delta): 0.00171851
237 (QN/Block) 	Elapsed: 25.512	Loglikelihood: -1.17463e+08	(delta): 0.00136508
238 (QN/Block) 	Elapsed: 25.508	Loglikelihood: -1.17463e+08	(delta): 0.00109912
239 (QN/Block) 	Elapsed: 25.234	Loglikelihood: -1.17463e+08	(delta): 0.00287096
240 (QN/Block) 	Elapsed: 25.615	Loglikelihood: -1.17463e+08	(delta): 0.00100622
241 (QN/Block) 	Elapsed: 25.588	Loglikelihood: -1.17463e+08	(delta): 0.00207049
242 (QN/Block) 	Elapsed: 25.698	Loglikelihood: -1.17463e+08	(delta): 0.00118248
243 (QN/Block) 	Elapsed: 25.76	Loglikelihood: -1.17463e+08	(delta): 0.00083372
244 (QN/Block) 	Elapsed: 25.512	Loglikelihood: -1.17463e+08	(delta): 0.000642568
245 (QN/Block) 	Elapsed: 25.455	Loglikelihood: -1.17463e+08	(delta): 0.000992998
246 (QN/Block) 	Elapsed: 25.373	Loglikelihood: -1.17463e+08	(delta): 0.000770301
247 (QN/Block) 	Elapsed: 25.553	Loglikelihood: -1.17463e+08	(delta): 0.000602692
248 (QN/Block) 	Elapsed: 25.56	Loglikelihood: -1.17463e+08	(delta): 0.000469193
249 (QN/Block) 	Elapsed: 25.387	Loglikelihood: -1.17463e+08	(delta): 0.000723317
250 (QN/Block) 	Elapsed: 25.284	Loglikelihood: -1.17463e+08	(delta): 0.000534341
251 (QN/Block) 	Elapsed: 25.235	Loglikelihood: -1.17463e+08	(delta): 0.00033702
252 (QN/Block) 	Elapsed: 25.607	Loglikelihood: -1.17463e+08	(delta): 0.000262141
253 (QN/Block) 	Elapsed: 25.53	Loglikelihood: -1.17463e+08	(delta): 0.00141858
254 (QN/Block) 	Elapsed: 25.646	Loglikelihood: -1.17463e+08	(delta): 0.00180028
255 (QN/Block) 	Elapsed: 25.27	Loglikelihood: -1.17463e+08	(delta): 0.000301287
256 (QN/Block) 	Elapsed: 25.408	Loglikelihood: -1.17463e+08	(delta): 0.000120729
257 (QN/Block) 	Elapsed: 25.391	Loglikelihood: -1.17463e+08	(delta): 0.000331774
258 (QN/Block) 	Elapsed: 25.427	Loglikelihood: -1.17463e+08	(delta): 0.00134142
259 (QN/Block) 	Elapsed: 25.369	Loglikelihood: -1.17463e+08	(delta): 0.000276849
260 (QN/Block) 	Elapsed: 25.392	Loglikelihood: -1.17463e+08	(delta): 7.19279e-05
Summary: 
Converged in 260 iterations (6677.67 sec)
Loglikelihood: -117463373.406346
Fst divergences between estimated populations: 
	Pop0	Pop1	Pop2	Pop3	
Pop0	
Pop1	0.017	
Pop2	0.024	0.024	
Pop3	0.029	0.029	0.032	
Pop4	0.029	0.028	0.030	0.034	
CV error (K=5): 0.54436
Writing output files.
****                   ADMIXTURE Version 1.3.0                  ****
****                    Copyright 2008-2015                     ****
****           David Alexander, Suyash Shringarpure,            ****
****                John  Novembre, Ken Lange                   ****
****                                                            ****
****                 Please cite our paper!                     ****
****   Information at www.genetics.ucla.edu/software/admixture  ****

Cross-validation will be performed.  Folds=5.
Parallel execution requested.  Will use 28 threads.
Random seed: 854534
Point estimation method: Block relaxation algorithm
Convergence acceleration algorithm: QuasiNewton, 3 secant conditions
Point estimation will terminate when objective function delta < 0.0001
Estimation of standard errors disabled; will compute point estimates only.
Size of G: 1240x94854
Performing five EM steps to prime main algorithm
1 (EM) 	Elapsed: 7.014	Loglikelihood: -1.23557e+08	(delta): 5.23527e+07
2 (EM) 	Elapsed: 7.297	Loglikelihood: -1.20382e+08	(delta): 3.1752e+06
3 (EM) 	Elapsed: 7.372	Loglikelihood: -1.19638e+08	(delta): 744083
4 (EM) 	Elapsed: 7.36	Loglikelihood: -1.19205e+08	(delta): 432755
5 (EM) 	Elapsed: 7.368	Loglikelihood: -1.18891e+08	(delta): 314809
Initial loglikelihood: -1.18891e+08
Starting main algorithm
1 (QN/Block) 	Elapsed: 27.535	Loglikelihood: -1.17484e+08	(delta): 1.40638e+06
2 (QN/Block) 	Elapsed: 28.001	Loglikelihood: -1.17467e+08	(delta): 17122.8
3 (QN/Block) 	Elapsed: 28.044	Loglikelihood: -1.17446e+08	(delta): 21566.7
4 (QN/Block) 	Elapsed: 28.1	Loglikelihood: -1.17427e+08	(delta): 18797.4
5 (QN/Block) 	Elapsed: 28.003	Loglikelihood: -1.17422e+08	(delta): 4771.34
6 (QN/Block) 	Elapsed: 28.247	Loglikelihood: -1.17417e+08	(delta): 4691.55
7 (QN/Block) 	Elapsed: 27.88	Loglikelihood: -1.17415e+08	(delta): 2466.33
8 (QN/Block) 	Elapsed: 28.041	Loglikelihood: -1.17413e+08	(delta): 1379.8
9 (QN/Block) 	Elapsed: 27.783	Loglikelihood: -1.17412e+08	(delta): 1232.53
10 (QN/Block) 	Elapsed: 27.58	Loglikelihood: -1.1741e+08	(delta): 1720.46
11 (QN/Block) 	Elapsed: 27.922	Loglikelihood: -1.17409e+08	(delta): 1671.22
12 (QN/Block) 	Elapsed: 27.728	Loglikelihood: -1.17408e+08	(delta): 543.375
13 (QN/Block) 	Elapsed: 27.619	Loglikelihood: -1.17407e+08	(delta): 967.557
14 (QN/Block) 	Elapsed: 27.881	Loglikelihood: -1.17406e+08	(delta): 868.303
15 (QN/Block) 	Elapsed: 28.116	Loglikelihood: -1.17406e+08	(delta): 403.13
16 (QN/Block) 	Elapsed: 27.621	Loglikelihood: -1.17405e+08	(delta): 554.377
17 (QN/Block) 	Elapsed: 27.578	Loglikelihood: -1.17405e+08	(delta): 321.82
18 (QN/Block) 	Elapsed: 27.486	Loglikelihood: -1.17405e+08	(delta): 202.123
19 (QN/Block) 	Elapsed: 27.84	Loglikelihood: -1.17405e+08	(delta): 418.192
20 (QN/Block) 	Elapsed: 27.739	Loglikelihood: -1.17404e+08	(delta): 271.856
21 (QN/Block) 	Elapsed: 28.09	Loglikelihood: -1.17404e+08	(delta): 273.513
22 (QN/Block) 	Elapsed: 27.696	Loglikelihood: -1.17404e+08	(delta): 115.152
23 (QN/Block) 	Elapsed: 27.56	Loglikelihood: -1.17404e+08	(delta): 136.129
24 (QN/Block) 	Elapsed: 28.405	Loglikelihood: -1.17404e+08	(delta): 87.2496
25 (QN/Block) 	Elapsed: 27.705	Loglikelihood: -1.17404e+08	(delta): 81.6567
26 (QN/Block) 	Elapsed: 27.628	Loglikelihood: -1.17403e+08	(delta): 61.2914
27 (QN/Block) 	Elapsed: 27.739	Loglikelihood: -1.17403e+08	(delta): 74.3245
28 (QN/Block) 	Elapsed: 27.699	Loglikelihood: -1.17403e+08	(delta): 207.71
29 (QN/Block) 	Elapsed: 27.825	Loglikelihood: -1.17403e+08	(delta): 29.0627
30 (QN/Block) 	Elapsed: 27.442	Loglikelihood: -1.17403e+08	(delta): 65.2562
31 (QN/Block) 	Elapsed: 27.375	Loglikelihood: -1.17403e+08	(delta): 30.6778
32 (QN/Block) 	Elapsed: 27.893	Loglikelihood: -1.17403e+08	(delta): 22.5856
33 (QN/Block) 	Elapsed: 27.5	Loglikelihood: -1.17403e+08	(delta): 17.3985
34 (QN/Block) 	Elapsed: 27.803	Loglikelihood: -1.17403e+08	(delta): 11.3858
35 (QN/Block) 	Elapsed: 27.743	Loglikelihood: -1.17403e+08	(delta): 35.4258
36 (QN/Block) 	Elapsed: 27.992	Loglikelihood: -1.17403e+08	(delta): 20.5968
37 (QN/Block) 	Elapsed: 27.678	Loglikelihood: -1.17403e+08	(delta): 15.6681
38 (QN/Block) 	Elapsed: 27.556	Loglikelihood: -1.17403e+08	(delta): 8.90009
39 (QN/Block) 	Elapsed: 27.605	Loglikelihood: -1.17403e+08	(delta): 14.9229
40 (QN/Block) 	Elapsed: 27.622	Loglikelihood: -1.17403e+08	(delta): 13.3165
41 (QN/Block) 	Elapsed: 27.483	Loglikelihood: -1.17403e+08	(delta): 8.17413
42 (QN/Block) 	Elapsed: 27.59	Loglikelihood: -1.17403e+08	(delta): 5.13743
43 (QN/Block) 	Elapsed: 27.782	Loglikelihood: -1.17403e+08	(delta): 8.54304
44 (QN/Block) 	Elapsed: 27.985	Loglikelihood: -1.17403e+08	(delta): 12.5262
45 (QN/Block) 	Elapsed: 27.35	Loglikelihood: -1.17403e+08	(delta): 6.43798
46 (QN/Block) 	Elapsed: 27.523	Loglikelihood: -1.17403e+08	(delta): 7.28806
47 (QN/Block) 	Elapsed: 27.428	Loglikelihood: -1.17403e+08	(delta): 2.68702
48 (QN/Block) 	Elapsed: 27.649	Loglikelihood: -1.17403e+08	(delta): 10.465
49 (QN/Block) 	Elapsed: 28.12	Loglikelihood: -1.17403e+08	(delta): 11.5046
50 (QN/Block) 	Elapsed: 28.024	Loglikelihood: -1.17403e+08	(delta): 7.56775
51 (QN/Block) 	Elapsed: 27.995	Loglikelihood: -1.17403e+08	(delta): 3.79024
52 (QN/Block) 	Elapsed: 28.122	Loglikelihood: -1.17403e+08	(delta): 2.31296
53 (QN/Block) 	Elapsed: 27.633	Loglikelihood: -1.17403e+08	(delta): 2.29714
54 (QN/Block) 	Elapsed: 27.634	Loglikelihood: -1.17403e+08	(delta): 3.08909
55 (QN/Block) 	Elapsed: 27.48	Loglikelihood: -1.17403e+08	(delta): 3.2907
56 (QN/Block) 	Elapsed: 27.849	Loglikelihood: -1.17403e+08	(delta): 10.0749
57 (QN/Block) 	Elapsed: 27.579	Loglikelihood: -1.17403e+08	(delta): 3.57764
58 (QN/Block) 	Elapsed: 27.959	Loglikelihood: -1.17403e+08	(delta): 9.41952
59 (QN/Block) 	Elapsed: 27.63	Loglikelihood: -1.17403e+08	(delta): 7.34824
60 (QN/Block) 	Elapsed: 27.481	Loglikelihood: -1.17403e+08	(delta): 4.21282
61 (QN/Block) 	Elapsed: 27.708	Loglikelihood: -1.17403e+08	(delta): 3.59289
62 (QN/Block) 	Elapsed: 27.463	Loglikelihood: -1.17403e+08	(delta): 5.65787
63 (QN/Block) 	Elapsed: 27.519	Loglikelihood: -1.17403e+08	(delta): 3.97668
64 (QN/Block) 	Elapsed: 27.507	Loglikelihood: -1.17403e+08	(delta): 4.31164
65 (QN/Block) 	Elapsed: 27.896	Loglikelihood: -1.17403e+08	(delta): 3.48233
66 (QN/Block) 	Elapsed: 27.507	Loglikelihood: -1.17403e+08	(delta): 6.43817
67 (QN/Block) 	Elapsed: 27.611	Loglikelihood: -1.17403e+08	(delta): 3.40806
68 (QN/Block) 	Elapsed: 27.662	Loglikelihood: -1.17403e+08	(delta): 5.44615
69 (QN/Block) 	Elapsed: 27.625	Loglikelihood: -1.17403e+08	(delta): 3.43142
70 (QN/Block) 	Elapsed: 27.686	Loglikelihood: -1.17403e+08	(delta): 5.39583
71 (QN/Block) 	Elapsed: 27.665	Loglikelihood: -1.17403e+08	(delta): 9.35255
72 (QN/Block) 	Elapsed: 27.847	Loglikelihood: -1.17403e+08	(delta): 4.08383
73 (QN/Block) 	Elapsed: 27.586	Loglikelihood: -1.17403e+08	(delta): 5.73085
74 (QN/Block) 	Elapsed: 27.646	Loglikelihood: -1.17403e+08	(delta): 5.51482
75 (QN/Block) 	Elapsed: 27.462	Loglikelihood: -1.17403e+08	(delta): 2.59551
76 (QN/Block) 	Elapsed: 27.806	Loglikelihood: -1.17403e+08	(delta): 6.30654
77 (QN/Block) 	Elapsed: 27.482	Loglikelihood: -1.17403e+08	(delta): 5.76363
78 (QN/Block) 	Elapsed: 27.681	Loglikelihood: -1.17403e+08	(delta): 2.79898
79 (QN/Block) 	Elapsed: 27.915	Loglikelihood: -1.17403e+08	(delta): 1.5533
80 (QN/Block) 	Elapsed: 27.816	Loglikelihood: -1.17403e+08	(delta): 2.16203
81 (QN/Block) 	Elapsed: 27.688	Loglikelihood: -1.17403e+08	(delta): 3.33316
82 (QN/Block) 	Elapsed: 27.96	Loglikelihood: -1.17403e+08	(delta): 2.47219
83 (QN/Block) 	Elapsed: 27.57	Loglikelihood: -1.17403e+08	(delta): 4.69298
84 (QN/Block) 	Elapsed: 27.69	Loglikelihood: -1.17403e+08	(delta): 2.25216
85 (QN/Block) 	Elapsed: 27.53	Loglikelihood: -1.17403e+08	(delta): 7.43456
86 (QN/Block) 	Elapsed: 27.364	Loglikelihood: -1.17403e+08	(delta): 5.19425
87 (QN/Block) 	Elapsed: 27.73	Loglikelihood: -1.17403e+08	(delta): 7.56319
88 (QN/Block) 	Elapsed: 27.486	Loglikelihood: -1.17403e+08	(delta): 23.3225
89 (QN/Block) 	Elapsed: 27.467	Loglikelihood: -1.17403e+08	(delta): 18.9375
90 (QN/Block) 	Elapsed: 27.842	Loglikelihood: -1.17403e+08	(delta): 13.2255
91 (QN/Block) 	Elapsed: 27.585	Loglikelihood: -1.17403e+08	(delta): 15.0294
92 (QN/Block) 	Elapsed: 27.456	Loglikelihood: -1.17403e+08	(delta): 14.6592
93 (QN/Block) 	Elapsed: 27.633	Loglikelihood: -1.17403e+08	(delta): 6.51757
94 (QN/Block) 	Elapsed: 27.612	Loglikelihood: -1.17403e+08	(delta): 6.72223
95 (QN/Block) 	Elapsed: 27.736	Loglikelihood: -1.17403e+08	(delta): 2.57306
96 (QN/Block) 	Elapsed: 27.677	Loglikelihood: -1.17403e+08	(delta): 5.15192
97 (QN/Block) 	Elapsed: 27.651	Loglikelihood: -1.17403e+08	(delta): 17.1672
98 (QN/Block) 	Elapsed: 27.795	Loglikelihood: -1.17403e+08	(delta): 4.89618
99 (QN/Block) 	Elapsed: 27.558	Loglikelihood: -1.17403e+08	(delta): 2.82276
100 (QN/Block) 	Elapsed: 27.652	Loglikelihood: -1.17403e+08	(delta): 2.12491
101 (QN/Block) 	Elapsed: 27.655	Loglikelihood: -1.17403e+08	(delta): 2.08346
102 (QN/Block) 	Elapsed: 27.479	Loglikelihood: -1.17403e+08	(delta): 8.11235
103 (QN/Block) 	Elapsed: 27.48	Loglikelihood: -1.17403e+08	(delta): 8.73321
104 (QN/Block) 	Elapsed: 27.515	Loglikelihood: -1.17403e+08	(delta): 5.79647
105 (QN/Block) 	Elapsed: 27.888	Loglikelihood: -1.17403e+08	(delta): 6.12365
106 (QN/Block) 	Elapsed: 27.538	Loglikelihood: -1.17403e+08	(delta): 7.01168
107 (QN/Block) 	Elapsed: 28.141	Loglikelihood: -1.17402e+08	(delta): 7.68193
108 (QN/Block) 	Elapsed: 28.161	Loglikelihood: -1.17402e+08	(delta): 5.30523
109 (QN/Block) 	Elapsed: 28.063	Loglikelihood: -1.17402e+08	(delta): 3.2526
110 (QN/Block) 	Elapsed: 27.815	Loglikelihood: -1.17402e+08	(delta): 5.38951
111 (QN/Block) 	Elapsed: 27.701	Loglikelihood: -1.17402e+08	(delta): 4.05997
112 (QN/Block) 	Elapsed: 27.932	Loglikelihood: -1.17402e+08	(delta): 3.36741
113 (QN/Block) 	Elapsed: 27.608	Loglikelihood: -1.17402e+08	(delta): 2.57777
114 (QN/Block) 	Elapsed: 27.584	Loglikelihood: -1.17402e+08	(delta): 12.588
115 (QN/Block) 	Elapsed: 27.637	Loglikelihood: -1.17402e+08	(delta): 7.30948
116 (QN/Block) 	Elapsed: 27.539	Loglikelihood: -1.17402e+08	(delta): 7.44976
117 (QN/Block) 	Elapsed: 27.51	Loglikelihood: -1.17402e+08	(delta): 8.29142
118 (QN/Block) 	Elapsed: 27.811	Loglikelihood: -1.17402e+08	(delta): 8.10351
119 (QN/Block) 	Elapsed: 27.557	Loglikelihood: -1.17402e+08	(delta): 5.54583
120 (QN/Block) 	Elapsed: 27.928	Loglikelihood: -1.17402e+08	(delta): 2.10199
121 (QN/Block) 	Elapsed: 28.056	Loglikelihood: -1.17402e+08	(delta): 1.27711
122 (QN/Block) 	Elapsed: 27.798	Loglikelihood: -1.17402e+08	(delta): 3.91143
123 (QN/Block) 	Elapsed: 27.852	Loglikelihood: -1.17402e+08	(delta): 14.1239
124 (QN/Block) 	Elapsed: 28.02	Loglikelihood: -1.17402e+08	(delta): 4.81605
125 (QN/Block) 	Elapsed: 27.724	Loglikelihood: -1.17402e+08	(delta): 9.20991
126 (QN/Block) 	Elapsed: 27.51	Loglikelihood: -1.17402e+08	(delta): 4.42924
127 (QN/Block) 	Elapsed: 27.576	Loglikelihood: -1.17402e+08	(delta): 3.26
128 (QN/Block) 	Elapsed: 27.761	Loglikelihood: -1.17402e+08	(delta): 4.20035
129 (QN/Block) 	Elapsed: 27.871	Loglikelihood: -1.17402e+08	(delta): 2.77423
130 (QN/Block) 	Elapsed: 27.652	Loglikelihood: -1.17402e+08	(delta): 3.576
131 (QN/Block) 	Elapsed: 27.419	Loglikelihood: -1.17402e+08	(delta): 2.39469
132 (QN/Block) 	Elapsed: 27.292	Loglikelihood: -1.17402e+08	(delta): 8.99562
133 (QN/Block) 	Elapsed: 27.696	Loglikelihood: -1.17402e+08	(delta): 3.27775
134 (QN/Block) 	Elapsed: 27.456	Loglikelihood: -1.17402e+08	(delta): 6.50329
135 (QN/Block) 	Elapsed: 27.357	Loglikelihood: -1.17402e+08	(delta): 4.25807
136 (QN/Block) 	Elapsed: 27.355	Loglikelihood: -1.17402e+08	(delta): 8.30313
137 (QN/Block) 	Elapsed: 27.755	Loglikelihood: -1.17402e+08	(delta): 3.98653
138 (QN/Block) 	Elapsed: 27.91	Loglikelihood: -1.17402e+08	(delta): 5.16611
139 (QN/Block) 	Elapsed: 27.493	Loglikelihood: -1.17402e+08	(delta): 10.2036
140 (QN/Block) 	Elapsed: 27.167	Loglikelihood: -1.17402e+08	(delta): 4.06839
141 (QN/Block) 	Elapsed: 27.67	Loglikelihood: -1.17402e+08	(delta): 3.41688
142 (QN/Block) 	Elapsed: 27.926	Loglikelihood: -1.17402e+08	(delta): 3.29063
143 (QN/Block) 	Elapsed: 27.654	Loglikelihood: -1.17402e+08	(delta): 9.05627
144 (QN/Block) 	Elapsed: 27.876	Loglikelihood: -1.17402e+08	(delta): 19.1023
145 (QN/Block) 	Elapsed: 27.604	Loglikelihood: -1.17402e+08	(delta): 4.68329
146 (QN/Block) 	Elapsed: 27.59	Loglikelihood: -1.17402e+08	(delta): 2.79038
147 (QN/Block) 	Elapsed: 27.848	Loglikelihood: -1.17402e+08	(delta): 1.9249
148 (QN/Block) 	Elapsed: 27.97	Loglikelihood: -1.17402e+08	(delta): 1.61248
149 (QN/Block) 	Elapsed: 27.961	Loglikelihood: -1.17402e+08	(delta): 1.63
150 (QN/Block) 	Elapsed: 27.649	Loglikelihood: -1.17402e+08	(delta): 1.62052
151 (QN/Block) 	Elapsed: 27.917	Loglikelihood: -1.17402e+08	(delta): 1.61968
152 (QN/Block) 	Elapsed: 27.889	Loglikelihood: -1.17402e+08	(delta): 1.62427
153 (QN/Block) 	Elapsed: 28.083	Loglikelihood: -1.17402e+08	(delta): 1.62497
154 (QN/Block) 	Elapsed: 27.845	Loglikelihood: -1.17402e+08	(delta): 1.62373
155 (QN/Block) 	Elapsed: 28.056	Loglikelihood: -1.17402e+08	(delta): 1.62974
156 (QN/Block) 	Elapsed: 28.095	Loglikelihood: -1.17402e+08	(delta): 1.64168
157 (QN/Block) 	Elapsed: 28.046	Loglikelihood: -1.17402e+08	(delta): 1.65943
158 (QN/Block) 	Elapsed: 27.62	Loglikelihood: -1.17402e+08	(delta): 1.68488
159 (QN/Block) 	Elapsed: 27.838	Loglikelihood: -1.17402e+08	(delta): 1.71679
160 (QN/Block) 	Elapsed: 27.541	Loglikelihood: -1.17402e+08	(delta): 1.74214
161 (QN/Block) 	Elapsed: 27.869	Loglikelihood: -1.17402e+08	(delta): 1.77793
162 (QN/Block) 	Elapsed: 27.8	Loglikelihood: -1.17402e+08	(delta): 1.82327
163 (QN/Block) 	Elapsed: 27.762	Loglikelihood: -1.17402e+08	(delta): 1.88282
164 (QN/Block) 	Elapsed: 27.825	Loglikelihood: -1.17402e+08	(delta): 1.95712
165 (QN/Block) 	Elapsed: 27.995	Loglikelihood: -1.17402e+08	(delta): 2.0518
166 (QN/Block) 	Elapsed: 27.694	Loglikelihood: -1.17402e+08	(delta): 2.17136
167 (QN/Block) 	Elapsed: 27.771	Loglikelihood: -1.17402e+08	(delta): 5.80809
168 (QN/Block) 	Elapsed: 27.875	Loglikelihood: -1.17402e+08	(delta): 5.28887
169 (QN/Block) 	Elapsed: 27.891	Loglikelihood: -1.17402e+08	(delta): 1.73615
170 (QN/Block) 	Elapsed: 28.01	Loglikelihood: -1.17402e+08	(delta): 1.83211
171 (QN/Block) 	Elapsed: 27.708	Loglikelihood: -1.17402e+08	(delta): 1.99416
172 (QN/Block) 	Elapsed: 27.757	Loglikelihood: -1.17402e+08	(delta): 4.51678
173 (QN/Block) 	Elapsed: 27.946	Loglikelihood: -1.17402e+08	(delta): 7.15009
174 (QN/Block) 	Elapsed: 27.901	Loglikelihood: -1.17402e+08	(delta): 4.03385
175 (QN/Block) 	Elapsed: 27.775	Loglikelihood: -1.17402e+08	(delta): 2.54529
176 (QN/Block) 	Elapsed: 28.057	Loglikelihood: -1.17402e+08	(delta): 3.06596
177 (QN/Block) 	Elapsed: 28.26	Loglikelihood: -1.17402e+08	(delta): 4.00241
178 (QN/Block) 	Elapsed: 27.911	Loglikelihood: -1.17402e+08	(delta): 5.34703
179 (QN/Block) 	Elapsed: 27.939	Loglikelihood: -1.17402e+08	(delta): 6.88429
180 (QN/Block) 	Elapsed: 28.029	Loglikelihood: -1.17402e+08	(delta): 9.98636
181 (QN/Block) 	Elapsed: 28.11	Loglikelihood: -1.17402e+08	(delta): 3.59651
182 (QN/Block) 	Elapsed: 27.776	Loglikelihood: -1.17402e+08	(delta): 13.547
183 (QN/Block) 	Elapsed: 27.627	Loglikelihood: -1.17402e+08	(delta): 5.51929
184 (QN/Block) 	Elapsed: 27.744	Loglikelihood: -1.17402e+08	(delta): 11.6884
185 (QN/Block) 	Elapsed: 27.926	Loglikelihood: -1.17402e+08	(delta): 6.88338
186 (QN/Block) 	Elapsed: 27.51	Loglikelihood: -1.17402e+08	(delta): 2.9851
187 (QN/Block) 	Elapsed: 27.324	Loglikelihood: -1.17402e+08	(delta): 3.13219
188 (QN/Block) 	Elapsed: 27.262	Loglikelihood: -1.17402e+08	(delta): 9.10285
189 (QN/Block) 	Elapsed: 27.523	Loglikelihood: -1.17402e+08	(delta): 2.95979
190 (QN/Block) 	Elapsed: 27.586	Loglikelihood: -1.17402e+08	(delta): 4.95354
191 (QN/Block) 	Elapsed: 27.703	Loglikelihood: -1.17402e+08	(delta): 1.74178
192 (QN/Block) 	Elapsed: 28.184	Loglikelihood: -1.17402e+08	(delta): 0.619258
193 (QN/Block) 	Elapsed: 28.172	Loglikelihood: -1.17402e+08	(delta): 0.590871
194 (QN/Block) 	Elapsed: 28.247	Loglikelihood: -1.17402e+08	(delta): 0.604862
195 (QN/Block) 	Elapsed: 27.887	Loglikelihood: -1.17402e+08	(delta): 0.640653
196 (QN/Block) 	Elapsed: 27.717	Loglikelihood: -1.17402e+08	(delta): 0.698526
197 (QN/Block) 	Elapsed: 28.09	Loglikelihood: -1.17402e+08	(delta): 0.777972
198 (QN/Block) 	Elapsed: 27.751	Loglikelihood: -1.17402e+08	(delta): 0.883458
199 (QN/Block) 	Elapsed: 27.588	Loglikelihood: -1.17402e+08	(delta): 2.14673
200 (QN/Block) 	Elapsed: 27.615	Loglikelihood: -1.17402e+08	(delta): 4.80641
201 (QN/Block) 	Elapsed: 27.887	Loglikelihood: -1.17402e+08	(delta): 1.16052
202 (QN/Block) 	Elapsed: 27.926	Loglikelihood: -1.17402e+08	(delta): 1.18469
203 (QN/Block) 	Elapsed: 27.848	Loglikelihood: -1.17402e+08	(delta): 1.26461
204 (QN/Block) 	Elapsed: 27.918	Loglikelihood: -1.17402e+08	(delta): 1.38553
205 (QN/Block) 	Elapsed: 28.213	Loglikelihood: -1.17402e+08	(delta): 1.55559
206 (QN/Block) 	Elapsed: 28.014	Loglikelihood: -1.17402e+08	(delta): 1.78633
207 (QN/Block) 	Elapsed: 28.476	Loglikelihood: -1.17402e+08	(delta): 2.09998
208 (QN/Block) 	Elapsed: 27.795	Loglikelihood: -1.17402e+08	(delta): 2.52728
209 (QN/Block) 	Elapsed: 28.392	Loglikelihood: -1.17402e+08	(delta): 1.22175
210 (QN/Block) 	Elapsed: 27.87	Loglikelihood: -1.17402e+08	(delta): 0.688312
211 (QN/Block) 	Elapsed: 27.61	Loglikelihood: -1.17402e+08	(delta): 3.44711
212 (QN/Block) 	Elapsed: 27.649	Loglikelihood: -1.17402e+08	(delta): 1.78045
213 (QN/Block) 	Elapsed: 27.802	Loglikelihood: -1.17402e+08	(delta): 0.890109
214 (QN/Block) 	Elapsed: 27.866	Loglikelihood: -1.17402e+08	(delta): 4.95467
215 (QN/Block) 	Elapsed: 27.71	Loglikelihood: -1.17402e+08	(delta): 1.79454
216 (QN/Block) 	Elapsed: 27.606	Loglikelihood: -1.17402e+08	(delta): 1.13821
217 (QN/Block) 	Elapsed: 27.639	Loglikelihood: -1.17402e+08	(delta): 0.939554
218 (QN/Block) 	Elapsed: 27.807	Loglikelihood: -1.17402e+08	(delta): 1.09828
219 (QN/Block) 	Elapsed: 27.551	Loglikelihood: -1.17402e+08	(delta): 0.395542
220 (QN/Block) 	Elapsed: 27.841	Loglikelihood: -1.17402e+08	(delta): 0.886043
221 (QN/Block) 	Elapsed: 27.808	Loglikelihood: -1.17402e+08	(delta): 0.515459
222 (QN/Block) 	Elapsed: 27.591	Loglikelihood: -1.17402e+08	(delta): 0.739351
223 (QN/Block) 	Elapsed: 27.564	Loglikelihood: -1.17402e+08	(delta): 0.230461
224 (QN/Block) 	Elapsed: 27.613	Loglikelihood: -1.17402e+08	(delta): 0.347032
225 (QN/Block) 	Elapsed: 27.879	Loglikelihood: -1.17402e+08	(delta): 0.190087
226 (QN/Block) 	Elapsed: 27.642	Loglikelihood: -1.17402e+08	(delta): 0.410723
227 (QN/Block) 	Elapsed: 27.536	Loglikelihood: -1.17402e+08	(delta): 0.186234
228 (QN/Block) 	Elapsed: 27.341	Loglikelihood: -1.17402e+08	(delta): 0.102502
229 (QN/Block) 	Elapsed: 27.869	Loglikelihood: -1.17402e+08	(delta): 0.0523783
230 (QN/Block) 	Elapsed: 27.455	Loglikelihood: -1.17402e+08	(delta): 0.147187
231 (QN/Block) 	Elapsed: 28.007	Loglikelihood: -1.17402e+08	(delta): 0.0555948
232 (QN/Block) 	Elapsed: 27.89	Loglikelihood: -1.17402e+08	(delta): 0.176686
233 (QN/Block) 	Elapsed: 28.173	Loglikelihood: -1.17402e+08	(delta): 0.0313054
234 (QN/Block) 	Elapsed: 27.891	Loglikelihood: -1.17402e+08	(delta): 0.284006
235 (QN/Block) 	Elapsed: 27.861	Loglikelihood: -1.17402e+08	(delta): 0.123977
236 (QN/Block) 	Elapsed: 28.057	Loglikelihood: -1.17402e+08	(delta): 0.108681
237 (QN/Block) 	Elapsed: 28	Loglikelihood: -1.17402e+08	(delta): 0.255553
238 (QN/Block) 	Elapsed: 27.552	Loglikelihood: -1.17402e+08	(delta): 0.178853
239 (QN/Block) 	Elapsed: 27.645	Loglikelihood: -1.17402e+08	(delta): 1.23422
240 (QN/Block) 	Elapsed: 27.628	Loglikelihood: -1.17402e+08	(delta): 0.681396
241 (QN/Block) 	Elapsed: 27.768	Loglikelihood: -1.17402e+08	(delta): 0.62781
242 (QN/Block) 	Elapsed: 27.879	Loglikelihood: -1.17402e+08	(delta): 0.290238
243 (QN/Block) 	Elapsed: 27.737	Loglikelihood: -1.17402e+08	(delta): 0.539478
244 (QN/Block) 	Elapsed: 27.781	Loglikelihood: -1.17402e+08	(delta): 0.614815
245 (QN/Block) 	Elapsed: 27.633	Loglikelihood: -1.17402e+08	(delta): 0.228017
246 (QN/Block) 	Elapsed: 27.948	Loglikelihood: -1.17402e+08	(delta): 0.135205
247 (QN/Block) 	Elapsed: 27.906	Loglikelihood: -1.17402e+08	(delta): 0.18797
248 (QN/Block) 	Elapsed: 28.033	Loglikelihood: -1.17402e+08	(delta): 0.479446
249 (QN/Block) 	Elapsed: 28.176	Loglikelihood: -1.17402e+08	(delta): 0.176259
250 (QN/Block) 	Elapsed: 27.939	Loglikelihood: -1.17402e+08	(delta): 0.158614
251 (QN/Block) 	Elapsed: 27.834	Loglikelihood: -1.17402e+08	(delta): 0.0562657
252 (QN/Block) 	Elapsed: 27.875	Loglikelihood: -1.17402e+08	(delta): 0.100298
253 (QN/Block) 	Elapsed: 27.703	Loglikelihood: -1.17402e+08	(delta): 0.021275
254 (QN/Block) 	Elapsed: 27.899	Loglikelihood: -1.17402e+08	(delta): 0.0497672
255 (QN/Block) 	Elapsed: 27.728	Loglikelihood: -1.17402e+08	(delta): 0.0147046
256 (QN/Block) 	Elapsed: 27.67	Loglikelihood: -1.17402e+08	(delta): 0.0353978
257 (QN/Block) 	Elapsed: 27.623	Loglikelihood: -1.17402e+08	(delta): 0.0120101
258 (QN/Block) 	Elapsed: 27.492	Loglikelihood: -1.17402e+08	(delta): 0.0435705
259 (QN/Block) 	Elapsed: 27.581	Loglikelihood: -1.17402e+08	(delta): 0.0120282
260 (QN/Block) 	Elapsed: 27.628	Loglikelihood: -1.17402e+08	(delta): 0.00630744
261 (QN/Block) 	Elapsed: 27.485	Loglikelihood: -1.17402e+08	(delta): 0.00523059
262 (QN/Block) 	Elapsed: 27.361	Loglikelihood: -1.17402e+08	(delta): 0.00769629
263 (QN/Block) 	Elapsed: 27.764	Loglikelihood: -1.17402e+08	(delta): 0.00278047
264 (QN/Block) 	Elapsed: 27.522	Loglikelihood: -1.17402e+08	(delta): 0.00351886
265 (QN/Block) 	Elapsed: 27.631	Loglikelihood: -1.17402e+08	(delta): 0.00835797
266 (QN/Block) 	Elapsed: 27.762	Loglikelihood: -1.17402e+08	(delta): 0.0054169
267 (QN/Block) 	Elapsed: 27.698	Loglikelihood: -1.17402e+08	(delta): 0.00342138
268 (QN/Block) 	Elapsed: 27.669	Loglikelihood: -1.17402e+08	(delta): 0.00141694
269 (QN/Block) 	Elapsed: 27.538	Loglikelihood: -1.17402e+08	(delta): 0.00422062
270 (QN/Block) 	Elapsed: 27.998	Loglikelihood: -1.17402e+08	(delta): 0.0056753
271 (QN/Block) 	Elapsed: 27.765	Loglikelihood: -1.17402e+08	(delta): 0.00134972
272 (QN/Block) 	Elapsed: 27.894	Loglikelihood: -1.17402e+08	(delta): 0.000745609
273 (QN/Block) 	Elapsed: 27.816	Loglikelihood: -1.17402e+08	(delta): 0.000590429
274 (QN/Block) 	Elapsed: 27.77	Loglikelihood: -1.17402e+08	(delta): 0.000839725
275 (QN/Block) 	Elapsed: 27.596	Loglikelihood: -1.17402e+08	(delta): 0.000618875
276 (QN/Block) 	Elapsed: 27.705	Loglikelihood: -1.17402e+08	(delta): 0.000443771
277 (QN/Block) 	Elapsed: 27.627	Loglikelihood: -1.17402e+08	(delta): 0.000260875
278 (QN/Block) 	Elapsed: 27.668	Loglikelihood: -1.17402e+08	(delta): 0.000282735
279 (QN/Block) 	Elapsed: 27.762	Loglikelihood: -1.17402e+08	(delta): 0.000323638
280 (QN/Block) 	Elapsed: 27.753	Loglikelihood: -1.17402e+08	(delta): 0.000241399
281 (QN/Block) 	Elapsed: 27.472	Loglikelihood: -1.17402e+08	(delta): 0.000156283
282 (QN/Block) 	Elapsed: 27.878	Loglikelihood: -1.17402e+08	(delta): 0.000168443
283 (QN/Block) 	Elapsed: 27.812	Loglikelihood: -1.17402e+08	(delta): 0.000198349
284 (QN/Block) 	Elapsed: 27.618	Loglikelihood: -1.17402e+08	(delta): 0.000157475
285 (QN/Block) 	Elapsed: 27.645	Loglikelihood: -1.17402e+08	(delta): 0.000103548
286 (QN/Block) 	Elapsed: 27.818	Loglikelihood: -1.17402e+08	(delta): 0.000104755
287 (QN/Block) 	Elapsed: 27.68	Loglikelihood: -1.17402e+08	(delta): 0.000123158
288 (QN/Block) 	Elapsed: 27.698	Loglikelihood: -1.17402e+08	(delta): 0.000101656
289 (QN/Block) 	Elapsed: 27.395	Loglikelihood: -1.17402e+08	(delta): 6.8903e-05
Summary: 
Converged in 289 iterations (8081.48 sec)
Loglikelihood: -117402053.430838
Fst divergences between estimated populations: 
	Pop0	Pop1	Pop2	Pop3	Pop4	
Pop0	
Pop1	0.033	
Pop2	0.033	0.023	
Pop3	0.032	0.024	0.023	
Pop4	0.037	0.034	0.031	0.032	
Pop5	0.035	0.027	0.027	0.027	0.035	
CV error (K=6): 0.54503
Writing output files.
****                   ADMIXTURE Version 1.3.0                  ****
****                    Copyright 2008-2015                     ****
****           David Alexander, Suyash Shringarpure,            ****
****                John  Novembre, Ken Lange                   ****
****                                                            ****
****                 Please cite our paper!                     ****
****   Information at www.genetics.ucla.edu/software/admixture  ****

Cross-validation will be performed.  Folds=5.
Parallel execution requested.  Will use 28 threads.
Random seed: 854534
Point estimation method: Block relaxation algorithm
Convergence acceleration algorithm: QuasiNewton, 3 secant conditions
Point estimation will terminate when objective function delta < 0.0001
Estimation of standard errors disabled; will compute point estimates only.
Size of G: 1240x94854
Performing five EM steps to prime main algorithm
1 (EM) 	Elapsed: 5.261	Loglikelihood: -1.23375e+08	(delta): 5.06485e+07
2 (EM) 	Elapsed: 5.581	Loglikelihood: -1.20264e+08	(delta): 3.11153e+06
3 (EM) 	Elapsed: 5.596	Loglikelihood: -1.19584e+08	(delta): 680184
4 (EM) 	Elapsed: 5.689	Loglikelihood: -1.1919e+08	(delta): 393622
5 (EM) 	Elapsed: 5.618	Loglikelihood: -1.18899e+08	(delta): 291468
Initial loglikelihood: -1.18899e+08
Starting main algorithm
1 (QN/Block) 	Elapsed: 22.923	Loglikelihood: -1.17436e+08	(delta): 1.46304e+06
2 (QN/Block) 	Elapsed: 22.729	Loglikelihood: -1.17416e+08	(delta): 19209.2
3 (QN/Block) 	Elapsed: 22.892	Loglikelihood: -1.17392e+08	(delta): 24535.1
4 (QN/Block) 	Elapsed: 22.956	Loglikelihood: -1.1737e+08	(delta): 21592.9
5 (QN/Block) 	Elapsed: 23.158	Loglikelihood: -1.17364e+08	(delta): 6243.11
6 (QN/Block) 	Elapsed: 22.784	Loglikelihood: -1.17358e+08	(delta): 5684.93
7 (QN/Block) 	Elapsed: 22.896	Loglikelihood: -1.17354e+08	(delta): 4635
8 (QN/Block) 	Elapsed: 23.155	Loglikelihood: -1.17352e+08	(delta): 1629.56
9 (QN/Block) 	Elapsed: 22.992	Loglikelihood: -1.1735e+08	(delta): 2026.85
10 (QN/Block) 	Elapsed: 23.019	Loglikelihood: -1.17348e+08	(delta): 2371.11
11 (QN/Block) 	Elapsed: 22.99	Loglikelihood: -1.17347e+08	(delta): 502.462
12 (QN/Block) 	Elapsed: 22.811	Loglikelihood: -1.17346e+08	(delta): 876.663
13 (QN/Block) 	Elapsed: 22.924	Loglikelihood: -1.17346e+08	(delta): 698.566
14 (QN/Block) 	Elapsed: 22.911	Loglikelihood: -1.17345e+08	(delta): 338.541
15 (QN/Block) 	Elapsed: 22.638	Loglikelihood: -1.17345e+08	(delta): 375.824
16 (QN/Block) 	Elapsed: 22.613	Loglikelihood: -1.17345e+08	(delta): 225.846
17 (QN/Block) 	Elapsed: 22.66	Loglikelihood: -1.17344e+08	(delta): 141.722
18 (QN/Block) 	Elapsed: 22.61	Loglikelihood: -1.17344e+08	(delta): 291.118
19 (QN/Block) 	Elapsed: 22.702	Loglikelihood: -1.17344e+08	(delta): 168.617
20 (QN/Block) 	Elapsed: 22.619	Loglikelihood: -1.17344e+08	(delta): 121.235
21 (QN/Block) 	Elapsed: 22.701	Loglikelihood: -1.17344e+08	(delta): 85.3994
22 (QN/Block) 	Elapsed: 22.439	Loglikelihood: -1.17344e+08	(delta): 120.962
23 (QN/Block) 	Elapsed: 22.668	Loglikelihood: -1.17344e+08	(delta): 81.5051
24 (QN/Block) 	Elapsed: 22.685	Loglikelihood: -1.17344e+08	(delta): 51.3072
25 (QN/Block) 	Elapsed: 22.266	Loglikelihood: -1.17343e+08	(delta): 38.8799
26 (QN/Block) 	Elapsed: 22.398	Loglikelihood: -1.17343e+08	(delta): 111.085
27 (QN/Block) 	Elapsed: 22.774	Loglikelihood: -1.17343e+08	(delta): 109.152
28 (QN/Block) 	Elapsed: 22.853	Loglikelihood: -1.17343e+08	(delta): 49.593
29 (QN/Block) 	Elapsed: 22.803	Loglikelihood: -1.17343e+08	(delta): 42.7842
30 (QN/Block) 	Elapsed: 22.859	Loglikelihood: -1.17343e+08	(delta): 37.743
31 (QN/Block) 	Elapsed: 22.912	Loglikelihood: -1.17343e+08	(delta): 22.9152
32 (QN/Block) 	Elapsed: 22.92	Loglikelihood: -1.17343e+08	(delta): 14.7138
33 (QN/Block) 	Elapsed: 22.684	Loglikelihood: -1.17343e+08	(delta): 15.9406
34 (QN/Block) 	Elapsed: 22.702	Loglikelihood: -1.17343e+08	(delta): 43.035
35 (QN/Block) 	Elapsed: 22.783	Loglikelihood: -1.17343e+08	(delta): 25.0817
36 (QN/Block) 	Elapsed: 22.546	Loglikelihood: -1.17343e+08	(delta): 23.8589
37 (QN/Block) 	Elapsed: 22.987	Loglikelihood: -1.17343e+08	(delta): 14.97
38 (QN/Block) 	Elapsed: 22.517	Loglikelihood: -1.17343e+08	(delta): 37.6074
39 (QN/Block) 	Elapsed: 22.827	Loglikelihood: -1.17343e+08	(delta): 41.0576
40 (QN/Block) 	Elapsed: 22.916	Loglikelihood: -1.17343e+08	(delta): 27.5363
41 (QN/Block) 	Elapsed: 22.452	Loglikelihood: -1.17343e+08	(delta): 24.3076
42 (QN/Block) 	Elapsed: 22.503	Loglikelihood: -1.17343e+08	(delta): 23.7734
43 (QN/Block) 	Elapsed: 22.527	Loglikelihood: -1.17343e+08	(delta): 15.3321
44 (QN/Block) 	Elapsed: 22.624	Loglikelihood: -1.17343e+08	(delta): 20.8689
45 (QN/Block) 	Elapsed: 22.313	Loglikelihood: -1.17343e+08	(delta): 19.788
46 (QN/Block) 	Elapsed: 22.414	Loglikelihood: -1.17343e+08	(delta): 21.8586
47 (QN/Block) 	Elapsed: 22.597	Loglikelihood: -1.17343e+08	(delta): 20.9425
48 (QN/Block) 	Elapsed: 22.587	Loglikelihood: -1.17343e+08	(delta): 28.3615
49 (QN/Block) 	Elapsed: 22.761	Loglikelihood: -1.17343e+08	(delta): 33.2952
50 (QN/Block) 	Elapsed: 22.758	Loglikelihood: -1.17343e+08	(delta): 21.4499
51 (QN/Block) 	Elapsed: 22.704	Loglikelihood: -1.17343e+08	(delta): 47.7734
52 (QN/Block) 	Elapsed: 22.754	Loglikelihood: -1.17343e+08	(delta): 24.4586
53 (QN/Block) 	Elapsed: 22.732	Loglikelihood: -1.17343e+08	(delta): 49.9907
54 (QN/Block) 	Elapsed: 22.81	Loglikelihood: -1.17343e+08	(delta): 18.9397
55 (QN/Block) 	Elapsed: 22.913	Loglikelihood: -1.17342e+08	(delta): 19.7767
56 (QN/Block) 	Elapsed: 22.677	Loglikelihood: -1.17342e+08	(delta): 28.5172
57 (QN/Block) 	Elapsed: 22.731	Loglikelihood: -1.17342e+08	(delta): 25.556
58 (QN/Block) 	Elapsed: 22.635	Loglikelihood: -1.17342e+08	(delta): 21.3848
59 (QN/Block) 	Elapsed: 22.983	Loglikelihood: -1.17342e+08	(delta): 34.7842
60 (QN/Block) 	Elapsed: 22.604	Loglikelihood: -1.17342e+08	(delta): 32.4708
61 (QN/Block) 	Elapsed: 22.861	Loglikelihood: -1.17342e+08	(delta): 20.3031
62 (QN/Block) 	Elapsed: 22.717	Loglikelihood: -1.17342e+08	(delta): 14.1791
63 (QN/Block) 	Elapsed: 22.846	Loglikelihood: -1.17342e+08	(delta): 27.8109
64 (QN/Block) 	Elapsed: 22.791	Loglikelihood: -1.17342e+08	(delta): 24.8567
65 (QN/Block) 	Elapsed: 22.666	Loglikelihood: -1.17342e+08	(delta): 22.4232
66 (QN/Block) 	Elapsed: 23.001	Loglikelihood: -1.17342e+08	(delta): 10.0658
67 (QN/Block) 	Elapsed: 22.992	Loglikelihood: -1.17342e+08	(delta): 12.1893
68 (QN/Block) 	Elapsed: 22.967	Loglikelihood: -1.17342e+08	(delta): 14.0996
69 (QN/Block) 	Elapsed: 23.056	Loglikelihood: -1.17342e+08	(delta): 7.38755
70 (QN/Block) 	Elapsed: 22.761	Loglikelihood: -1.17342e+08	(delta): 43.669
71 (QN/Block) 	Elapsed: 22.78	Loglikelihood: -1.17342e+08	(delta): 26.067
72 (QN/Block) 	Elapsed: 22.699	Loglikelihood: -1.17342e+08	(delta): 18.1301
73 (QN/Block) 	Elapsed: 22.637	Loglikelihood: -1.17342e+08	(delta): 13.3157
74 (QN/Block) 	Elapsed: 22.79	Loglikelihood: -1.17342e+08	(delta): 17.0058
75 (QN/Block) 	Elapsed: 22.59	Loglikelihood: -1.17342e+08	(delta): 9.86052
76 (QN/Block) 	Elapsed: 22.774	Loglikelihood: -1.17342e+08	(delta): 12.8109
77 (QN/Block) 	Elapsed: 22.488	Loglikelihood: -1.17342e+08	(delta): 7.52015
78 (QN/Block) 	Elapsed: 22.651	Loglikelihood: -1.17342e+08	(delta): 22.661
79 (QN/Block) 	Elapsed: 22.623	Loglikelihood: -1.17342e+08	(delta): 15.7555
80 (QN/Block) 	Elapsed: 22.808	Loglikelihood: -1.17342e+08	(delta): 11.455
81 (QN/Block) 	Elapsed: 22.476	Loglikelihood: -1.17342e+08	(delta): 10.555
82 (QN/Block) 	Elapsed: 22.73	Loglikelihood: -1.17342e+08	(delta): 8.42763
83 (QN/Block) 	Elapsed: 22.791	Loglikelihood: -1.17342e+08	(delta): 9.2362
84 (QN/Block) 	Elapsed: 22.909	Loglikelihood: -1.17342e+08	(delta): 5.69193
85 (QN/Block) 	Elapsed: 22.832	Loglikelihood: -1.17342e+08	(delta): 7.86169
86 (QN/Block) 	Elapsed: 22.768	Loglikelihood: -1.17342e+08	(delta): 7.87287
87 (QN/Block) 	Elapsed: 22.891	Loglikelihood: -1.17342e+08	(delta): 3.1402
88 (QN/Block) 	Elapsed: 22.768	Loglikelihood: -1.17342e+08	(delta): 12.6957
89 (QN/Block) 	Elapsed: 22.567	Loglikelihood: -1.17342e+08	(delta): 12.3731
90 (QN/Block) 	Elapsed: 22.536	Loglikelihood: -1.17342e+08	(delta): 5.08045
91 (QN/Block) 	Elapsed: 22.634	Loglikelihood: -1.17342e+08	(delta): 3.86628
92 (QN/Block) 	Elapsed: 22.686	Loglikelihood: -1.17342e+08	(delta): 10.6656
93 (QN/Block) 	Elapsed: 22.8	Loglikelihood: -1.17342e+08	(delta): 5.8529
94 (QN/Block) 	Elapsed: 23.109	Loglikelihood: -1.17342e+08	(delta): 3.35531
95 (QN/Block) 	Elapsed: 22.725	Loglikelihood: -1.17342e+08	(delta): 15.7303
96 (QN/Block) 	Elapsed: 22.657	Loglikelihood: -1.17342e+08	(delta): 3.33198
97 (QN/Block) 	Elapsed: 22.89	Loglikelihood: -1.17342e+08	(delta): 4.70869
98 (QN/Block) 	Elapsed: 22.844	Loglikelihood: -1.17342e+08	(delta): 6.43622
99 (QN/Block) 	Elapsed: 22.573	Loglikelihood: -1.17342e+08	(delta): 5.98362
100 (QN/Block) 	Elapsed: 22.897	Loglikelihood: -1.17342e+08	(delta): 4.88626
101 (QN/Block) 	Elapsed: 22.491	Loglikelihood: -1.17342e+08	(delta): 1.89963
102 (QN/Block) 	Elapsed: 22.786	Loglikelihood: -1.17342e+08	(delta): 8.66396
103 (QN/Block) 	Elapsed: 22.577	Loglikelihood: -1.17342e+08	(delta): 13.5186
104 (QN/Block) 	Elapsed: 23.021	Loglikelihood: -1.17342e+08	(delta): 5.14335
105 (QN/Block) 	Elapsed: 22.798	Loglikelihood: -1.17342e+08	(delta): 14.8945
106 (QN/Block) 	Elapsed: 22.864	Loglikelihood: -1.17342e+08	(delta): 17.6545
107 (QN/Block) 	Elapsed: 22.869	Loglikelihood: -1.17342e+08	(delta): 4.74228
108 (QN/Block) 	Elapsed: 22.87	Loglikelihood: -1.17342e+08	(delta): 16.0585
109 (QN/Block) 	Elapsed: 22.601	Loglikelihood: -1.17342e+08	(delta): 5.75408
110 (QN/Block) 	Elapsed: 22.55	Loglikelihood: -1.17342e+08	(delta): 4.13815
111 (QN/Block) 	Elapsed: 22.809	Loglikelihood: -1.17342e+08	(delta): 3.30864
112 (QN/Block) 	Elapsed: 22.503	Loglikelihood: -1.17342e+08	(delta): 9.66708
113 (QN/Block) 	Elapsed: 22.587	Loglikelihood: -1.17342e+08	(delta): 5.44117
114 (QN/Block) 	Elapsed: 22.535	Loglikelihood: -1.17342e+08	(delta): 2.55075
115 (QN/Block) 	Elapsed: 22.723	Loglikelihood: -1.17342e+08	(delta): 4.2655
116 (QN/Block) 	Elapsed: 22.724	Loglikelihood: -1.17342e+08	(delta): 4.1784
117 (QN/Block) 	Elapsed: 22.623	Loglikelihood: -1.17342e+08	(delta): 1.84953
118 (QN/Block) 	Elapsed: 22.635	Loglikelihood: -1.17342e+08	(delta): 2.00501
119 (QN/Block) 	Elapsed: 22.751	Loglikelihood: -1.17342e+08	(delta): 1.71554
120 (QN/Block) 	Elapsed: 22.836	Loglikelihood: -1.17342e+08	(delta): 2.90794
121 (QN/Block) 	Elapsed: 22.937	Loglikelihood: -1.17342e+08	(delta): 1.39743
122 (QN/Block) 	Elapsed: 22.749	Loglikelihood: -1.17342e+08	(delta): 1.32468
123 (QN/Block) 	Elapsed: 22.69	Loglikelihood: -1.17342e+08	(delta): 1.2774
124 (QN/Block) 	Elapsed: 22.613	Loglikelihood: -1.17342e+08	(delta): 1.28419
125 (QN/Block) 	Elapsed: 22.805	Loglikelihood: -1.17342e+08	(delta): 1.90709
126 (QN/Block) 	Elapsed: 22.812	Loglikelihood: -1.17342e+08	(delta): 0.564399
127 (QN/Block) 	Elapsed: 22.91	Loglikelihood: -1.17342e+08	(delta): 4.05963
128 (QN/Block) 	Elapsed: 22.845	Loglikelihood: -1.17342e+08	(delta): 1.96481
129 (QN/Block) 	Elapsed: 22.995	Loglikelihood: -1.17342e+08	(delta): 3.16752
130 (QN/Block) 	Elapsed: 22.558	Loglikelihood: -1.17342e+08	(delta): 1.09329
131 (QN/Block) 	Elapsed: 22.901	Loglikelihood: -1.17342e+08	(delta): 0.707852
132 (QN/Block) 	Elapsed: 22.587	Loglikelihood: -1.17342e+08	(delta): 0.833274
133 (QN/Block) 	Elapsed: 22.551	Loglikelihood: -1.17342e+08	(delta): 0.311943
134 (QN/Block) 	Elapsed: 22.651	Loglikelihood: -1.17342e+08	(delta): 0.500291
135 (QN/Block) 	Elapsed: 22.546	Loglikelihood: -1.17342e+08	(delta): 0.615412
136 (QN/Block) 	Elapsed: 22.77	Loglikelihood: -1.17342e+08	(delta): 0.342998
137 (QN/Block) 	Elapsed: 22.674	Loglikelihood: -1.17342e+08	(delta): 0.77528
138 (QN/Block) 	Elapsed: 22.628	Loglikelihood: -1.17342e+08	(delta): 0.607397
139 (QN/Block) 	Elapsed: 22.698	Loglikelihood: -1.17342e+08	(delta): 0.888898
140 (QN/Block) 	Elapsed: 22.848	Loglikelihood: -1.17342e+08	(delta): 0.281578
141 (QN/Block) 	Elapsed: 22.683	Loglikelihood: -1.17342e+08	(delta): 1.07276
142 (QN/Block) 	Elapsed: 22.603	Loglikelihood: -1.17342e+08	(delta): 1.01191
143 (QN/Block) 	Elapsed: 22.799	Loglikelihood: -1.17342e+08	(delta): 0.399998
144 (QN/Block) 	Elapsed: 22.54	Loglikelihood: -1.17342e+08	(delta): 0.165873
145 (QN/Block) 	Elapsed: 22.61	Loglikelihood: -1.17342e+08	(delta): 0.505032
146 (QN/Block) 	Elapsed: 22.86	Loglikelihood: -1.17342e+08	(delta): 0.204126
147 (QN/Block) 	Elapsed: 22.713	Loglikelihood: -1.17342e+08	(delta): 0.278948
148 (QN/Block) 	Elapsed: 22.739	Loglikelihood: -1.17342e+08	(delta): 0.127363
149 (QN/Block) 	Elapsed: 22.592	Loglikelihood: -1.17342e+08	(delta): 0.226628
150 (QN/Block) 	Elapsed: 22.686	Loglikelihood: -1.17342e+08	(delta): 0.103245
151 (QN/Block) 	Elapsed: 22.77	Loglikelihood: -1.17342e+08	(delta): 0.509333
152 (QN/Block) 	Elapsed: 22.703	Loglikelihood: -1.17342e+08	(delta): 0.226603
153 (QN/Block) 	Elapsed: 22.704	Loglikelihood: -1.17342e+08	(delta): 0.275178
154 (QN/Block) 	Elapsed: 22.873	Loglikelihood: -1.17342e+08	(delta): 0.0826333
155 (QN/Block) 	Elapsed: 22.677	Loglikelihood: -1.17342e+08	(delta): 0.196519
156 (QN/Block) 	Elapsed: 22.75	Loglikelihood: -1.17342e+08	(delta): 0.181631
157 (QN/Block) 	Elapsed: 22.942	Loglikelihood: -1.17342e+08	(delta): 0.262525
158 (QN/Block) 	Elapsed: 22.571	Loglikelihood: -1.17342e+08	(delta): 0.0728472
159 (QN/Block) 	Elapsed: 23.077	Loglikelihood: -1.17342e+08	(delta): 0.214191
160 (QN/Block) 	Elapsed: 23.099	Loglikelihood: -1.17342e+08	(delta): 0.097977
161 (QN/Block) 	Elapsed: 22.702	Loglikelihood: -1.17342e+08	(delta): 0.350915
162 (QN/Block) 	Elapsed: 22.668	Loglikelihood: -1.17342e+08	(delta): 0.0860687
163 (QN/Block) 	Elapsed: 22.815	Loglikelihood: -1.17342e+08	(delta): 0.453614
164 (QN/Block) 	Elapsed: 22.806	Loglikelihood: -1.17342e+08	(delta): 0.111661
165 (QN/Block) 	Elapsed: 22.747	Loglikelihood: -1.17342e+08	(delta): 1.08474
166 (QN/Block) 	Elapsed: 22.538	Loglikelihood: -1.17342e+08	(delta): 0.520895
167 (QN/Block) 	Elapsed: 22.737	Loglikelihood: -1.17342e+08	(delta): 1.13794
168 (QN/Block) 	Elapsed: 22.717	Loglikelihood: -1.17342e+08	(delta): 0.646268
169 (QN/Block) 	Elapsed: 22.746	Loglikelihood: -1.17342e+08	(delta): 2.46006
170 (QN/Block) 	Elapsed: 22.872	Loglikelihood: -1.17342e+08	(delta): 1.86132
171 (QN/Block) 	Elapsed: 23.186	Loglikelihood: -1.17342e+08	(delta): 0.654845
172 (QN/Block) 	Elapsed: 22.87	Loglikelihood: -1.17342e+08	(delta): 0.576171
173 (QN/Block) 	Elapsed: 22.994	Loglikelihood: -1.17342e+08	(delta): 0.407416
174 (QN/Block) 	Elapsed: 23.115	Loglikelihood: -1.17342e+08	(delta): 0.397175
175 (QN/Block) 	Elapsed: 23.012	Loglikelihood: -1.17342e+08	(delta): 0.419051
176 (QN/Block) 	Elapsed: 23.126	Loglikelihood: -1.17342e+08	(delta): 0.454576
177 (QN/Block) 	Elapsed: 22.829	Loglikelihood: -1.17342e+08	(delta): 0.503903
178 (QN/Block) 	Elapsed: 23.072	Loglikelihood: -1.17342e+08	(delta): 0.567404
179 (QN/Block) 	Elapsed: 22.734	Loglikelihood: -1.17342e+08	(delta): 0.637749
180 (QN/Block) 	Elapsed: 22.865	Loglikelihood: -1.17342e+08	(delta): 0.661686
181 (QN/Block) 	Elapsed: 22.885	Loglikelihood: -1.17342e+08	(delta): 0.727277
182 (QN/Block) 	Elapsed: 22.932	Loglikelihood: -1.17342e+08	(delta): 0.811159
183 (QN/Block) 	Elapsed: 22.867	Loglikelihood: -1.17342e+08	(delta): 0.888606
184 (QN/Block) 	Elapsed: 22.663	Loglikelihood: -1.17342e+08	(delta): 2.932
185 (QN/Block) 	Elapsed: 22.855	Loglikelihood: -1.17342e+08	(delta): 1.2264
186 (QN/Block) 	Elapsed: 22.987	Loglikelihood: -1.17342e+08	(delta): 1.0667
187 (QN/Block) 	Elapsed: 22.75	Loglikelihood: -1.17342e+08	(delta): 5.26411
188 (QN/Block) 	Elapsed: 22.816	Loglikelihood: -1.17342e+08	(delta): 1.5628
189 (QN/Block) 	Elapsed: 22.599	Loglikelihood: -1.17342e+08	(delta): 1.40873
190 (QN/Block) 	Elapsed: 23.125	Loglikelihood: -1.17342e+08	(delta): 0.527505
191 (QN/Block) 	Elapsed: 23.035	Loglikelihood: -1.17342e+08	(delta): 0.362988
192 (QN/Block) 	Elapsed: 22.704	Loglikelihood: -1.17342e+08	(delta): 2.79683
193 (QN/Block) 	Elapsed: 22.932	Loglikelihood: -1.17342e+08	(delta): 2.52906
194 (QN/Block) 	Elapsed: 22.753	Loglikelihood: -1.17342e+08	(delta): 1.40104
195 (QN/Block) 	Elapsed: 22.559	Loglikelihood: -1.17342e+08	(delta): 1.29167
196 (QN/Block) 	Elapsed: 22.391	Loglikelihood: -1.17342e+08	(delta): 1.65543
197 (QN/Block) 	Elapsed: 22.455	Loglikelihood: -1.17342e+08	(delta): 0.606462
198 (QN/Block) 	Elapsed: 22.548	Loglikelihood: -1.17342e+08	(delta): 1.65668
199 (QN/Block) 	Elapsed: 22.881	Loglikelihood: -1.17342e+08	(delta): 0.65003
200 (QN/Block) 	Elapsed: 22.786	Loglikelihood: -1.17342e+08	(delta): 2.19188
201 (QN/Block) 	Elapsed: 22.481	Loglikelihood: -1.17342e+08	(delta): 0.634008
202 (QN/Block) 	Elapsed: 22.556	Loglikelihood: -1.17342e+08	(delta): 2.75988
203 (QN/Block) 	Elapsed: 22.739	Loglikelihood: -1.17342e+08	(delta): 1.425
204 (QN/Block) 	Elapsed: 22.391	Loglikelihood: -1.17342e+08	(delta): 1.30052
205 (QN/Block) 	Elapsed: 22.877	Loglikelihood: -1.17342e+08	(delta): 6.82893
206 (QN/Block) 	Elapsed: 22.691	Loglikelihood: -1.17342e+08	(delta): 3.24565
207 (QN/Block) 	Elapsed: 22.873	Loglikelihood: -1.17342e+08	(delta): 3.36641
208 (QN/Block) 	Elapsed: 22.466	Loglikelihood: -1.17342e+08	(delta): 1.78704
209 (QN/Block) 	Elapsed: 22.593	Loglikelihood: -1.17342e+08	(delta): 1.06005
210 (QN/Block) 	Elapsed: 23.181	Loglikelihood: -1.17342e+08	(delta): 0.599917
211 (QN/Block) 	Elapsed: 23.005	Loglikelihood: -1.17342e+08	(delta): 0.510259
212 (QN/Block) 	Elapsed: 23.224	Loglikelihood: -1.17342e+08	(delta): 0.518007
213 (QN/Block) 	Elapsed: 22.997	Loglikelihood: -1.17342e+08	(delta): 0.53046
214 (QN/Block) 	Elapsed: 22.956	Loglikelihood: -1.17342e+08	(delta): 0.547949
215 (QN/Block) 	Elapsed: 23.168	Loglikelihood: -1.17342e+08	(delta): 0.570973
216 (QN/Block) 	Elapsed: 22.918	Loglikelihood: -1.17342e+08	(delta): 0.600261
217 (QN/Block) 	Elapsed: 23.202	Loglikelihood: -1.17342e+08	(delta): 0.41635
218 (QN/Block) 	Elapsed: 22.963	Loglikelihood: -1.17342e+08	(delta): 0.312232
219 (QN/Block) 	Elapsed: 22.788	Loglikelihood: -1.17342e+08	(delta): 2.55083
220 (QN/Block) 	Elapsed: 23.03	Loglikelihood: -1.17342e+08	(delta): 2.20588
221 (QN/Block) 	Elapsed: 22.518	Loglikelihood: -1.17342e+08	(delta): 0.403088
222 (QN/Block) 	Elapsed: 22.63	Loglikelihood: -1.17342e+08	(delta): 0.98406
223 (QN/Block) 	Elapsed: 22.717	Loglikelihood: -1.17342e+08	(delta): 0.250549
224 (QN/Block) 	Elapsed: 22.732	Loglikelihood: -1.17342e+08	(delta): 0.207373
225 (QN/Block) 	Elapsed: 22.852	Loglikelihood: -1.17342e+08	(delta): 0.82262
226 (QN/Block) 	Elapsed: 22.62	Loglikelihood: -1.17342e+08	(delta): 0.433226
227 (QN/Block) 	Elapsed: 22.945	Loglikelihood: -1.17342e+08	(delta): 0.352658
228 (QN/Block) 	Elapsed: 22.598	Loglikelihood: -1.17342e+08	(delta): 0.381833
229 (QN/Block) 	Elapsed: 22.714	Loglikelihood: -1.17342e+08	(delta): 0.75811
230 (QN/Block) 	Elapsed: 22.657	Loglikelihood: -1.17342e+08	(delta): 0.396834
231 (QN/Block) 	Elapsed: 22.62	Loglikelihood: -1.17342e+08	(delta): 0.256672
232 (QN/Block) 	Elapsed: 22.559	Loglikelihood: -1.17342e+08	(delta): 0.183973
233 (QN/Block) 	Elapsed: 22.739	Loglikelihood: -1.17342e+08	(delta): 0.733493
234 (QN/Block) 	Elapsed: 22.731	Loglikelihood: -1.17342e+08	(delta): 0.317215
235 (QN/Block) 	Elapsed: 22.663	Loglikelihood: -1.17342e+08	(delta): 0.28174
236 (QN/Block) 	Elapsed: 22.946	Loglikelihood: -1.17342e+08	(delta): 0.283008
237 (QN/Block) 	Elapsed: 22.766	Loglikelihood: -1.17342e+08	(delta): 0.273484
238 (QN/Block) 	Elapsed: 22.66	Loglikelihood: -1.17342e+08	(delta): 0.10062
239 (QN/Block) 	Elapsed: 23.227	Loglikelihood: -1.17342e+08	(delta): 0.301109
240 (QN/Block) 	Elapsed: 23.319	Loglikelihood: -1.17342e+08	(delta): 0.149256
241 (QN/Block) 	Elapsed: 23.23	Loglikelihood: -1.17342e+08	(delta): 0.182354
242 (QN/Block) 	Elapsed: 22.672	Loglikelihood: -1.17342e+08	(delta): 0.0775323
243 (QN/Block) 	Elapsed: 22.942	Loglikelihood: -1.17342e+08	(delta): 0.712706
244 (QN/Block) 	Elapsed: 22.826	Loglikelihood: -1.17342e+08	(delta): 0.434117
245 (QN/Block) 	Elapsed: 23.185	Loglikelihood: -1.17342e+08	(delta): 0.225734
246 (QN/Block) 	Elapsed: 22.758	Loglikelihood: -1.17342e+08	(delta): 0.151731
247 (QN/Block) 	Elapsed: 23.042	Loglikelihood: -1.17342e+08	(delta): 0.320745
248 (QN/Block) 	Elapsed: 23.019	Loglikelihood: -1.17342e+08	(delta): 0.270337
249 (QN/Block) 	Elapsed: 23.178	Loglikelihood: -1.17342e+08	(delta): 0.060871
250 (QN/Block) 	Elapsed: 22.613	Loglikelihood: -1.17342e+08	(delta): 0.46523
251 (QN/Block) 	Elapsed: 23.031	Loglikelihood: -1.17342e+08	(delta): 0.201097
252 (QN/Block) 	Elapsed: 22.906	Loglikelihood: -1.17342e+08	(delta): 0.112248
253 (QN/Block) 	Elapsed: 23.022	Loglikelihood: -1.17342e+08	(delta): 0.185643
254 (QN/Block) 	Elapsed: 23.078	Loglikelihood: -1.17342e+08	(delta): 0.269154
255 (QN/Block) 	Elapsed: 22.924	Loglikelihood: -1.17342e+08	(delta): 0.319923
256 (QN/Block) 	Elapsed: 22.941	Loglikelihood: -1.17342e+08	(delta): 0.336326
257 (QN/Block) 	Elapsed: 22.988	Loglikelihood: -1.17342e+08	(delta): 0.153715
258 (QN/Block) 	Elapsed: 22.842	Loglikelihood: -1.17342e+08	(delta): 0.390233
259 (QN/Block) 	Elapsed: 22.749	Loglikelihood: -1.17342e+08	(delta): 0.167782
260 (QN/Block) 	Elapsed: 23.221	Loglikelihood: -1.17342e+08	(delta): 1.1487
261 (QN/Block) 	Elapsed: 23.038	Loglikelihood: -1.17342e+08	(delta): 0.106827
262 (QN/Block) 	Elapsed: 22.856	Loglikelihood: -1.17342e+08	(delta): 0.135443
263 (QN/Block) 	Elapsed: 22.918	Loglikelihood: -1.17342e+08	(delta): 0.242375
264 (QN/Block) 	Elapsed: 22.823	Loglikelihood: -1.17342e+08	(delta): 0.122365
265 (QN/Block) 	Elapsed: 22.676	Loglikelihood: -1.17342e+08	(delta): 0.189791
266 (QN/Block) 	Elapsed: 22.786	Loglikelihood: -1.17342e+08	(delta): 0.0448357
267 (QN/Block) 	Elapsed: 22.946	Loglikelihood: -1.17342e+08	(delta): 0.269106
268 (QN/Block) 	Elapsed: 23.009	Loglikelihood: -1.17342e+08	(delta): 0.0924024
269 (QN/Block) 	Elapsed: 22.687	Loglikelihood: -1.17342e+08	(delta): 0.180433
270 (QN/Block) 	Elapsed: 22.827	Loglikelihood: -1.17342e+08	(delta): 0.105753
271 (QN/Block) 	Elapsed: 22.82	Loglikelihood: -1.17342e+08	(delta): 1.8241
272 (QN/Block) 	Elapsed: 23.017	Loglikelihood: -1.17342e+08	(delta): 3.51218
273 (QN/Block) 	Elapsed: 22.587	Loglikelihood: -1.17342e+08	(delta): 8.76977
274 (QN/Block) 	Elapsed: 22.783	Loglikelihood: -1.17342e+08	(delta): 4.09421
275 (QN/Block) 	Elapsed: 22.872	Loglikelihood: -1.17342e+08	(delta): 0.952099
276 (QN/Block) 	Elapsed: 22.653	Loglikelihood: -1.17342e+08	(delta): 1.50132
277 (QN/Block) 	Elapsed: 22.682	Loglikelihood: -1.17342e+08	(delta): 0.683085
278 (QN/Block) 	Elapsed: 22.983	Loglikelihood: -1.17342e+08	(delta): 0.259241
279 (QN/Block) 	Elapsed: 22.343	Loglikelihood: -1.17342e+08	(delta): 0.291342
280 (QN/Block) 	Elapsed: 22.737	Loglikelihood: -1.17342e+08	(delta): 0.187238
281 (QN/Block) 	Elapsed: 22.73	Loglikelihood: -1.17342e+08	(delta): 0.176949
282 (QN/Block) 	Elapsed: 22.743	Loglikelihood: -1.17342e+08	(delta): 0.126254
283 (QN/Block) 	Elapsed: 22.906	Loglikelihood: -1.17342e+08	(delta): 0.0637365
284 (QN/Block) 	Elapsed: 22.642	Loglikelihood: -1.17342e+08	(delta): 0.177706
285 (QN/Block) 	Elapsed: 22.682	Loglikelihood: -1.17342e+08	(delta): 0.126659
286 (QN/Block) 	Elapsed: 22.729	Loglikelihood: -1.17342e+08	(delta): 0.0590923
287 (QN/Block) 	Elapsed: 22.648	Loglikelihood: -1.17342e+08	(delta): 0.0207815
288 (QN/Block) 	Elapsed: 22.606	Loglikelihood: -1.17342e+08	(delta): 0.0177766
289 (QN/Block) 	Elapsed: 22.741	Loglikelihood: -1.17342e+08	(delta): 0.0844682
290 (QN/Block) 	Elapsed: 22.666	Loglikelihood: -1.17342e+08	(delta): 0.0173257
291 (QN/Block) 	Elapsed: 22.682	Loglikelihood: -1.17342e+08	(delta): 0.0168393
292 (QN/Block) 	Elapsed: 22.661	Loglikelihood: -1.17342e+08	(delta): 0.0088228
293 (QN/Block) 	Elapsed: 22.863	Loglikelihood: -1.17342e+08	(delta): 0.0205453
294 (QN/Block) 	Elapsed: 23.664	Loglikelihood: -1.17342e+08	(delta): 0.00943053
295 (QN/Block) 	Elapsed: 23.748	Loglikelihood: -1.17342e+08	(delta): 0.00486529
296 (QN/Block) 	Elapsed: 22.94	Loglikelihood: -1.17342e+08	(delta): 0.00455314
297 (QN/Block) 	Elapsed: 22.9	Loglikelihood: -1.17342e+08	(delta): 0.0132303
298 (QN/Block) 	Elapsed: 22.621	Loglikelihood: -1.17342e+08	(delta): 0.0103569
299 (QN/Block) 	Elapsed: 22.89	Loglikelihood: -1.17342e+08	(delta): 0.00417502
300 (QN/Block) 	Elapsed: 22.949	Loglikelihood: -1.17342e+08	(delta): 0.00266387
301 (QN/Block) 	Elapsed: 22.72	Loglikelihood: -1.17342e+08	(delta): 0.00997183
302 (QN/Block) 	Elapsed: 22.582	Loglikelihood: -1.17342e+08	(delta): 0.00549324
303 (QN/Block) 	Elapsed: 22.821	Loglikelihood: -1.17342e+08	(delta): 0.0020338
304 (QN/Block) 	Elapsed: 22.531	Loglikelihood: -1.17342e+08	(delta): 0.00150447
305 (QN/Block) 	Elapsed: 22.843	Loglikelihood: -1.17342e+08	(delta): 0.00249702
306 (QN/Block) 	Elapsed: 22.609	Loglikelihood: -1.17342e+08	(delta): 0.00422022
307 (QN/Block) 	Elapsed: 22.669	Loglikelihood: -1.17342e+08	(delta): 0.00231718
308 (QN/Block) 	Elapsed: 22.606	Loglikelihood: -1.17342e+08	(delta): 0.00124191
309 (QN/Block) 	Elapsed: 23.074	Loglikelihood: -1.17342e+08	(delta): 0.00152555
310 (QN/Block) 	Elapsed: 22.602	Loglikelihood: -1.17342e+08	(delta): 0.00177839
311 (QN/Block) 	Elapsed: 22.616	Loglikelihood: -1.17342e+08	(delta): 0.00195934
312 (QN/Block) 	Elapsed: 22.877	Loglikelihood: -1.17342e+08	(delta): 0.000976264
313 (QN/Block) 	Elapsed: 22.667	Loglikelihood: -1.17342e+08	(delta): 0.000866801
314 (QN/Block) 	Elapsed: 22.684	Loglikelihood: -1.17342e+08	(delta): 0.000954777
315 (QN/Block) 	Elapsed: 22.809	Loglikelihood: -1.17342e+08	(delta): 0.00373217
316 (QN/Block) 	Elapsed: 22.607	Loglikelihood: -1.17342e+08	(delta): 0.000598535
317 (QN/Block) 	Elapsed: 22.543	Loglikelihood: -1.17342e+08	(delta): 0.000720128
318 (QN/Block) 	Elapsed: 22.363	Loglikelihood: -1.17342e+08	(delta): 0.000933602
319 (QN/Block) 	Elapsed: 22.655	Loglikelihood: -1.17342e+08	(delta): 0.0111366
320 (QN/Block) 	Elapsed: 22.823	Loglikelihood: -1.17342e+08	(delta): 0.00170982
321 (QN/Block) 	Elapsed: 22.576	Loglikelihood: -1.17342e+08	(delta): 0.000943378
322 (QN/Block) 	Elapsed: 22.697	Loglikelihood: -1.17342e+08	(delta): 0.000772476
323 (QN/Block) 	Elapsed: 23.268	Loglikelihood: -1.17342e+08	(delta): 0.00110126
324 (QN/Block) 	Elapsed: 22.641	Loglikelihood: -1.17342e+08	(delta): 0.00141048
325 (QN/Block) 	Elapsed: 22.787	Loglikelihood: -1.17342e+08	(delta): 0.000971004
326 (QN/Block) 	Elapsed: 22.564	Loglikelihood: -1.17342e+08	(delta): 0.00050725
327 (QN/Block) 	Elapsed: 22.607	Loglikelihood: -1.17342e+08	(delta): 0.000692427
328 (QN/Block) 	Elapsed: 22.667	Loglikelihood: -1.17342e+08	(delta): 0.000966698
329 (QN/Block) 	Elapsed: 22.704	Loglikelihood: -1.17342e+08	(delta): 0.000839502
330 (QN/Block) 	Elapsed: 22.529	Loglikelihood: -1.17342e+08	(delta): 0.000487477
331 (QN/Block) 	Elapsed: 22.528	Loglikelihood: -1.17342e+08	(delta): 0.000523463
332 (QN/Block) 	Elapsed: 22.76	Loglikelihood: -1.17342e+08	(delta): 0.000746563
333 (QN/Block) 	Elapsed: 22.851	Loglikelihood: -1.17342e+08	(delta): 0.000496998
334 (QN/Block) 	Elapsed: 22.751	Loglikelihood: -1.17342e+08	(delta): 0.000367492
335 (QN/Block) 	Elapsed: 22.786	Loglikelihood: -1.17342e+08	(delta): 0.00068523
336 (QN/Block) 	Elapsed: 22.681	Loglikelihood: -1.17342e+08	(delta): 0.005081
337 (QN/Block) 	Elapsed: 22.6	Loglikelihood: -1.17342e+08	(delta): 0.00111647
338 (QN/Block) 	Elapsed: 22.714	Loglikelihood: -1.17342e+08	(delta): 0.000450805
339 (QN/Block) 	Elapsed: 22.665	Loglikelihood: -1.17342e+08	(delta): 0.000406161
340 (QN/Block) 	Elapsed: 22.686	Loglikelihood: -1.17342e+08	(delta): 0.000943497
341 (QN/Block) 	Elapsed: 22.606	Loglikelihood: -1.17342e+08	(delta): 0.000436157
342 (QN/Block) 	Elapsed: 22.914	Loglikelihood: -1.17342e+08	(delta): 0.000407606
343 (QN/Block) 	Elapsed: 22.483	Loglikelihood: -1.17342e+08	(delta): 0.000822887
344 (QN/Block) 	Elapsed: 22.542	Loglikelihood: -1.17342e+08	(delta): 0.00177847
345 (QN/Block) 	Elapsed: 22.906	Loglikelihood: -1.17342e+08	(delta): 0.00130568
346 (QN/Block) 	Elapsed: 22.457	Loglikelihood: -1.17342e+08	(delta): 0.000489071
347 (QN/Block) 	Elapsed: 22.973	Loglikelihood: -1.17342e+08	(delta): 0.000357628
348 (QN/Block) 	Elapsed: 23.662	Loglikelihood: -1.17342e+08	(delta): 0.000743762
349 (QN/Block) 	Elapsed: 23.438	Loglikelihood: -1.17342e+08	(delta): 0.000705272
350 (QN/Block) 	Elapsed: 23.103	Loglikelihood: -1.17342e+08	(delta): 0.000400424
351 (QN/Block) 	Elapsed: 22.827	Loglikelihood: -1.17342e+08	(delta): 0.000260144
352 (QN/Block) 	Elapsed: 22.79	Loglikelihood: -1.17342e+08	(delta): 0.000331879
353 (QN/Block) 	Elapsed: 22.827	Loglikelihood: -1.17342e+08	(delta): 0.000856414
354 (QN/Block) 	Elapsed: 22.588	Loglikelihood: -1.17342e+08	(delta): 0.000600994
355 (QN/Block) 	Elapsed: 22.64	Loglikelihood: -1.17342e+08	(delta): 0.00030075
356 (QN/Block) 	Elapsed: 22.593	Loglikelihood: -1.17342e+08	(delta): 0.000235543
357 (QN/Block) 	Elapsed: 22.777	Loglikelihood: -1.17342e+08	(delta): 0.00041616
358 (QN/Block) 	Elapsed: 22.728	Loglikelihood: -1.17342e+08	(delta): 0.000557303
359 (QN/Block) 	Elapsed: 22.596	Loglikelihood: -1.17342e+08	(delta): 0.000266477
360 (QN/Block) 	Elapsed: 22.553	Loglikelihood: -1.17342e+08	(delta): 0.000217646
361 (QN/Block) 	Elapsed: 22.929	Loglikelihood: -1.17342e+08	(delta): 0.000347719
362 (QN/Block) 	Elapsed: 22.654	Loglikelihood: -1.17342e+08	(delta): 0.000480607
363 (QN/Block) 	Elapsed: 22.762	Loglikelihood: -1.17342e+08	(delta): 0.000255957
364 (QN/Block) 	Elapsed: 22.646	Loglikelihood: -1.17342e+08	(delta): 0.00019592
365 (QN/Block) 	Elapsed: 22.731	Loglikelihood: -1.17342e+08	(delta): 0.000302359
366 (QN/Block) 	Elapsed: 22.624	Loglikelihood: -1.17342e+08	(delta): 0.000419781
367 (QN/Block) 	Elapsed: 22.821	Loglikelihood: -1.17342e+08	(delta): 0.000240251
368 (QN/Block) 	Elapsed: 22.606	Loglikelihood: -1.17342e+08	(delta): 0.00017716
369 (QN/Block) 	Elapsed: 22.487	Loglikelihood: -1.17342e+08	(delta): 0.000245333
370 (QN/Block) 	Elapsed: 23.014	Loglikelihood: -1.17342e+08	(delta): 0.000327781
371 (QN/Block) 	Elapsed: 22.596	Loglikelihood: -1.17342e+08	(delta): 0.000224382
372 (QN/Block) 	Elapsed: 22.714	Loglikelihood: -1.17342e+08	(delta): 0.000181675
373 (QN/Block) 	Elapsed: 22.65	Loglikelihood: -1.17342e+08	(delta): 0.000195175
374 (QN/Block) 	Elapsed: 22.845	Loglikelihood: -1.17342e+08	(delta): 0.000838563
375 (QN/Block) 	Elapsed: 22.581	Loglikelihood: -1.17342e+08	(delta): 0.000190094
376 (QN/Block) 	Elapsed: 22.536	Loglikelihood: -1.17342e+08	(delta): 0.000127926
377 (QN/Block) 	Elapsed: 22.598	Loglikelihood: -1.17342e+08	(delta): 0.000130415
378 (QN/Block) 	Elapsed: 22.872	Loglikelihood: -1.17342e+08	(delta): 0.000372767
379 (QN/Block) 	Elapsed: 22.877	Loglikelihood: -1.17342e+08	(delta): 0.000585064
380 (QN/Block) 	Elapsed: 22.911	Loglikelihood: -1.17342e+08	(delta): 0.000260308
381 (QN/Block) 	Elapsed: 22.904	Loglikelihood: -1.17342e+08	(delta): 0.000112325
382 (QN/Block) 	Elapsed: 22.772	Loglikelihood: -1.17342e+08	(delta): 0.000137568
383 (QN/Block) 	Elapsed: 22.743	Loglikelihood: -1.17342e+08	(delta): 0.000307143
384 (QN/Block) 	Elapsed: 22.705	Loglikelihood: -1.17342e+08	(delta): 0.000218377
385 (QN/Block) 	Elapsed: 22.762	Loglikelihood: -1.17342e+08	(delta): 0.000103951
386 (QN/Block) 	Elapsed: 22.699	Loglikelihood: -1.17342e+08	(delta): 0.000117362
387 (QN/Block) 	Elapsed: 22.883	Loglikelihood: -1.17342e+08	(delta): 0.000261098
388 (QN/Block) 	Elapsed: 22.374	Loglikelihood: -1.17342e+08	(delta): 0.000190675
389 (QN/Block) 	Elapsed: 22.69	Loglikelihood: -1.17342e+08	(delta): 9.84222e-05
Summary: 
Converged in 389 iterations (8923.24 sec)
Loglikelihood: -117341571.351228
Fst divergences between estimated populations: 
	Pop0	Pop1	Pop2	Pop3	Pop4	Pop5	
Pop0	
Pop1	0.029	
Pop2	0.027	0.030	
Pop3	0.028	0.031	0.031	
Pop4	0.030	0.030	0.030	0.031	
Pop5	0.035	0.034	0.036	0.036	0.038	
Pop6	0.035	0.037	0.036	0.036	0.037	0.040	
CV error (K=7): 0.54566
Writing output files.

extract the CV errors

plot the CV errors
evaluate the K1 results in more detail
evalAdmix version 0.962
evalAdmix -plink ./01_pca/loop_maf_missing_2_ldprunned_autosome_pca_not_outliers -fname ./02_admixture/admixture_cv/loop_maf_missing_2_ldprunned_autosome_pca_not_outliers.K1.P -qname ./02_admixture/admixture_cv/loop_maf_missing_2_ldprunned_autosome_pca_not_outliers.K1.Q -o ./02_admixture/eval_admix/evaladmixOut.K1.corres -P 20 
	-> Will assume these are the plink files:
		bed: ./01_pca/loop_maf_missing_2_ldprunned_autosome_pca_not_outliers.bed
		bim: ./01_pca/loop_maf_missing_2_ldprunned_autosome_pca_not_outliers.bim
		fam: ./01_pca/loop_maf_missing_2_ldprunned_autosome_pca_not_outliers.fam
	-> Plink file contains 94854 autosomale SNPs
	-> reading genotypes 	-> Allocated: 0.235 gig memory
 - done 

		->K=1	nSites=94854	nInd=1240
opening : ./02_admixture/admixture_cv/loop_maf_missing_2_ldprunned_autosome_pca_not_outliers.K1.Q with x=1240 y=1
opening : ./02_admixture/admixture_cv/loop_maf_missing_2_ldprunned_autosome_pca_not_outliers.K1.P with x=94854 y=1
Going to calcualte normal residuals
Finished calculating normal residuals
Correcting frequencies with 20 threads...
Finished, going to write all correlations
Correlation matrix has been written to ./02_admixture/eval_admix/evaladmixOut.K1.corres
	[ALL done] cpu-time used =  6679.61 sec
	[ALL done] walltime used =  336.00 sec
	[ALL done] results have been outputted to ./02_admixture/eval_admix/evaladmixOut.K1.corres



# Summary Ancestry: Results from the PCA analyses with smartpca and the admixture analyses with Admixture strongly suggest that our sample is relatively homogeneous in genetic terms. There are not differences at the continental level, e.g., Africans vs Europeans. Sure, we can still have more subtle differences within our sample, but we are going to use the main PCAs in the GWAS analysis anyways #

###### start check sex ######

## open folder ##
total 64
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 00_snp_duplicates
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 01_chromosome_filtering
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 02_remove_non_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 03_remove_pos_dups
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 04_remove_low_maf_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 05_remove_missing_snps
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 06_first_hwe_filter
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 07_par_problem_cleanup
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 08_remove_low_call_samples
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 09_remove_high_LogRDev_samples
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 10_remove_low_maf_snps
drwxrwxr-x 3 dftortosa dftortosa 4096 Dec 20 21:40 11_remove_related_samples
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 12_loop_maf_missing
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 20 21:40 13_visual_hetero
drwxrwxr-x 5 dftortosa dftortosa 4096 Dec 20 21:44 14_pop_strat
drwxrwxr-x 2 dftortosa dftortosa 4096 Dec 21 07:14 15_check_sex


## LD prunning ##
PLINK v2.00a4.2LM 64-bit Intel (31 May 2023)   www.cog-genomics.org/plink/2.0/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./15_check_sex/00_ld_prunning/ldpruned.log.
Options in effect:
  --bfile ./14_pop_strat/03_ancestry_cleaned_plink/loop_maf_missing_2_pca_not_outliers
  --indep-pairwise 500kb 1 0.2
  --out ./15_check_sex/00_ld_prunning/ldpruned

Start time: Sat Dec 21 07:14:36 2024
63997 MiB RAM detected, ~55502 available; reserving 31998 MiB for main
workspace.
Using up to 32 threads (change this with --threads).
1240 samples (166 females, 1038 males, 36 ambiguous; 1240 founders) loaded from
./14_pop_strat/03_ancestry_cleaned_plink/loop_maf_missing_2_pca_not_outliers.fam.
288384 variants loaded from
./14_pop_strat/03_ancestry_cleaned_plink/loop_maf_missing_2_pca_not_outliers.bim.
Note: No phenotype data present.
Calculating allele frequencies... 0%22%45%68%90%done.
--indep-pairwise (26 compute threads): 0%50%191688/288384 variants removed.
Writing...
Variant lists written to ./15_check_sex/00_ld_prunning/ldpruned.prune.in and
./15_check_sex/00_ld_prunning/ldpruned.prune.out .
End time: Sat Dec 21 07:14:36 2024
total 3152
-rw-rw-r-- 1 dftortosa dftortosa    1233 Dec 21 07:14 ldpruned.log
-rw-rw-r-- 1 dftortosa dftortosa 1077261 Dec 21 07:14 ldpruned.prune.in
-rw-rw-r-- 1 dftortosa dftortosa 2141719 Dec 21 07:14 ldpruned.prune.out

PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./15_check_sex/00_ld_prunning/loop_maf_missing_2_pca_not_outliers_ldpruned.log.
Options in effect:
  --bfile ./14_pop_strat/03_ancestry_cleaned_plink/loop_maf_missing_2_pca_not_outliers
  --extract ./15_check_sex/00_ld_prunning/ldpruned.prune.in
  --make-bed
  --out ./15_check_sex/00_ld_prunning/loop_maf_missing_2_pca_not_outliers_ldpruned

63997 MB RAM detected; reserving 31998 MB for main workspace.
288384 variants loaded from .bim file.
1240 people (1038 males, 166 females, 36 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./15_check_sex/00_ld_prunning/loop_maf_missing_2_pca_not_outliers_ldpruned.nosex
.
--extract: 96696 variants remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1240 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.999567.
96696 variants and 1240 people pass filters and QC.
Note: No phenotypes present.
--make-bed to
./15_check_sex/00_ld_prunning/loop_maf_missing_2_pca_not_outliers_ldpruned.bed
+
./15_check_sex/00_ld_prunning/loop_maf_missing_2_pca_not_outliers_ldpruned.bim
+
./15_check_sex/00_ld_prunning/loop_maf_missing_2_pca_not_outliers_ldpruned.fam
... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.
total 35344
-rw-rw-r-- 1 dftortosa dftortosa     1233 Dec 21 07:14 ldpruned.log
-rw-rw-r-- 1 dftortosa dftortosa  1077261 Dec 21 07:14 ldpruned.prune.in
-rw-rw-r-- 1 dftortosa dftortosa  2141719 Dec 21 07:14 ldpruned.prune.out
-rw-rw-r-- 1 dftortosa dftortosa 29975763 Dec 21 07:14 loop_maf_missing_2_pca_not_outliers_ldpruned.bed
-rw-rw-r-- 1 dftortosa dftortosa  2785759 Dec 21 07:14 loop_maf_missing_2_pca_not_outliers_ldpruned.bim
-rw-rw-r-- 1 dftortosa dftortosa    48360 Dec 21 07:14 loop_maf_missing_2_pca_not_outliers_ldpruned.fam
-rw-rw-r-- 1 dftortosa dftortosa   138701 Dec 21 07:14 loop_maf_missing_2_pca_not_outliers_ldpruned.hh
-rw-rw-r-- 1 dftortosa dftortosa     1758 Dec 21 07:14 loop_maf_missing_2_pca_not_outliers_ldpruned.log
-rw-rw-r-- 1 dftortosa dftortosa     1080 Dec 21 07:14 loop_maf_missing_2_pca_not_outliers_ldpruned.nosex

Warning: 3392 het. haploid genotypes present (see
./15_check_sex/00_ld_prunning/loop_maf_missing_2_pca_not_outliers_ldpruned.hh
); many commands treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


# Check we have around 100K SNPs #
The number of included autosomal SNPs in linkage equilibrium is 96696
Is this number greater than 93K?
TRUE


## Run first check sex, mostly based on F ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./01_first_check_sex/f_distribution.log.
Options in effect:
  --bfile ./00_ld_prunning/loop_maf_missing_2_pca_not_outliers_ldpruned
  --check-sex
  --out ./01_first_check_sex/f_distribution

63997 MB RAM detected; reserving 31998 MB for main workspace.
96696 variants loaded from .bim file.
1240 people (1038 males, 166 females, 36 ambiguous) loaded from .fam.
Ambiguous sex IDs written to ./01_first_check_sex/f_distribution.nosex .
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1240 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.999567.
96696 variants and 1240 people pass filters and QC.
Note: No phenotypes present.
--check-sex: 3244 Xchr and 0 Ychr variant(s) scanned, 40 problems detected.
Report written to ./01_first_check_sex/f_distribution.sexcheck .

Warning: 3392 het. haploid genotypes present (see
./01_first_check_sex/f_distribution.hh ); many commands treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


# check the F distribution #

# explore the F distribution #
make a plot of the F distribution
Sample with an F value between 0.2 and 0.8
                       FID       IID  PEDSEX  SNPSEX   STATUS       F
1111  combat_ILGSA24-17873  8500JADJ       1       0  PROBLEM  0.7895

# Explore the rest of results, i.e., STATUS column #
see samples with STATUS==PROBLEM
count samples that have unknown sex in the fam file
create list with samples without pheno in the excel file ('Combat gene DNA GWAS 23062022_v2.xlsx') and check their status
                      FID       IID  PEDSEX  SNPSEX   STATUS         F
14   combat_ILGSA24-17303  0201GHFM       0       2  PROBLEM  0.041240
16   combat_ILGSA24-17303  0280PAMM       0       1  PROBLEM  1.000000
21   combat_ILGSA24-17303  0295MCMM       0       1  PROBLEM  1.000000
22   combat_ILGSA24-17303  0295MDDM       0       1  PROBLEM  1.000000
23   combat_ILGSA24-17303  0296CGMM       0       1  PROBLEM  1.000000
25   combat_ILGSA24-17303  0297JKMM       0       1  PROBLEM  0.999000
27   combat_ILGSA24-17303  0298CCJM       0       1  PROBLEM  1.000000
34   combat_ILGSA24-17303  0299AHNJ       0       1  PROBLEM  0.999000
45   combat_ILGSA24-17303  2370MDJA       0       1  PROBLEM  1.000000
53   combat_ILGSA24-17303  2397NCAA       0       1  PROBLEM  1.000000
54   combat_ILGSA24-17303  2397PAFA       0       1  PROBLEM  1.000000
65   combat_ILGSA24-17303  2471AWMA       0       1  PROBLEM  0.998000
86   combat_ILGSA24-17303  4494BWMA       0       1  PROBLEM  1.000000
88   combat_ILGSA24-17303  4495CMOA       0       1  PROBLEM  1.000000
95   combat_ILGSA24-17303  4499JTMA       0       1  PROBLEM  1.000000
96   combat_ILGSA24-17303  6200DPDJ       0       1  PROBLEM  1.000000
102  combat_ILGSA24-17303  6201JJJJ       0       1  PROBLEM  1.000000
106  combat_ILGSA24-17303  6296TONJ       0       1  PROBLEM  1.000000
107  combat_ILGSA24-17303  6296WWJM       0       1  PROBLEM  1.000000
122  combat_ILGSA24-17303  6897TSSS       0       1  PROBLEM  1.000000
125  combat_ILGSA24-17303  6899DWOS       0       1  PROBLEM  1.000000
145  combat_ILGSA24-17303  7693KLNO       0       2  PROBLEM  0.039040
157  combat_ILGSA24-17303  7698ATMO       0       2  PROBLEM  0.008594
159  combat_ILGSA24-17303  7698JJJO       0       1  PROBLEM  1.000000
162  combat_ILGSA24-17303  7699CMOO       0       2  PROBLEM -0.046830
167  combat_ILGSA24-17303  7700JMAO       0       1  PROBLEM  1.000000
178  combat_ILGSA24-17303  7797BWAO       0       1  PROBLEM  1.000000
180  combat_ILGSA24-17303  7798JWSO       0       1  PROBLEM  1.000000
182  combat_ILGSA24-17303  7799BTDO       0       1  PROBLEM  1.000000
206  combat_ILGSA24-17873  0199AMDM       0       1  PROBLEM  0.999000
260  combat_ILGSA24-17873  1195HBNM       0       2  PROBLEM  0.007074
330  combat_ILGSA24-17873  1499MYSM       0       1  PROBLEM  1.000000
342  combat_ILGSA24-17873  2192HHMJ       0       2  PROBLEM  0.058000
348  combat_ILGSA24-17873  2197AFMJ       0       1  PROBLEM  1.000000
809  combat_ILGSA24-17873  6865SOMS       0       1  PROBLEM  1.000000
ALL SAMPLES WITHOUT PHENO DATA ARE COUNTED AS PROBLEMATIC, being 35 in total
there is 1 sample with unknown sex in plink that it is NOT included in the list of samples that do not have phenotype in the excel, because it is indeed a sample not included in the excel at all:
                     FID       IID  PEDSEX  SNPSEX   STATUS      F
51  combat_ILGSA24-17303  2397LDJA       0       1  PROBLEM  0.999
this was the case that is not present in the excel but there is a sample in the excel with a very similar ID: 2399LDJA insted of 2397LDJA
Add samples without pheno in excel to be removed
see now cases that are not included in the list of samples without pheno but still have a problem in sex. These are the real problems because if we have sex data and still have an error, it means there is a mismatch between self-reported sex and imputed sex using genetics genetics
Number of real problems: 5
check we have the correct number of problematic cases
                       FID       IID  PEDSEX  SNPSEX   STATUS         F
51    combat_ILGSA24-17303  2397LDJA       0       1  PROBLEM  0.999000
163   combat_ILGSA24-17303  7699ISMO       1       2  PROBLEM  0.015200
1100  combat_ILGSA24-17873  8244GBJJ       1       2  PROBLEM  0.003992
1111  combat_ILGSA24-17873  8500JADJ       1       0  PROBLEM  0.789500
1186  combat_ILGSA24-17873  8702EBMF       1       2  PROBLEM -0.005261
check we have the correct number of samples to remove
OK

# remove samples for this step #
load the fam file
                         0         1  2  3  4  5
0     combat_ILGSA24-17303  0200ADMM  0  0  1 -9
1     combat_ILGSA24-17303  0200ASJM  0  0  2 -9
2     combat_ILGSA24-17303  0200BHNM  0  0  2 -9
3     combat_ILGSA24-17303  0200CBOM  0  0  1 -9
4     combat_ILGSA24-17303  0200CDFM  0  0  2 -9
...                    ...       ... .. .. .. ..
1235  combat_ILGSA24-17873  9693JMNM  0  0  1 -9
1236  combat_ILGSA24-17873  9696DWFM  0  0  1 -9
1237  combat_ILGSA24-17873  9697STJM  0  0  1 -9
1238  combat_ILGSA24-17873  9699DNOM  0  0  1 -9
1239  combat_ILGSA24-17873  9699ISMM  0  0  1 -9

[1240 rows x 6 columns]
extract family and individual IDs to be removed
remove
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./15_check_sex/01_first_check_sex/loop_maf_missing_2_pca_not_outliers_first_sex_removal.log.
Options in effect:
  --bfile ./14_pop_strat/03_ancestry_cleaned_plink/loop_maf_missing_2_pca_not_outliers
  --make-bed
  --out ./15_check_sex/01_first_check_sex/loop_maf_missing_2_pca_not_outliers_first_sex_removal
  --remove ./15_check_sex/01_first_check_sex/id_samples_first_removal.tsv

63997 MB RAM detected; reserving 31998 MB for main workspace.
288384 variants loaded from .bim file.
1240 people (1038 males, 166 females, 36 ambiguous) loaded from .fam.
Ambiguous sex IDs written to
./15_check_sex/01_first_check_sex/loop_maf_missing_2_pca_not_outliers_first_sex_removal.nosex
.
--remove: 1203 people remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1203 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate in remaining samples is 0.999549.
288384 variants and 1203 people pass filters and QC.
Note: No phenotypes present.
--make-bed to
./15_check_sex/01_first_check_sex/loop_maf_missing_2_pca_not_outliers_first_sex_removal.bed
+
./15_check_sex/01_first_check_sex/loop_maf_missing_2_pca_not_outliers_first_sex_removal.bim
+
./15_check_sex/01_first_check_sex/loop_maf_missing_2_pca_not_outliers_first_sex_removal.fam
... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.

Warning: 12437 het. haploid genotypes present (see
./15_check_sex/01_first_check_sex/loop_maf_missing_2_pca_not_outliers_first_sex_removal.hh
); many commands treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.

check we removed the correct samples

## change sex and update IDs ##


# change sex samples #
load the fam file
extract family and individual IDs to be changed
add the new sex to the DF
                         0         1  2
42    combat_ILGSA24-17303  2397LDJA  1
1064  combat_ILGSA24-17873  8244GBJJ  2
1149  combat_ILGSA24-17873  8702EBMF  2
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./15_check_sex/02_sex_change_id_update/loop_maf_missing_2_pca_not_outliers_first_sex_removal_sex_update.log.
Options in effect:
  --bfile ./15_check_sex/01_first_check_sex/loop_maf_missing_2_pca_not_outliers_first_sex_removal
  --make-bed
  --out ./15_check_sex/02_sex_change_id_update/loop_maf_missing_2_pca_not_outliers_first_sex_removal_sex_update
  --update-sex ./15_check_sex/02_sex_change_id_update/id_samples_sex_change.tsv

63997 MB RAM detected; reserving 31998 MB for main workspace.
288384 variants loaded from .bim file.
1203 people (1036 males, 166 females, 1 ambiguous) loaded from .fam.
Ambiguous sex ID written to
./15_check_sex/02_sex_change_id_update/loop_maf_missing_2_pca_not_outliers_first_sex_removal_sex_update.nosex
.
--update-sex: 3 people updated.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1203 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.999552.
288384 variants and 1203 people pass filters and QC.
Note: No phenotypes present.
--make-bed to
./15_check_sex/02_sex_change_id_update/loop_maf_missing_2_pca_not_outliers_first_sex_removal_sex_update.bed
+
./15_check_sex/02_sex_change_id_update/loop_maf_missing_2_pca_not_outliers_first_sex_removal_sex_update.bim
+
./15_check_sex/02_sex_change_id_update/loop_maf_missing_2_pca_not_outliers_first_sex_removal_sex_update.fam
... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.

Warning: 657 het. haploid genotypes present (see
./15_check_sex/02_sex_change_id_update/loop_maf_missing_2_pca_not_outliers_first_sex_removal_sex_update.hh
); many commands treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


# update IDs #
load the fam file
extract family and individual IDs to be changed
add the new ID
New ID: 
                       0         1                     2         3
42  combat_ILGSA24-17303  2397LDJA  combat_ILGSA24-17303  2399LDJA
save
update the ID
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./15_check_sex/02_sex_change_id_update/loop_maf_missing_2_pca_not_outliers_first_sex_removal_sex_update_id_update.log.
Options in effect:
  --bfile ./15_check_sex/02_sex_change_id_update/loop_maf_missing_2_pca_not_outliers_first_sex_removal_sex_update
  --make-bed
  --out ./15_check_sex/02_sex_change_id_update/loop_maf_missing_2_pca_not_outliers_first_sex_removal_sex_update_id_update
  --update-ids ./15_check_sex/02_sex_change_id_update/id_samples_id_update.tsv

63997 MB RAM detected; reserving 31998 MB for main workspace.
288384 variants loaded from .bim file.
1203 people (1035 males, 168 females) loaded from .fam.
--update-ids: 1 person updated.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1203 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.999552.
288384 variants and 1203 people pass filters and QC.
Note: No phenotypes present.
--make-bed to
./15_check_sex/02_sex_change_id_update/loop_maf_missing_2_pca_not_outliers_first_sex_removal_sex_update_id_update.bed
+
./15_check_sex/02_sex_change_id_update/loop_maf_missing_2_pca_not_outliers_first_sex_removal_sex_update_id_update.bim
+
./15_check_sex/02_sex_change_id_update/loop_maf_missing_2_pca_not_outliers_first_sex_removal_sex_update_id_update.fam
... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.

Warning: 657 het. haploid genotypes present (see
./15_check_sex/02_sex_change_id_update/loop_maf_missing_2_pca_not_outliers_first_sex_removal_sex_update_id_update.hh
); many commands treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.

check

## check sex using Y chromosome ##


# run check-sex only with Y #
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./03_second_check_sex/check_sex_y_only.log.
Options in effect:
  --bfile ./02_sex_change_id_update/loop_maf_missing_2_pca_not_outliers_first_sex_removal_sex_update_id_update
  --check-sex y-only 0 1
  --out ./03_second_check_sex/check_sex_y_only

63997 MB RAM detected; reserving 31998 MB for main workspace.
288384 variants loaded from .bim file.
1203 people (1035 males, 168 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1203 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.999552.
288384 variants and 1203 people pass filters and QC.
Note: No phenotypes present.
--check-sex: 0 Xchr and 411 Ychr variant(s) scanned, 43 problems detected.
Report written to ./03_second_check_sex/check_sex_y_only.sexcheck .

Warning: 657 het. haploid genotypes present (see
./03_second_check_sex/check_sex_y_only.hh ); many commands treat these as
missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.


# explore checksex file and non-missing Y genotypes in females #
load the checksex file
                       FID       IID  PEDSEX  SNPSEX STATUS  YCOUNT
0     combat_ILGSA24-17303  0200ADMM       1       1     OK     410
1     combat_ILGSA24-17303  0200ASJM       2       2     OK       0
2     combat_ILGSA24-17303  0200BHNM       2       2     OK       0
3     combat_ILGSA24-17303  0200CBOM       1       1     OK     411
4     combat_ILGSA24-17303  0200CDFM       2       2     OK       0
...                    ...       ...     ...     ...    ...     ...
1198  combat_ILGSA24-17873  9693JMNM       1       1     OK     411
1199  combat_ILGSA24-17873  9696DWFM       1       1     OK     411
1200  combat_ILGSA24-17873  9697STJM       1       1     OK     411
1201  combat_ILGSA24-17873  9699DNOM       1       1     OK     411
1202  combat_ILGSA24-17873  9699ISMM       1       1     OK     410

[1203 rows x 6 columns]
extract problematic cases and check that these are females
OK
check the original problematic cases due to non-missing Y genotypes are included in this new list
OK

# Explore the problematic cases in the HH file, i.e., heterzigous alls in regions of the X chrosomoe that are not PAR and hence should be homozygous and haploid, i.e., heterozygous haploids #
load the HH file
count the number of unique SNPs and samples impicates
snps
count    478.000000
mean       1.374477
std        0.994712
min        1.000000
25%        1.000000
50%        1.000000
75%        1.000000
max        9.000000
Name: count, dtype: float64
most of the SNPs are repeated 1 time and no more (percentile 75 is 1)
samples
count    285.000000
mean       2.305263
std        4.829648
min        1.000000
25%        1.000000
50%        1.000000
75%        2.000000
max       61.000000
Name: count, dtype: float64
Some samples are repeated several times, but most of them just 2 times (percentile 75 is 2
Therefore, there are no SNPs/samples very badly affected
check that all affected samples are males
OK
check that all affected SNPs are in X plus 1 case in the Y
OK
there is also 1 Y case in the HH file
    0               1  2  ...                     0         1               2
0  24  JHU_Y.24444621  0  ...  combat_ILGSA24-17873  1198LKSM  JHU_Y.24444621

[1 rows x 9 columns]
all cases (for X and Y) are outside or PAR regions?
OK
OK
If all the previous checka are OK, it means we have males that have heterozygous calls in non-PAR regions of the X or Y chromosome. We know these are males because we have already checked the sex with F and Y genotypes and know that SNPs in the PAR regions are clearly noted like that, thus these seems to be genotyping errors. We have to remove. The question is whether to just remove these specific genotypes or remove these SNPs for all samples altogether. We are going to remove only the specific genotypes implicated in this problem. See the script for further details about the decision

# use --set-hh-missing to remove these problematic genotypes #
Run plink
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./03_second_check_sex/loop_maf_missing_2_pca_not_outliers_sex_full_clean.log.
Options in effect:
  --bfile ./02_sex_change_id_update/loop_maf_missing_2_pca_not_outliers_first_sex_removal_sex_update_id_update
  --make-bed
  --out ./03_second_check_sex/loop_maf_missing_2_pca_not_outliers_sex_full_clean
  --set-hh-missing

63997 MB RAM detected; reserving 31998 MB for main workspace.
288384 variants loaded from .bim file.
1203 people (1035 males, 168 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1203 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.999552.
288384 variants and 1203 people pass filters and QC.
Note: No phenotypes present.
--make-bed to
./03_second_check_sex/loop_maf_missing_2_pca_not_outliers_sex_full_clean.bed +
./03_second_check_sex/loop_maf_missing_2_pca_not_outliers_sex_full_clean.bim +
./03_second_check_sex/loop_maf_missing_2_pca_not_outliers_sex_full_clean.fam
... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.

Warning: 657 het. haploid genotypes present (see
./03_second_check_sex/loop_maf_missing_2_pca_not_outliers_sex_full_clean.hh );
many commands treat these as missing.
Warning: Nonmissing nonmale Y chromosome genotype(s) present; many commands
treat these as missing.

run again a sex check to ensure we do not have more nonmale Y and het. haploid cases
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./03_second_check_sex/last_check_sex.log.
Options in effect:
  --bfile ./03_second_check_sex/loop_maf_missing_2_pca_not_outliers_sex_full_clean
  --check-sex ycount
  --out ./03_second_check_sex/last_check_sex

63997 MB RAM detected; reserving 31998 MB for main workspace.
288384 variants loaded from .bim file.
1203 people (1035 males, 168 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1203 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.99955.
288384 variants and 1203 people pass filters and QC.
Note: No phenotypes present.
--check-sex: 17370 Xchr and 411 Ychr variant(s) scanned, no problems detected.
Report written to ./03_second_check_sex/last_check_sex.sexcheck .

check the log file that does not contain any warning anymore

OK
explore the last checksex file to do a few more checks
WE HAVE CORRECTLY CLEANED OUR DATA OF SEX ISSUES

###### start check sex ######

## open folder ##


## Check we have at least 1K samples as this is relevant for the HWE threshold used ##
Number of samples after complete sex clean is: 1203


## run plink to filter by HWE ##
PLINK v2.00a4.2LM 64-bit Intel (31 May 2023)   www.cog-genomics.org/plink/2.0/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./16_hwe_second_round/loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe.log.
Options in effect:
  --bfile ./15_check_sex/03_second_check_sex/loop_maf_missing_2_pca_not_outliers_sex_full_clean
  --hwe 1e-25 midp
  --make-bed
  --out ./16_hwe_second_round/loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe

Start time: Sat Dec 21 07:14:38 2024
63997 MiB RAM detected, ~55407 available; reserving 31998 MiB for main
workspace.
Using up to 32 threads (change this with --threads).
1203 samples (168 females, 1035 males; 1203 founders) loaded from
./15_check_sex/03_second_check_sex/loop_maf_missing_2_pca_not_outliers_sex_full_clean.fam.
288384 variants loaded from
./15_check_sex/03_second_check_sex/loop_maf_missing_2_pca_not_outliers_sex_full_clean.bim.
Note: No phenotype data present.
Calculating allele frequencies... 0%22%45%68%90%done.
Computing chrX Hardy-Weinberg midp-values... 0%0%1%1%2%2%3%3%4%4%5%5%6%6%7%7%8%8%9%9%10%10%11%11%12%12%13%13%14%14%15%15%16%16%17%17%18%18%19%19%20%20%21%21%22%22%23%23%24%24%25%25%26%26%27%27%28%28%29%29%30%30%31%31%32%32%33%33%34%34%35%35%36%36%37%37%38%38%39%39%40%40%41%41%42%42%43%43%44%44%45%45%46%46%47%47%48%48%49%50%50%51%51%52%52%53%53%54%54%55%55%56%56%57%57%58%58%59%59%60%60%61%61%62%62%63%63%64%64%65%65%66%66%67%67%68%68%69%69%70%70%71%71%72%72%73%73%74%74%75%75%76%76%77%77%78%78%79%79%80%80%81%81%82%82%83%83%84%84%85%85%86%86%87%87%88%88%89%89%90%90%91%91%92%92%93%93%94%94%95%95%96%96%97%97%98%98%99%done.
--hwe midp: 2 variants removed due to Hardy-Weinberg exact test (founders
only).
288382 variants remaining after main filters.
Writing
./16_hwe_second_round/loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe.fam
... done.
Writing
./16_hwe_second_round/loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe.bim
... done.
Writing
./16_hwe_second_round/loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe.bed
... 0%22%45%68%90%done.
End time: Sat Dec 21 07:14:38 2024


## check the number of SNPs removed ##
The number of SNPs removed in the second HWE round is 2

## update the chromosome names. in the previous step we used plink2 and the output files have X,Y,XY and MT as chromosome names, instead of number, which is what this script expects ##

# Create the update_chr.txt file #

# Run the PLINK command to update chromosome names and make a new bed file #
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr.log.
Options in effect:
  --bfile ./loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe
  --make-bed
  --out ./loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr
  --update-chr ./update_chr.txt

63997 MB RAM detected; reserving 31998 MB for main workspace.
288382 variants loaded from .bim file.
1203 people (1035 males, 168 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1203 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.99955.
288382 variants and 1203 people pass filters and QC.
Note: No phenotypes present.
--update-chr: 0 values updated, 4 variant IDs not present.
--make-bed to
./loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr.bed +
./loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr.bim +
./loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr.fam ...
0%0%1%1%2%2%3%3%4%4%5%5%6%6%7%7%8%8%9%9%10%10%11%11%12%12%13%13%14%14%15%15%16%16%17%17%18%18%19%19%20%20%21%21%22%22%23%23%24%24%25%25%26%26%27%27%28%28%29%29%30%30%31%31%32%32%33%33%34%34%35%35%36%36%37%37%38%38%39%39%40%40%41%41%42%42%43%43%44%44%45%45%46%46%47%47%48%48%49%50%50%51%51%52%52%53%53%54%54%55%55%56%56%57%57%58%58%59%59%60%60%61%61%62%62%63%63%64%64%65%65%66%66%67%67%68%68%69%69%70%70%71%71%72%72%73%73%74%74%75%75%76%76%77%77%78%78%79%79%80%80%81%81%82%82%83%83%84%84%85%85%86%86%87%87%88%88%89%89%90%90%91%91%92%92%93%93%94%94%95%95%96%96%97%97%98%98%99%done.


###### remove non-autosomal ######

## open folder ##


## select autosomals ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./17_remove_non_autosomal/loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr_autosomals.log.
Options in effect:
  --autosome
  --bfile ./16_hwe_second_round/loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr
  --make-bed
  --out ./17_remove_non_autosomal/loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr_autosomals

63997 MB RAM detected; reserving 31998 MB for main workspace.
270052 out of 288382 variants loaded from .bim file.
1203 people (1035 males, 168 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1203 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.999586.
270052 variants and 1203 people pass filters and QC.
Note: No phenotypes present.
--make-bed to
./17_remove_non_autosomal/loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr_autosomals.bed
+
./17_remove_non_autosomal/loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr_autosomals.bim
+
./17_remove_non_autosomal/loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr_autosomals.fam
... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.


## check we only have autosomals ##

# load BIM file #

# check we go from 1 to 22 #
OK

###### start last maf-missing check before imputation ######

## open folder ##


## Remove SNPs that have low MAFs or high missingness ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./18_last_maf_missing_check/loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr_autosomals_miss_maf_snp_clean.log.
Options in effect:
  --bfile ./17_remove_non_autosomal/loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr_autosomals
  --geno 0.01
  --maf 0.05
  --make-bed
  --out ./18_last_maf_missing_check/loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr_autosomals_miss_maf_snp_clean

63997 MB RAM detected; reserving 31998 MB for main workspace.
270052 variants loaded from .bim file.
1203 people (1035 males, 168 females) loaded from .fam.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1203 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.999586.
21 variants removed due to missing genotype data (--geno).
7897 variants removed due to minor allele threshold(s)
(--maf/--max-maf/--mac/--max-mac).
262134 variants and 1203 people pass filters and QC.
Note: No phenotypes present.
--make-bed to
./18_last_maf_missing_check/loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr_autosomals_miss_maf_snp_clean.bed
+
./18_last_maf_missing_check/loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr_autosomals_miss_maf_snp_clean.bim
+
./18_last_maf_missing_check/loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr_autosomals_miss_maf_snp_clean.fam
... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.


# check we did not lose so many SNPs #


## Remove samples with high missingness ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr_autosomals_miss_maf_snp_clean_sample_miss_clean.log.
Options in effect:
  --bfile ./loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr_autosomals_miss_maf_snp_clean
  --make-bed
  --mind 0.01
  --out ./loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr_autosomals_miss_maf_snp_clean_sample_miss_clean

63997 MB RAM detected; reserving 31998 MB for main workspace.
262134 variants loaded from .bim file.
1203 people (1035 males, 168 females) loaded from .fam.
0 people removed due to missing genotype data (--mind).
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1203 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.999587.
262134 variants and 1203 people pass filters and QC.
Note: No phenotypes present.
--make-bed to
./loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr_autosomals_miss_maf_snp_clean_sample_miss_clean.bed
+
./loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr_autosomals_miss_maf_snp_clean_sample_miss_clean.bim
+
./loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr_autosomals_miss_maf_snp_clean_sample_miss_clean.fam
... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.


# check we did not lose ANY sample at all #


## check we do not have SNPs without ID ##

# create new fileset #
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to check_snp_ids.log.
Options in effect:
  --bfile loop_maf_missing_2_pca_not_outliers_sex_full_clean_hwe_updated_chr_autosomals_miss_maf_snp_clean_sample_miss_clean
  --exclude noSNP
  --make-bed
  --out check_snp_ids

63997 MB RAM detected; reserving 31998 MB for main workspace.
262134 variants loaded from .bim file.
1203 people (1035 males, 168 females) loaded from .fam.
--exclude: 262134 variants remaining.
Using 1 thread (no multithreaded calculations invoked).
Before main variant filters, 1203 founders and 0 nonfounders present.
Calculating allele frequencies... 0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99% done.
Total genotyping rate is 0.999587.
262134 variants and 1203 people pass filters and QC.
Note: No phenotypes present.
--make-bed to check_snp_ids.bed + check_snp_ids.bim + check_snp_ids.fam ...
0%1%2%3%4%5%6%7%8%9%10%11%12%13%14%15%16%17%18%19%20%21%22%23%24%25%26%27%28%29%30%31%32%33%34%35%36%37%38%39%40%41%42%43%44%45%46%47%48%49%50%51%52%53%54%55%56%57%58%59%60%61%62%63%64%65%66%67%68%69%70%71%72%73%74%75%76%77%78%79%80%81%82%83%84%85%86%87%88%89%90%91%92%93%94%95%96%97%98%99%done.


# check we did not lose any variants because of this #


###### start last maf-missing check before imputation ######

## open folder ##


## Compare our list of SNPs with that of TOPMed ##

# download the tool and the data #
Archive:  HRC-1000G-check-bim-v4.3.0.zip
  inflating: HRC-1000G-check-bim.pl  

rm: cannot remove 'HRC-1000G-check-bim-v4.3.0.zip': No such file or directory
rm: cannot remove 'HRC-1000G-check-bim.pl': No such file or directory
--2024-12-21 07:14:39--  https://www.chg.ox.ac.uk/~wrayner/tools/HRC-1000G-check-bim-v4.3.0.zip
Resolving www.chg.ox.ac.uk (www.chg.ox.ac.uk)... 52.56.123.235
Connecting to www.chg.ox.ac.uk (www.chg.ox.ac.uk)|52.56.123.235|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 10516 (10K) [application/zip]
Saving to: 'HRC-1000G-check-bim-v4.3.0.zip'

     0K ..........                                            100% 56.4M=0s

2024-12-21 07:14:39 (56.4 MB/s) - 'HRC-1000G-check-bim-v4.3.0.zip' saved [10516/10516]


Archive:  ./CreateTOPMed.zip
  inflating: CreateTOPMed.pl         

rm: cannot remove 'CreateTOPMed.zip': No such file or directory
rm: cannot remove 'CreateTOPMed.pl': No such file or directory
--2024-12-21 07:14:39--  https://www.chg.ox.ac.uk/~wrayner/tools/CreateTOPMed.zip
Resolving www.chg.ox.ac.uk (www.chg.ox.ac.uk)... 52.56.123.235
Connecting to www.chg.ox.ac.uk (www.chg.ox.ac.uk)|52.56.123.235|:443... connected.
HTTP request sent, awaiting response... 200 OK
Length: 2076 (2.0K) [application/zip]
Saving to: 'CreateTOPMed.zip'

     0K ..                                                    100%  659M=0s

2024-12-21 07:14:40 (659 MB/s) - 'CreateTOPMed.zip' saved [2076/2076]



  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current
                                 Dload  Upload   Total   Spent    Left  Speed

  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
  0     0    0     0    0     0      0      0 --:--:-- --:--:-- --:--:--     0
100   263  100   263    0     0    185      0  0:00:01  0:00:01 --:--:--   185


###### confirm we have the exact checksum ######

Traceback (most recent call last):
  File "/opt/scripts/./02a_pre_imputation_qc.py", line 5781, in <module>
    run_bash(" \
  File "/opt/scripts/./02a_pre_imputation_qc.py", line 215, in run_bash
    raise ValueError("ERROR: FALSE! WE HAVE A PROBLEM RUNNING COMMAND: " + complete_process.stderr)
ValueError: ERROR: FALSE! WE HAVE A PROBLEM RUNNING COMMAND: 
