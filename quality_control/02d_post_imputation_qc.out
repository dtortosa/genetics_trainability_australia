
#######################################
#######################################
checking function to print nicely
#######################################
#######################################

###### checking function to print nicely ######

#######################################
#######################################
check behaviour run_bash
#######################################
#######################################

###### see working directory ######
/home/dftortosa/diego_docs/science/other_projects/australian_army_bishop/heavy_analyses/australian_army_bishop/quality_control


###### list files/folders there ######
02a_pre_imputation_qc.out
02bb_pre_imputation_qc_eval_admix_plot.Rout
02c_post_imputation_merging.out
02d_post_imputation_qc.out
data
literature
scripts
singularity_containers


#######################################
#######################################
APPLY QC
#######################################
#######################################

###### prepare folders ######


###### FIRST QC STEP ######

## filter ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./merged_1_geno.log.
Options in effect:
  --bfile ../00_plink_filesets/merged_file_sets/merged
  --geno 0.01
  --make-bed
  --out ./merged_1_geno

63997 MB RAM detected; reserving 31998 MB for main workspace.
./merged_1_geno.log

Error: Failed to open ../00_plink_filesets/merged_file_sets/merged.bed.


## check we have not lost any SNP due to missingness ##
FIRST QC FILTER WORKED FINE

awk: cannot open ./00_plink_filesets/merged_file_sets/merged.bim (No such file or directory)
awk: cannot open ./01_first_qc_step/merged_1_geno.bim (No such file or directory)


###### SECOND QC STEP ######

## filter ##
PLINK v1.90b7 64-bit (16 Jan 2023)             www.cog-genomics.org/plink/1.9/
(C) 2005-2023 Shaun Purcell, Christopher Chang   GNU General Public License v3
Logging to ./02_second_qc_step/merged_2_geno.log.
Options in effect:
  --bfile ./01_first_qc_step/merged_1_geno
  --hwe 1e-6 midp
  --maf 0.05
  --make-bed
  --mind 0.01
  --out ./02_second_qc_step/merged_2_geno

63997 MB RAM detected; reserving 31998 MB for main workspace.
./02_second_qc_step/merged_2_geno.log

Error: Failed to open ./01_first_qc_step/merged_1_geno.bed.


## check we have the same number of samples and at least 5M SNPs ##
Traceback (most recent call last):
  File "/home/dftortosa/diego_docs/science/other_projects/australian_army_bishop/heavy_analyses/australian_army_bishop/quality_control/scripts/02d_post_imputation_qc.py", line 228, in <module>
    run_bash(" \
  File "/home/dftortosa/diego_docs/science/other_projects/australian_army_bishop/heavy_analyses/australian_army_bishop/quality_control/scripts/02d_post_imputation_qc.py", line 137, in run_bash
    raise ValueError("ERROR: FALSE! WE HAVE A PROBLEM RUNNING COMMAND: " + complete_process.stderr)
ValueError: ERROR: FALSE! WE HAVE A PROBLEM RUNNING COMMAND: awk: cannot open ./01_first_qc_step/merged_1_geno.bim (No such file or directory)
awk: cannot open ./02_second_qc_step/merged_2_geno.bim (No such file or directory)
awk: cannot open ./01_first_qc_step/merged_1_geno.fam (No such file or directory)
awk: cannot open ./02_second_qc_step/merged_2_geno.fam (No such file or directory)
/bin/bash: line 1: -: syntax error: operand expected (error token is "-")

